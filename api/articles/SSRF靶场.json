{"title":"SSRF靶场","uid":"a26ca86ff3a376714693fb5a890fc5f2","slug":"SSRF靶场","date":"2022-07-21T01:48:20.000Z","updated":"2022-07-21T02:18:37.896Z","comments":true,"path":"api/articles/SSRF靶场.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"0x00-CTFHUB\"><a href=\"#0x00-CTFHUB\" class=\"headerlink\" title=\"0x00 CTFHUB\"></a>0x00 CTFHUB</h2><p>CTFHUB的SSRF题目。</p>\n<h2 id=\"0x01-涉及协议及知识点\"><a href=\"#0x01-涉及协议及知识点\" class=\"headerlink\" title=\"0x01 涉及协议及知识点\"></a>0x01 涉及协议及知识点</h2><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>http:&#x2F;&#x2F;：探测内网主机存活、端口开放情况，可以通过访问其它网站确定存活，如百度</p>\n<p>gopher:&#x2F;&#x2F;：发送GET或POST请求(需要配合http协议二次url编码上传)；攻击内网应用，如FastCGI、Redis</p>\n<p>dict:&#x2F;&#x2F;：泄露安装软件版本信息，查看端口，操作内网redis访问等</p>\n<p>file:&#x2F;&#x2F;：读取本地文件，如&#x2F;etc&#x2F;passwd、&#x2F;etc&#x2F;hosts、web网站等等</p></blockquote>\n<h2 id=\"0x02-内网访问\"><a href=\"#0x02-内网访问\" class=\"headerlink\" title=\"0x02 内网访问\"></a>0x02 内网访问</h2><p><img src=\"/post/SSRF%E9%9D%B6%E5%9C%BA.htm/image-20220721095051455.png\" alt=\"image-20220721095051455\"></p>\n<p>题目直接提示访问127.0.0.1的flag.php</p>\n<p>打开靶场以后空白页面，地址栏看到有url参数，根据题目内网访问，可以肯定是能够探测内网是否存在存活主机的：</p>\n<p><img src=\"/post/SSRF%E9%9D%B6%E5%9C%BA.htm/image-20220721095313140.png\" alt=\"image-20220721095313140\"></p>\n<p>探测一下http协议能否使用：</p>\n<p><img src=\"/post/SSRF%E9%9D%B6%E5%9C%BA.htm/image-20220721095618298.png\" alt=\"image-20220721095618298\"></p>\n<p>访问百度可以跳转页面，证明http协议是能够使用的；</p>\n<p>题目给出直接访问flag.php文件：<br><img src=\"/post/SSRF%E9%9D%B6%E5%9C%BA.htm/image-20220721095813535.png\" alt=\"image-20220721095813535\"></p>\n<p>得到flag。</p>\n<h2 id=\"0x03-伪协议读取文件\"><a href=\"#0x03-伪协议读取文件\" class=\"headerlink\" title=\"0x03 伪协议读取文件\"></a>0x03 伪协议读取文件</h2><p>题目给出读取Web目录下的flag.php：</p>\n<p><img src=\"/post/SSRF%E9%9D%B6%E5%9C%BA.htm/image-20220721095916568.png\" alt=\"image-20220721095916568\"></p>\n<p>提示给出flag.php地址，那这里肯定就需要使用伪协议来读取文件。</p>\n<p>直接读取：</p>\n<p><img src=\"/post/SSRF%E9%9D%B6%E5%9C%BA.htm/image-20220721100339921.png\" alt=\"image-20220721100339921\"></p>\n<p>查看源码：<br><img src=\"/post/SSRF%E9%9D%B6%E5%9C%BA.htm/image-20220721100354877.png\" alt=\"image-20220721100354877\"></p>\n<h2 id=\"0x04-端口扫描\"><a href=\"#0x04-端口扫描\" class=\"headerlink\" title=\"0x04 端口扫描\"></a>0x04 端口扫描</h2><p>给出提示端口范围在8000-9000</p>\n<p><img src=\"/post/SSRF%E9%9D%B6%E5%9C%BA.htm/image-20220721100553224.png\" alt=\"image-20220721100553224\"></p>\n<p>根据提示，flag应该实在某一个端口下，因此就需要爆破每一个端口来探测，这里使用BP直接进行爆破：</p>\n<p>这里利用<strong>dict协议</strong>探测端口加上<strong>burp</strong>爆破，也可以用<strong>http</strong>探测端口。</p>\n<p><img src=\"/post/SSRF%E9%9D%B6%E5%9C%BA.htm/image-20220721101114833.png\" alt=\"image-20220721101114833\"></p>\n<p><img src=\"/post/SSRF%E9%9D%B6%E5%9C%BA.htm/image-20220721101140417.png\" alt=\"image-20220721101140417\"></p>\n<p>爆破完成，只有一个长度不同：</p>\n<p><img src=\"/post/SSRF%E9%9D%B6%E5%9C%BA.htm/image-20220721101359755.png\" alt=\"image-20220721101359755\"></p>\n<p>使用http协议访问：</p>\n<p>​\t<img src=\"/post/SSRF%E9%9D%B6%E5%9C%BA.htm/image-20220721101453963.png\" alt=\"image-20220721101453963\"></p>\n<p>得到flag。</p>\n","text":"0x00 CTFHUBCTFHUB的SSRF题目。 0x01 涉及协议及知识点 http:&#x2F;&#x2F;：探测内网主机存活、端口开放情况，可以通过访问其它网站确定存活，如百度 gopher:&#x2F;&#x2F;：发送GET或POST请求(需要配合http协议二次ur...","link":"","photos":[],"count_time":{"symbolsCount":706,"symbolsTime":"1 mins."},"categories":[{"name":"SSRF","slug":"SSRF","count":2,"path":"api/categories/SSRF.json"}],"tags":[{"name":"CTF","slug":"CTF","count":19,"path":"api/tags/CTF.json"},{"name":"SSRF","slug":"SSRF","count":2,"path":"api/tags/SSRF.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x00-CTFHUB\"><span class=\"toc-text\">0x00 CTFHUB</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01-%E6%B6%89%E5%8F%8A%E5%8D%8F%E8%AE%AE%E5%8F%8A%E7%9F%A5%E8%AF%86%E7%82%B9\"><span class=\"toc-text\">0x01 涉及协议及知识点</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02-%E5%86%85%E7%BD%91%E8%AE%BF%E9%97%AE\"><span class=\"toc-text\">0x02 内网访问</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03-%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">0x03 伪协议读取文件</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x04-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F\"><span class=\"toc-text\">0x04 端口扫描</span></a></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"BUU-WarmUp","uid":"b677a8964f78654f7fae8209041bf9e6","slug":"BUU-WarmUp","date":"2022-07-21T09:28:21.000Z","updated":"2022-07-23T15:38:34.333Z","comments":true,"path":"api/articles/BUU-WarmUp.json","keywords":null,"cover":[],"text":"0x00BUU，Web题目WarmUp，PHP代码审计。 0x01打开靶场只有一个表情包： 查看源码发现source.php文件，直接访问： 出现源代码。 看到源码中存在一个hint.php文件，直接访问： 提示flag在ffffllllaaaagggg当中，告诉了flag的文件...","link":"","photos":[],"count_time":{"symbolsCount":"4.7k","symbolsTime":"4 mins."},"categories":[{"name":"CTF","slug":"CTF","count":10,"path":"api/categories/CTF.json"}],"tags":[{"name":"CTF","slug":"CTF","count":19,"path":"api/tags/CTF.json"},{"name":"代码审计","slug":"代码审计","count":6,"path":"api/tags/代码审计.json"},{"name":"PHP","slug":"PHP","count":5,"path":"api/tags/PHP.json"},{"name":"文件包含","slug":"文件包含","count":2,"path":"api/tags/文件包含.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"BUU-XXE","uid":"70c23a918e95c44d14bcc6704e34bc7d","slug":"BUU-XXE","date":"2022-07-19T13:55:45.000Z","updated":"2022-07-21T02:42:53.123Z","comments":true,"path":"api/articles/BUU-XXE.json","keywords":null,"cover":[],"text":"0x00BUU一道基础XXE题目。 0x01打开靶场出现登录界面： 随便登录抓包观察数据包： 发现数据包中有xml 文档声明： &lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt; 因...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"XXE","slug":"XXE","count":4,"path":"api/categories/XXE.json"}],"tags":[{"name":"CTF","slug":"CTF","count":19,"path":"api/tags/CTF.json"},{"name":"XXE","slug":"XXE","count":4,"path":"api/tags/XXE.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}