{"title":"Kali渗透测试-Radiotap头部及802.11包分析","uid":"23e7a773291421d7be94d649cd41c79b","slug":"Kali渗透测试-Radiotap头部","date":"2023-01-02T12:38:01.000Z","updated":"2023-01-04T03:38:48.952Z","comments":true,"path":"api/articles/Kali渗透测试-Radiotap头部.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"RADIOTAP头部\"><a href=\"#RADIOTAP头部\" class=\"headerlink\" title=\"RADIOTAP头部\"></a>RADIOTAP头部</h2><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li>802.11帧发射和接收的事实标准（Radiotap并不遵循802.11的标准，但802.11依赖Radiotap完成通信过程）</li>\n<li>Linux系统在驱动和API中内建支持Radiotap的解析</li>\n<li>802.11帧发射之前，网卡驱动在802.11头前面添加Radiotap头，反之当网卡接收到无线帧时，驱动通知MAC层，此帧头包含Radiotap头</li>\n<li>Radiotap为802.11帧传递额外信息，厂家可自定义，因此头长度不固定</li>\n<li>不破坏原始头结构，增加传递的信息</li>\n</ul></blockquote>\n<h2 id=\"RADIOTAP包头分析\"><a href=\"#RADIOTAP包头分析\" class=\"headerlink\" title=\"RADIOTAP包头分析\"></a>RADIOTAP包头分析</h2><h4 id=\"开启网卡监听\"><a href=\"#开启网卡监听\" class=\"headerlink\" title=\"开启网卡监听\"></a>开启网卡监听</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">iw dev wlan0 interface add wlan0mon type monitor\nifconfig wlan0mon up<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230102204434444.png\" alt=\"image-20230102204434444\"></p>\n<h4 id=\"抓包分析\"><a href=\"#抓包分析\" class=\"headerlink\" title=\"抓包分析\"></a>抓包分析</h4><ul>\n<li>分为Header和data</li>\n<li>Version（8bit）<ul>\n<li>值始终为0</li>\n</ul>\n</li>\n<li>Pad (8bit)<ul>\n<li>未使用，只作为字段强制对其的占位</li>\n</ul>\n</li>\n<li>Header length<ul>\n<li>长度可变</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230102205557304.png\" alt=\"image-20230102205557304\"></p>\n<ul>\n<li>Present flags<ul>\n<li>后面数据位的掩码，表示数据位会出现那些内容；每32位一组</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230102205840782.png\" alt=\"image-20230102205840782\"></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230102210102862.png\" alt=\"image-20230102210102862\"></p>\n<ul>\n<li>Flags<ul>\n<li>该标记位标志了后面的数据是否进行了加密，差错校验，数据重传等</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230102210454686.png\" alt=\"image-20230102210454686\"></p>\n<h2 id=\"802-11头部字段\"><a href=\"#802-11头部字段\" class=\"headerlink\" title=\"802.11头部字段\"></a>802.11头部字段</h2><h3 id=\"基本概念\"><a href=\"#基本概念\" class=\"headerlink\" title=\"基本概念\"></a>基本概念</h3><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li>DU (Data Unit)即数据单元，信息传输的最小数据集合</li>\n<li>传递过程逐层封装(Encapsulation)</li>\n<li>SDU (Service Data Unit) &#x2F; PDU (Protocol Data Unit)</li>\n<li>MSDU <strong>→</strong> MIC → 分帧 → 添加IV → 加密 → 添加MAC头部 → MPDU</li>\n<li>MPDU&#x2F;PSDU +物理头 &#x3D; PPDU → RF发射</li>\n</ul></blockquote>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220401150335894-1172943925.png\" alt=\"img\"></p>\n<h3 id=\"PDU和SDU补充\"><a href=\"#PDU和SDU补充\" class=\"headerlink\" title=\"PDU和SDU补充\"></a>PDU和SDU补充</h3><h4 id=\"SDU（service-Data-Unit）\"><a href=\"#SDU（service-Data-Unit）\" class=\"headerlink\" title=\"SDU（service Data Unit）\"></a>SDU（service Data Unit）</h4><p>　　SDU（service Data Unit）：服务数据单元，又叫业务数据单元，是指定层的用户服务的数据集，传送到接收方的时候同一协议层时数据没有发生变化，即业务部分，然后发给下层之后，下层将其封装在PDU中发送出去。服务数据单元是从高层协议来的信息单元传送到低层协议。第N层服务数据单元SDU，和上一层的协议数据单元（PDU）是一一对应的。根据协议数据单元的数据的不同，送到接收端的指定层。</p>\n<h4 id=\"PDU（Protocol-Data-Unit）\"><a href=\"#PDU（Protocol-Data-Unit）\" class=\"headerlink\" title=\"PDU（Protocol Data Unit）\"></a>PDU（Protocol Data Unit）</h4><ul>\n<li>在电信领域，协议数据单元（PDU，Protocol Data Unit）有以下几层意义：<ul>\n<li>网络的对等实体传送的信息单元，包括了控制信息，地址信息，或者数据。</li>\n<li>在协议系统里，在指定的协议层上传送的数据单元，包含了该层的协议控制信息和用户信息。</li>\n<li>在OSI模型系统里，PDU和最底下四层相关</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"PDU和SDU的区别\"><a href=\"#PDU和SDU的区别\" class=\"headerlink\" title=\"PDU和SDU的区别\"></a>PDU和SDU的区别</h4><h5 id=\"PDU的封装-x2F-解封装\"><a href=\"#PDU的封装-x2F-解封装\" class=\"headerlink\" title=\"PDU的封装&#x2F;解封装\"></a>PDU的封装&#x2F;解封装</h5><p>　　在发送方，将用户递交的SDU加上协议控制信息PCI，封装成PDU；在接收方，讲接收到的PDU解封装，去掉PCI，还原成SDU送交接收方用户。</p>\n<h5 id=\"SDU分段-x2F-装配\"><a href=\"#SDU分段-x2F-装配\" class=\"headerlink\" title=\"SDU分段&#x2F;装配\"></a>SDU分段&#x2F;装配</h5><p>　　如果下层通道的带宽不能满足传递SDU的需要，就需要将一个SDU分成多段，分别封装成PDU发送出去（分段）；在接收方再将这些PDU解封装后重新装配成SDU。</p>\n<h5 id=\"SDU拼接-x2F-分离\"><a href=\"#SDU拼接-x2F-分离\" class=\"headerlink\" title=\"SDU拼接&#x2F;分离\"></a>SDU拼接&#x2F;分离</h5><p>　　拼接是指在发送方（n）层协议实体把多个长度较短的（n）SDU封装成一个（n）PDU来发送，在接收放再将接收到的（n）PDU解封装，将多个（n）SDU分离出来。采用拼接功能的目的是提高通道的利用率。</p>\n<h5 id=\"PDU分割-x2F-组合\"><a href=\"#PDU分割-x2F-组合\" class=\"headerlink\" title=\"PDU分割&#x2F;组合\"></a>PDU分割&#x2F;组合</h5><p>　　PDU分割是指在发送端（n）层协议实体把一个（n）PDU分割成多个（n-1）SDU，并行地从多个（n-1）通道发送出去；接收端再将收到的多个（n-1）SDU组合成一个（n）PDU。由于这是一个N层功能，所以组合操作在N层中进行，即N层先得到多个分割开的（n）PDU，然后把它们组合成一个（n）PDU。有时NSDU较长，而N协议所要求的NPDU较短。这时就要对NSDU进行分段处理，将一个SDU分成两个或多个PDU来传送。当PDU所要求的长度比SDU还大时，也可将几个SDU合并成为一个PDU。</p>\n<p><strong>原文地址：</strong></p>\n<p><a href=\"http://www.elecfans.com/d/1690388.html\">http://www.elecfans.com/d/1690388.html</a></p>\n<h2 id=\"802-11头部分析\"><a href=\"#802-11头部分析\" class=\"headerlink\" title=\"802.11头部分析\"></a>802.11头部分析</h2><h3 id=\"802-11MAC头结构\"><a href=\"#802-11MAC头结构\" class=\"headerlink\" title=\"802.11MAC头结构\"></a>802.11MAC头结构</h3><p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220401161915662-1172285506.png\" alt=\"img\"></p>\n<p><strong>Sequence Control 和 IPID的意义相似</strong></p>\n<h4 id=\"Frame-control\"><a href=\"#Frame-control\" class=\"headerlink\" title=\"Frame control\"></a>Frame control</h4><p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220401162224872-672643459.png\" alt=\"img\"></p>\n<h5 id=\"Protocol-Version-2bit\"><a href=\"#Protocol-Version-2bit\" class=\"headerlink\" title=\"Protocol Version (2bit)\"></a>Protocol Version (2bit)</h5><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>802.11协议版本，始终为0、1、2、3</p></blockquote>\n<h5 id=\"Type-2bit\"><a href=\"#Type-2bit\" class=\"headerlink\" title=\"Type (2bit)\"></a>Type (2bit)</h5><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>规定帧的具体用途(3种帧类型)</p>\n<ul>\n<li>控制帧(1)<ul>\n<li>发送控制指令</li>\n</ul>\n</li>\n<li>数据帧(2)</li>\n<li>管理帧(0)</li>\n</ul>\n<p><strong>数值不同帧类型也不同</strong></p></blockquote>\n<h5 id=\"SubType-4bit\"><a href=\"#SubType-4bit\" class=\"headerlink\" title=\"SubType (4bit)\"></a>SubType (4bit)</h5><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>每个类型对应多个子类型，协议规定不同类型&#x2F;子类型的帧完成不同功能的操作</p>\n<p>Association……：管理帧，station向AP发起，Probe……：探测帧，Reserved：保留位，尚未使用</p></blockquote>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220401162327407-1818077424.png\" alt=\"img\"></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220401162358628-1139460985.png\" alt=\"img\"></p>\n<h5 id=\"ToDS-x2F-FromDS-1-x2F-1bit\"><a href=\"#ToDS-x2F-FromDS-1-x2F-1bit\" class=\"headerlink\" title=\"ToDS&#x2F;FromDS(1&#x2F;1bit)\"></a>ToDS&#x2F;FromDS(1&#x2F;1bit)</h5><p>标识帧的传输方向，传向DS或者来自DS；这两个字段的值决定着MAC头中4个Address字段的不同定义，具体如下图所示（BSSID即AP地址）</p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220401164842469-260124030.png\" alt=\"img\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><strong>0x00：</strong>出现在IBSS环境中(可能是Management帧或者是Control帧类型) ，或者是STSL (Station to Station Link)中两个STA间通信， 这种情况下通信不通过AP；</p>\n<p><strong>0x01：</strong>表示Data帧从AP向STA传递；</p>\n<p><strong>0x02：</strong>表示Data帧从STA向AP传递；</p>\n<p><strong>0x03：</strong>表示两个AP间通信，这是典型的WDS (Wireless Distribution System)环境下AP间的通信，或者表示Mesh环境下MP间的通信，只有此时才会使用到Address4字段（RA,TA两个AP的地址）。</p></blockquote>\n<h5 id=\"More-frag-1bit\"><a href=\"#More-frag-1bit\" class=\"headerlink\" title=\"More frag (1bit)\"></a>More frag (1bit)</h5><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>表示是否还有后续帧，值为1时表示有后续分段，可能是Data或Management帧类型。只有单播接收地址的帧会被分段；</p></blockquote>\n<h5 id=\"Retry-1bit\"><a href=\"#Retry-1bit\" class=\"headerlink\" title=\"Retry (1bit)\"></a>Retry (1bit)</h5><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>重传，值为1表示重传帧（初次发送是被置为0的，当发完后没收到ACK则会置1进行重发），可能是Data或Management帧类型，接收端进程使用此值防止帧重复（该值为1且自己已经接收过该帧，则会直接丢弃）；</p></blockquote>\n<h5 id=\"Power-Mgmt-1bit\"><a href=\"#Power-Mgmt-1bit\" class=\"headerlink\" title=\"Power Mgmt (1bit)\"></a>Power Mgmt (1bit)</h5><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>活动模式(0) &#x2F;省电模式(1)，STA处于省电模式时，向关联的AP发送该值为1的帧(AP从不使用此字段，恒为0)，省电模式下STA不接收数据（但会接收AP发的一些特殊帧，如有唤醒意义的帧（省电 <strong>→</strong> 活动模式）），发送给它的Data帧由AP暂时缓存，待AP将它唤醒后，它会主动取回相应缓存；</p></blockquote>\n<h5 id=\"More-Data-1bit\"><a href=\"#More-Data-1bit\" class=\"headerlink\" title=\"More Data (1bit)\"></a>More Data (1bit)</h5><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>当AP缓存了至少一个MSDU时，会向省电模式的STA发送该值为1的帧，表示有数据要传输给STA，接收到此帧的STA唤醒自己并向AP发送PS- Poll帧，取回由AP为其缓存的数据。也被用于AP有更多的广播 <strong>&#x2F;</strong> 多播帧需要发送的情况；</p></blockquote>\n<h5 id=\"Protected-Frame-1bit\"><a href=\"#Protected-Frame-1bit\" class=\"headerlink\" title=\"Protected Frame (1bit)\"></a>Protected Frame (1bit)</h5><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>可能是Data或Management帧类型，表示MSDU是否被加密，也被用于表示PSK身份验证Frame#3帧，数据载荷为空时，该字段值为0；</p></blockquote>\n<h5 id=\"Order-1bit\"><a href=\"#Order-1bit\" class=\"headerlink\" title=\"Order (1bit)\"></a>Order (1bit)</h5><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>在非QoS（质量控制）帧的情况下，值为1表示数据必须按严格顺序处理（如按顺序发送），通常为0；</p></blockquote>\n<h4 id=\"Duration-x2F-ID-16bit\"><a href=\"#Duration-x2F-ID-16bit\" class=\"headerlink\" title=\"Duration&#x2F;ID (16bit)\"></a>Duration&#x2F;ID (16bit)</h4><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>所有Control帧都使用该字段，其作用随Type&#x2F;SubType变化有所不同；</p>\n<p>帧类型为PS Poll (type:1, subtype:10)时，表示STA关联的AID (association identity) ，即当station在省电模式收到AP的唤醒帧后，会向AP发送该字段填充为AID的PS-Poll帧，在AP收到PS-Poll帧后，根据AID发送为其缓存的数据；</p>\n<p>其他情况下该字段作为一种载波侦听机制，表示接收下一帧之前需要保持的时间间隔，用于NAV (Network Allocation Vector)计算，单位是微秒;</p></blockquote>\n<h4 id=\"MAC-Layer-Address\"><a href=\"#MAC-Layer-Address\" class=\"headerlink\" title=\"MAC Layer Address\"></a>MAC Layer Address</h4><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>参见ToDS&#x2F;FromDS(1&#x2F;1bit)字段的介绍</p>\n<p>补充：Basic service set ID (BSSID)，它是BSS的2层唯一标识，Infrastructure模式中BSSID就是AP的MAC地址，当AP支持多BSS时，随机生成每个BSSID。</p></blockquote>\n<h4 id=\"Sequence-Control-16bit\"><a href=\"#Sequence-Control-16bit\" class=\"headerlink\" title=\"Sequence Control (16bit)\"></a>Sequence Control (16bit)</h4><p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220403163951396-1400741748.png\" alt=\"img\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>这个字段包含两个子字段: Sequence Number和Fragment Number;</p>\n<p>Sequence Number是每个帧的编号，数值范围是0- 4095，以1为步长递增。当帧被分段时，同一帧中不同分段的Sequence Number相同;</p>\n<p>Fragment Number是被分段的帧用于标识分段位置顺序的编号，数值范围是0-15, 以1为步长递增（即帧加上头部信息后过大，则该帧又会被分成多端传送，段的编号即为Fragment Number）;</p></blockquote>\n<h4 id=\"Frame-Body-变长\"><a href=\"#Frame-Body-变长\" class=\"headerlink\" title=\"Frame Body (变长)\"></a>Frame Body (变长)</h4><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>数据字段，未加密的最大MSDU长度为2304字节（其中包含最大256字节的上层头信息，和可被传递的数据2048字节）。不同的加密方法会增加一定的内容长度;</p>\n<p>WEP：8 bytes → 2312 bytes</p>\n<p>TKIP (WPA1)：20 bytes → 2324 bytes</p>\n<p>CCMP (WPA2)：16 bytes → 2320 bytes</p>\n<p><strong>注：</strong>Control类型的帧没有Frame Body内容</p></blockquote>\n<h4 id=\"FCS-32bit\"><a href=\"#FCS-32bit\" class=\"headerlink\" title=\"FCS (32bit)\"></a>FCS (32bit)</h4><p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220403164012957-2042046478.png\" alt=\"img\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>发送端对全部MAC包头和Frame Body内容进行CRC计算，计算结果即为FCS (Frame Check Sequence)值，接收端进行同样的计算，结果一致时，则接收端向发送端返回ACK，否则丢弃帧（只对单播帧有效，FCS错误的广 播&#x2F;多播帧可能被接收）。</p>\n<p><strong>注：</strong>wireshark抓包时已经删除了FCS值。</p></blockquote>\n<h2 id=\"CONTROL-FRAME\"><a href=\"#CONTROL-FRAME\" class=\"headerlink\" title=\"CONTROL FRAME\"></a>CONTROL FRAME</h2><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>控制帧是一些通知设备开始、停止传输或连接失败等情况的短消息，无数据段，只有包头。</p></blockquote>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220403165304205-1257576407.png\" alt=\"img\"></p>\n<h2 id=\"ACK\"><a href=\"#ACK\" class=\"headerlink\" title=\"ACK\"></a>ACK</h2><p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220403170627748-188178935.png\" alt=\"img\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li><p>接收端正确接收数据之后向发送端返回ACK确认</p>\n</li>\n<li><p>每个单播帧需要ACK立刻确认</p>\n<ul>\n<li>组播和广播帧不需要ACK确认</li>\n</ul>\n</li>\n<li><p>尽快响应</p>\n<ul>\n<li>由硬件完成，而非驱动层</li>\n</ul>\n</li>\n<li><p>Type&#x2F;SubType：1&#x2F;13（帧类型是1；子类型是13）</p>\n</li>\n</ul></blockquote>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230103103507613.png\" alt=\"image-20230103103507613\"></p>\n<h2 id=\"PS-POLL\"><a href=\"#PS-POLL\" class=\"headerlink\" title=\"PS-POLL\"></a>PS-POLL</h2><p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220403180525862-1380471659.png\" alt=\"img\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li><p>RF系统的放大器</p>\n<ul>\n<li>主要耗电的组件</li>\n<li>发射前放大信号，接收并放大还原信号</li>\n</ul>\n</li>\n<li><p>省电模式</p>\n<ul>\n<li>关闭信号发射器节省电源耗电(几乎完全关闭)</li>\n</ul>\n</li>\n</ul></blockquote>\n<ul>\n<li><p>AID-Association ID</p>\n</li>\n<li><p><strong>STA省电模式唤醒</strong></p>\n<ul>\n<li>数据发送至AP (AP缓存数据包)</li>\n<li>通过Beacon发送TIM (traffic indication map)<ul>\n<li>其中包含AID</li>\n</ul>\n</li>\n<li>STA对比AID后唤醒网卡</li>\n<li>STA发送PS-PolI帧，请求从AP缓存中取回数据<ul>\n<li>每个帧都需要ACK确认</li>\n<li>ACK去人后AP从缓存中删除数据帧</li>\n<li>传输过程中STA保持唤醒状态</li>\n<li>传输结束后STA恢复省电状态</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220403180448778-647780011.png\" alt=\"img\"></p>\n<ul>\n<li><strong>AP接收PS- PolI帧</strong><ul>\n<li>立刻响应</li>\n<li>延迟响应<ul>\n<li>简单响应帧</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>AID：关联ID</li>\n<li>BSSID：STA正关联的AP地址</li>\n<li>TA：发送此帧的STA地址</li>\n</ul>\n<h2 id=\"RTS-x2F-CTS\"><a href=\"#RTS-x2F-CTS\" class=\"headerlink\" title=\"RTS&#x2F;CTS\"></a>RTS&#x2F;CTS</h2><ul>\n<li><p>RTS&#x2F;CTS是CSMA&#x2F;CA方法的一种补充手段</p>\n<ul>\n<li><p>RTS（请求传输服务）和CTS（空闲传输服务）</p>\n</li>\n<li><p>降低冲突产生的可能性</p>\n</li>\n<li><p>正式通信之前通过请求应答机制，确信通信介质的可用性</p>\n</li>\n<li><p>并锁定传输介质和预约通信时间。</p>\n</li>\n<li><p>只有在传输长帧时使用，传输短帧时不会使用</p>\n<ul>\n<li>驱动接口提供阈值的自定义</li>\n<li>大于阈值的帧被视为长帧，反之则视为短帧</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>传输机制</p>\n<ul>\n<li>Node 1发送Request to Send包给Node2</li>\n<li>如果未发生冲突，Node2返回Clear to Send给Node 1</li>\n<li>Node 1传输数据</li>\n<li>数据正常接收，Node2返回ACK，否则Node 1什么也不会收到</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220403184948377-1804974125.png\" alt=\"img\"></p>\n<ul>\n<li><p><strong>有线网络介质访问方式: CSMA&#x2F;CD</strong></p>\n</li>\n<li><p><strong>无线网络介质访问方法: CSMA&#x2F;CA</strong></p>\n</li>\n<li><p><strong>避免隐藏节点的冲突</strong></p>\n<ul>\n<li>n1,n2,n3三个节点，n1,n3彼此不知道对方的存在，相对而言为隐藏节点，当n1,n3同时要与n2通信时则会导致冲突（CSMA&#x2F;CA），而采用RTS&#x2F;CTS方式可避免冲突。</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"RTS（帧长度20字节）\"><a href=\"#RTS（帧长度20字节）\" class=\"headerlink\" title=\"RTS（帧长度20字节）\"></a>RTS（帧长度20字节）</h4><p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220403185007732-962071099.png\" alt=\"img\"></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220403190850257-2126129990.png\" alt=\"img\"></p>\n<h4 id=\"CTS（帧长度14字节）\"><a href=\"#CTS（帧长度14字节）\" class=\"headerlink\" title=\"CTS（帧长度14字节）\"></a>CTS（帧长度14字节）</h4><p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220403185021849-1448447689.png\" alt=\"img\"></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230103110513105.png\" alt=\"image-20230103110513105\"></p>\n<h2 id=\"MANAGEMENT-FRAME-管理帧\"><a href=\"#MANAGEMENT-FRAME-管理帧\" class=\"headerlink\" title=\"MANAGEMENT FRAME(管理帧)\"></a>MANAGEMENT FRAME(管理帧)</h2><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><strong>用于控制和协商STA和AP的关系</strong></p></blockquote>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220410194219272-654899335.png\" alt=\"img\"></p>\n<h3 id=\"BEACON-FRAMES\"><a href=\"#BEACON-FRAMES\" class=\"headerlink\" title=\"BEACON FRAMES\"></a>BEACON FRAMES</h3><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li><p>AP发送的广播帧，通告无线网络的存在(BSSID)</p>\n</li>\n<li><p>发包频率</p>\n<ul>\n<li>102.4ms(可变)</li>\n<li>时间单位1024 microseconds (60秒)，可自己设置</li>\n</ul>\n</li>\n<li><p>SSID网络名</p>\n<ul>\n<li>隐藏AP不发SSID广播（路由可设置不广播，使用时可手动输入网络名和密码进行连接）</li>\n</ul>\n</li>\n</ul></blockquote>\n<h4 id=\"Beacon帧结构\"><a href=\"#Beacon帧结构\" class=\"headerlink\" title=\"Beacon帧结构\"></a>Beacon帧结构</h4><p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220410194741686-1789370470.png\" alt=\"img\"></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230104101034842.png\" alt=\"image-20230104101034842\"></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230104102249710.png\" alt=\"image-20230104102249710\"></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230104102904543.png\" alt=\"image-20230104102904543\"></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230104103203353.png\" alt=\"image-20230104103203353\"></p>\n<h3 id=\"PROBE-FRAMES\"><a href=\"#PROBE-FRAMES\" class=\"headerlink\" title=\"PROBE FRAMES\"></a>PROBE FRAMES</h3><p><strong>PROBE REQUEST FRAMES</strong></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li>用于STA主动发出扫描现有AP<ul>\n<li>发现连接过的AP</li>\n<li>发现未连连接的AP</li>\n</ul>\n</li>\n</ul></blockquote>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220410210056649-844319384.png\" alt=\"img\"></p>\n<p><strong>注意</strong>：数据字段长度可变</p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230104105000502.png\" alt=\"image-20230104105000502\"></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230104105041964.png\" alt=\"image-20230104105041964\"></p>\n<p><strong>PROBE RESPONSE FRAMES</strong></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>发现连接过的AP时，速率和ESSID相同的AP响应</p></blockquote>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220411090921372-550320158.png\" alt=\"img\"></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230104105201007.png\" alt=\"image-20230104105201007\"></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230104105215655.png\" alt=\"image-20230104105215655\"></p>\n<h3 id=\"AUTHENTICATION-FRAMES\"><a href=\"#AUTHENTICATION-FRAMES\" class=\"headerlink\" title=\"AUTHENTICATION FRAMES\"></a>AUTHENTICATION FRAMES</h3><p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220411090946733-118600943.png\" alt=\"img\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p><strong>Authentication Algorithm身份认证类型</strong></p>\n<ul>\n<li>0:开放系统身份验证</li>\n<li>1:共享密钥身份验证</li>\n</ul>\n<p>身份认证有多个帧交换过程组成</p>\n<p><strong>Authentication Seq</strong></p>\n<ul>\n<li>每次身份验证过程Seq唯一</li>\n<li>1-65535</li>\n</ul>\n<p>Challenge text</p>\n<ul>\n<li>只有共享密钥方式才有此字段</li>\n</ul>\n<p><strong>Status Code：成功&#x2F;失败</strong></p></blockquote>\n<h3 id=\"ASSOCIATION-x2F-REASSOCIATION-FRAMES\"><a href=\"#ASSOCIATION-x2F-REASSOCIATION-FRAMES\" class=\"headerlink\" title=\"ASSOCIATION&#x2F;REASSOCIATION FRAMES\"></a>ASSOCIATION&#x2F;REASSOCIATION FRAMES</h3><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li>身份验证成功后，STA执行关联操作，加入无线网络<ul>\n<li>Association Request</li>\n<li>Reassociation Request</li>\n<li>Association Response</li>\n</ul>\n</li>\n</ul></blockquote>\n<h4 id=\"ASSOCIATION-REQUEST-FRAMES\"><a href=\"#ASSOCIATION-REQUEST-FRAMES\" class=\"headerlink\" title=\"ASSOCIATION REQUEST FRAMES\"></a>ASSOCIATION REQUEST FRAMES</h4><p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220411091402411-336650571.png\" alt=\"img\"></p>\n<h4 id=\"REASSOCIATION-REQUEST-FRAME\"><a href=\"#REASSOCIATION-REQUEST-FRAME\" class=\"headerlink\" title=\"REASSOCIATION REQUEST FRAME\"></a>REASSOCIATION REQUEST FRAME</h4><p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220411091526026-501606248.png\" alt=\"img\"></p>\n<h4 id=\"ASSOCIATION-RESPONSE\"><a href=\"#ASSOCIATION-RESPONSE\" class=\"headerlink\" title=\"ASSOCIATION RESPONSE\"></a>ASSOCIATION RESPONSE</h4><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>AP对STA的关联请求的响应</p>\n<p>状态码:关联成功&#x2F;失败</p></blockquote>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220411091609054-1722093294.png\" alt=\"img\"></p>\n<h4 id=\"DISASSOCIATION-x2F-DEAUTHENTICATION\"><a href=\"#DISASSOCIATION-x2F-DEAUTHENTICATION\" class=\"headerlink\" title=\"DISASSOCIATION&#x2F;DEAUTHENTICATION\"></a>DISASSOCIATION&#x2F;DEAUTHENTICATION</h4><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li>解除关联&#x2F;解除身份认证</li>\n<li>由AP发出<ul>\n<li>2个字节</li>\n</ul>\n</li>\n</ul></blockquote>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220411091710340-1945389500.png\" alt=\"img\"></p>\n<p>可能的原因（部分）：</p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220411091731886-476254154.png\" alt=\"img\"></p>\n<h3 id=\"ATIM-FRAMES\"><a href=\"#ATIM-FRAMES\" class=\"headerlink\" title=\"ATIM FRAMES\"></a>ATIM FRAMES</h3><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>只在ad-hoc网络下使用，充当AP功能的STA使用此帧通知接收者其有缓存的数据要发送</p></blockquote>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220411091823515-33464501.png\" alt=\"img\"></p>\n<p>有些帧没有抓到，可以看下面这篇帖子</p>\n<p><a href=\"https://blog.csdn.net/random_run/article/details/115223124\">https://blog.csdn.net/random_run/article/details/115223124</a></p>\n<h2 id=\"DATA-FRAME\"><a href=\"#DATA-FRAME\" class=\"headerlink\" title=\"DATA FRAME\"></a>DATA FRAME</h2><p><strong>数据帧</strong></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220416150554294-685265653.png\" alt=\"img\"></p>\n<h4 id=\"DATA-FRAMES\"><a href=\"#DATA-FRAMES\" class=\"headerlink\" title=\"DATA FRAMES\"></a>DATA FRAMES</h4><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><ul>\n<li>传输用户数据<ul>\n<li>DATA Frame</li>\n</ul>\n</li>\n<li>空数据帧<ul>\n<li>Null data frame</li>\n<li>只包含MAC头和FCS</li>\n<li>STA用于声明自己将要进入省电模式</li>\n</ul>\n</li>\n</ul></blockquote>\n<p><strong>DATA Frame</strong></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/2379545-20220416171716500-645063485.png\" alt=\"img\"></p>\n<p><strong>空数据帧</strong></p>\n<p><img src=\"/post/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Radiotap%E5%A4%B4%E9%83%A8.htm/image-20230104113025426.png\" alt=\"image-20230104113025426\"></p>\n","text":"RADIOTAP头部 802.11帧发射和接收的事实标准（Radiotap并不遵循802.11的标准，但802.11依赖Radiotap完成通信过程） Linux系统在驱动和API中内建支持Radiotap的解析 802.11帧发射之前，网卡驱动在802.11头前面添加Radio...","link":"","photos":[],"count_time":{"symbolsCount":"6.6k","symbolsTime":"6 mins."},"categories":[{"name":"无线渗透","slug":"无线渗透","count":8,"path":"api/categories/无线渗透.json"}],"tags":[{"name":"Kali","slug":"Kali","count":27,"path":"api/tags/Kali.json"},{"name":"无线渗透","slug":"无线渗透","count":8,"path":"api/tags/无线渗透.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#RADIOTAP%E5%A4%B4%E9%83%A8\"><span class=\"toc-text\">RADIOTAP头部</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#RADIOTAP%E5%8C%85%E5%A4%B4%E5%88%86%E6%9E%90\"><span class=\"toc-text\">RADIOTAP包头分析</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E5%BC%80%E5%90%AF%E7%BD%91%E5%8D%A1%E7%9B%91%E5%90%AC\"><span class=\"toc-text\">开启网卡监听</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90\"><span class=\"toc-text\">抓包分析</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#802-11%E5%A4%B4%E9%83%A8%E5%AD%97%E6%AE%B5\"><span class=\"toc-text\">802.11头部字段</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5\"><span class=\"toc-text\">基本概念</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#PDU%E5%92%8CSDU%E8%A1%A5%E5%85%85\"><span class=\"toc-text\">PDU和SDU补充</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#SDU%EF%BC%88service-Data-Unit%EF%BC%89\"><span class=\"toc-text\">SDU（service Data Unit）</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#PDU%EF%BC%88Protocol-Data-Unit%EF%BC%89\"><span class=\"toc-text\">PDU（Protocol Data Unit）</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#PDU%E5%92%8CSDU%E7%9A%84%E5%8C%BA%E5%88%AB\"><span class=\"toc-text\">PDU和SDU的区别</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#PDU%E7%9A%84%E5%B0%81%E8%A3%85-x2F-%E8%A7%A3%E5%B0%81%E8%A3%85\"><span class=\"toc-text\">PDU的封装&#x2F;解封装</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#SDU%E5%88%86%E6%AE%B5-x2F-%E8%A3%85%E9%85%8D\"><span class=\"toc-text\">SDU分段&#x2F;装配</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#SDU%E6%8B%BC%E6%8E%A5-x2F-%E5%88%86%E7%A6%BB\"><span class=\"toc-text\">SDU拼接&#x2F;分离</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#PDU%E5%88%86%E5%89%B2-x2F-%E7%BB%84%E5%90%88\"><span class=\"toc-text\">PDU分割&#x2F;组合</span></a></li></ol></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#802-11%E5%A4%B4%E9%83%A8%E5%88%86%E6%9E%90\"><span class=\"toc-text\">802.11头部分析</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#802-11MAC%E5%A4%B4%E7%BB%93%E6%9E%84\"><span class=\"toc-text\">802.11MAC头结构</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Frame-control\"><span class=\"toc-text\">Frame control</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Protocol-Version-2bit\"><span class=\"toc-text\">Protocol Version (2bit)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Type-2bit\"><span class=\"toc-text\">Type (2bit)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#SubType-4bit\"><span class=\"toc-text\">SubType (4bit)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#ToDS-x2F-FromDS-1-x2F-1bit\"><span class=\"toc-text\">ToDS&#x2F;FromDS(1&#x2F;1bit)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#More-frag-1bit\"><span class=\"toc-text\">More frag (1bit)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Retry-1bit\"><span class=\"toc-text\">Retry (1bit)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Power-Mgmt-1bit\"><span class=\"toc-text\">Power Mgmt (1bit)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#More-Data-1bit\"><span class=\"toc-text\">More Data (1bit)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Protected-Frame-1bit\"><span class=\"toc-text\">Protected Frame (1bit)</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#Order-1bit\"><span class=\"toc-text\">Order (1bit)</span></a></li></ol></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Duration-x2F-ID-16bit\"><span class=\"toc-text\">Duration&#x2F;ID (16bit)</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#MAC-Layer-Address\"><span class=\"toc-text\">MAC Layer Address</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Sequence-Control-16bit\"><span class=\"toc-text\">Sequence Control (16bit)</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Frame-Body-%E5%8F%98%E9%95%BF\"><span class=\"toc-text\">Frame Body (变长)</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#FCS-32bit\"><span class=\"toc-text\">FCS (32bit)</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#CONTROL-FRAME\"><span class=\"toc-text\">CONTROL FRAME</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#ACK\"><span class=\"toc-text\">ACK</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#PS-POLL\"><span class=\"toc-text\">PS-POLL</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#RTS-x2F-CTS\"><span class=\"toc-text\">RTS&#x2F;CTS</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#RTS%EF%BC%88%E5%B8%A7%E9%95%BF%E5%BA%A620%E5%AD%97%E8%8A%82%EF%BC%89\"><span class=\"toc-text\">RTS（帧长度20字节）</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#CTS%EF%BC%88%E5%B8%A7%E9%95%BF%E5%BA%A614%E5%AD%97%E8%8A%82%EF%BC%89\"><span class=\"toc-text\">CTS（帧长度14字节）</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#MANAGEMENT-FRAME-%E7%AE%A1%E7%90%86%E5%B8%A7\"><span class=\"toc-text\">MANAGEMENT FRAME(管理帧)</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#BEACON-FRAMES\"><span class=\"toc-text\">BEACON FRAMES</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#Beacon%E5%B8%A7%E7%BB%93%E6%9E%84\"><span class=\"toc-text\">Beacon帧结构</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#PROBE-FRAMES\"><span class=\"toc-text\">PROBE FRAMES</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#AUTHENTICATION-FRAMES\"><span class=\"toc-text\">AUTHENTICATION FRAMES</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#ASSOCIATION-x2F-REASSOCIATION-FRAMES\"><span class=\"toc-text\">ASSOCIATION&#x2F;REASSOCIATION FRAMES</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#ASSOCIATION-REQUEST-FRAMES\"><span class=\"toc-text\">ASSOCIATION REQUEST FRAMES</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#REASSOCIATION-REQUEST-FRAME\"><span class=\"toc-text\">REASSOCIATION REQUEST FRAME</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#ASSOCIATION-RESPONSE\"><span class=\"toc-text\">ASSOCIATION RESPONSE</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#DISASSOCIATION-x2F-DEAUTHENTICATION\"><span class=\"toc-text\">DISASSOCIATION&#x2F;DEAUTHENTICATION</span></a></li></ol></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#ATIM-FRAMES\"><span class=\"toc-text\">ATIM FRAMES</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#DATA-FRAME\"><span class=\"toc-text\">DATA FRAME</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#DATA-FRAMES\"><span class=\"toc-text\">DATA FRAMES</span></a></li></ol></li></ol></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Kali渗透测试-无线通信过程","uid":"794f4a9afb9c333220f5373c11dd59cc","slug":"Kali渗透测试-无线通信过程","date":"2023-01-06T02:41:27.000Z","updated":"2023-01-09T12:37:52.931Z","comments":true,"path":"api/articles/Kali渗透测试-无线通信过程.json","keywords":null,"cover":[],"text":"连接到无线网络 Probe STA向所有信道发出probe帧，发现AP AP回应Response Authentication STA向AP发出验证请求 发生认证过程(步骤可变，如加密算法的不同) AP响应STA的认证结果 Association STA发出关联请求 AP响应关联...","link":"","photos":[],"count_time":{"symbolsCount":"2.3k","symbolsTime":"2 mins."},"categories":[{"name":"无线渗透","slug":"无线渗透","count":8,"path":"api/categories/无线渗透.json"}],"tags":[{"name":"Kali","slug":"Kali","count":27,"path":"api/tags/Kali.json"},{"name":"无线渗透","slug":"无线渗透","count":8,"path":"api/tags/无线渗透.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Kali渗透测试-Linux无线协议栈及配置命令","uid":"9380cb6d0ca72ae1f44641638d3e52e2","slug":"Kali渗透测试-Linux无线协议栈及配置命令","date":"2023-01-02T09:28:55.000Z","updated":"2023-01-02T10:33:48.752Z","comments":true,"path":"api/articles/Kali渗透测试-Linux无线协议栈及配置命令.json","keywords":null,"cover":[],"text":"802.11协议栈 协议栈 内核接口（kernel） 用户空间命令及相应的调用程序（userspace） 无线网卡配置查看无线网卡 ifconfig iwconfig iw list 其中Mode模式为Managed，只有Monitor模式才能抓包 iw list命令：列出网卡支...","link":"","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"无线渗透","slug":"无线渗透","count":8,"path":"api/categories/无线渗透.json"}],"tags":[{"name":"Kali","slug":"Kali","count":27,"path":"api/tags/Kali.json"},{"name":"无线渗透","slug":"无线渗透","count":8,"path":"api/tags/无线渗透.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}