{"title":"CSRF靶场","uid":"929e59ca2c7119d6b3905dcf4adc61b6","slug":"CSRF靶场","date":"2022-03-08T03:07:17.000Z","updated":"2022-03-09T03:25:19.499Z","comments":true,"path":"api/articles/CSRF靶场.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"环境准备\"><a href=\"#环境准备\" class=\"headerlink\" title=\"环境准备\"></a>环境准备</h2><p>1、靶场环境：Pikachu-CSRF</p>\n<p>2、攻击机：Win10</p>\n<h2 id=\"CSRF（get）\"><a href=\"#CSRF（get）\" class=\"headerlink\" title=\"CSRF（get）\"></a>CSRF（get）</h2><h3 id=\"0x00\"><a href=\"#0x00\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p>首先进行登录：<br><img src=\"/post/CSRF%E9%9D%B6%E5%9C%BA.htm/image-20220308111403863.png\" alt=\"image-20220308111403863\"></p>\n<h3 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p>抓包构造伪链接：</p>\n<p><img src=\"/post/CSRF%E9%9D%B6%E5%9C%BA.htm/image-20220309105846745.png\" alt=\"image-20220309105846745\"></p>\n<h3 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p>构造url伪链接，将地址修改为china：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">pikachu-master&#x2F;vul&#x2F;csrf&#x2F;csrfget&#x2F;csrf_get_edit.php?sex&#x3D;boy&amp;phonenum&#x3D;15988767673&amp;add&#x3D;china&amp;email&#x3D;kobe@pikachu.com&amp;submit&#x3D;submit<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/CSRF%E9%9D%B6%E5%9C%BA.htm/image-20220309110323179.png\" alt=\"image-20220309110323179\"></p>\n<p>伪造修改成功。</p>\n<p><strong>注意：</strong>必须为用户登录状态。</p>\n<p>##CSRF（post）</p>\n<h3 id=\"0x00-1\"><a href=\"#0x00-1\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p><img src=\"/post/CSRF%E9%9D%B6%E5%9C%BA.htm/image-20220309110611513.png\" alt=\"image-20220309110611513\"></p>\n<h3 id=\"0x01-1\"><a href=\"#0x01-1\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p>先抓个包</p>\n<p><img src=\"/post/CSRF%E9%9D%B6%E5%9C%BA.htm/image-20220309110835618.png\" alt=\"image-20220309110835618\"></p>\n<p>出现访问目录，url和提交的表单，由于是基于post，那这里伪造就需要伪造一个表单了进行后续的操作。</p>\n<h3 id=\"0x02-1\"><a href=\"#0x02-1\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p>利用burpsuit构造CSRF POC来伪造表单：</p>\n<p><img src=\"/post/CSRF%E9%9D%B6%E5%9C%BA.htm/image-20220309111423015.png\" alt=\"image-20220309111423015\"></p>\n<h3 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p>修改地址为china</p>\n<p><img src=\"/post/CSRF%E9%9D%B6%E5%9C%BA.htm/image-20220309111640705.png\" alt=\"image-20220309111640705\"></p>\n<h3 id=\"0x04\"><a href=\"#0x04\" class=\"headerlink\" title=\"0x04\"></a>0x04</h3><p>生成攻击脚本</p>\n<p><img src=\"/post/CSRF%E9%9D%B6%E5%9C%BA.htm/image-20220309111721787.png\" alt=\"image-20220309111721787\"></p>\n<h3 id=\"0x05\"><a href=\"#0x05\" class=\"headerlink\" title=\"0x05\"></a>0x05</h3><p>访问伪造的url，点击submit request</p>\n<p><img src=\"/post/CSRF%E9%9D%B6%E5%9C%BA.htm/image-20220309111838945.png\" alt=\"image-20220309111838945\"></p>\n<h3 id=\"0x06\"><a href=\"#0x06\" class=\"headerlink\" title=\"0x06\"></a>0x06</h3><p>可以看到信息已经被修改</p>\n<p><img src=\"/post/CSRF%E9%9D%B6%E5%9C%BA.htm/image-20220309111912870.png\" alt=\"image-20220309111912870\"></p>\n<p><strong>注意：</strong>无论CSRF是基于GET方式或是基于POST方式，都需要在用户登录的情况下进行。</p>\n<p>##CSRF（Taken）</p>\n<h3 id=\"0x00-2\"><a href=\"#0x00-2\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p><img src=\"/post/CSRF%E9%9D%B6%E5%9C%BA.htm/image-20220309112401590.png\" alt=\"image-20220309112401590\"></p>\n<p>基于Taken的CSRF：敏感请求中加入了Token，从而不易进行伪造。在每次请求中，都会加入一个随机码，后台每次都会对提交请求中的Token值进行优先比较。</p>\n<h3 id=\"0x01-2\"><a href=\"#0x01-2\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p><strong>token防止跨站请求伪造的原理：</strong>在浏览器访问网站A时，网站A设置cookie会增加随机值token，这个值是随机的。返回给浏览器时，cookie会储存在浏览器，同时会把token传给表单里面的隐藏字段。所以当浏览器用自己的表单时会自带token，网站A取到这个值和cookie里的token一致就通过。而网站B里面的表单没有这个值，所以不能通过，这样就阻止了恶意攻击。非表单也是这样的原理。</p>\n","text":"环境准备1、靶场环境：Pikachu-CSRF 2、攻击机：Win10 CSRF（get）0x00首先进行登录： 0x01抓包构造伪链接： 0x02构造url伪链接，将地址修改为china： pikachu-master&#x2F;vul&#x2F;csrf&#x2F;csrfg...","link":"","photos":[],"count_time":{"symbolsCount":839,"symbolsTime":"1 mins."},"categories":[{"name":"CSRF","slug":"CSRF","count":2,"path":"api/categories/CSRF.json"}],"tags":[{"name":"CSRF","slug":"CSRF","count":2,"path":"api/tags/CSRF.json"},{"name":"靶场","slug":"靶场","count":12,"path":"api/tags/靶场.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87\"><span class=\"toc-text\">环境准备</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#CSRF%EF%BC%88get%EF%BC%89\"><span class=\"toc-text\">CSRF（get）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-1\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-1\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02-1\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x03\"><span class=\"toc-text\">0x03</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x04\"><span class=\"toc-text\">0x04</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x05\"><span class=\"toc-text\">0x05</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x06\"><span class=\"toc-text\">0x06</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-2\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-2\"><span class=\"toc-text\">0x01</span></a></li></ol></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"RCE代码及命令执行漏洞","uid":"99ef65eed770437be60664bb9539a369","slug":"RCE代码及命令执行漏洞","date":"2022-03-12T07:42:14.000Z","updated":"2022-03-12T08:38:19.341Z","comments":true,"path":"api/articles/RCE代码及命令执行漏洞.json","keywords":null,"cover":[],"text":"前言在 Web 应用中有时候程序员为了考虑灵活性、简洁性，会在代码调用代码或命令执行函数去处理。比如当应用在调用一些能将字符串转化成代码的函数时，没有考虑用户是否能控制这个字符串，将造成代码执行漏洞。同样调用系统命令处理，将造成命令执行漏洞。 脑图： RCE漏洞原理RCE(rem...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"RCE","slug":"RCE","count":3,"path":"api/categories/RCE.json"}],"tags":[{"name":"RCE","slug":"RCE","count":4,"path":"api/tags/RCE.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"SSRF基础","uid":"019bd9770b9072b146cab74b0206ca70","slug":"SSRF基础","date":"2022-02-28T11:46:22.000Z","updated":"2022-03-01T14:28:56.953Z","comments":true,"path":"api/articles/SSRF基础.json","keywords":null,"cover":[],"text":"SSRF漏洞概述SSRF，全称Server-Side Request Forgery，服务端请求伪造，是一种由攻击者构造形成由服务器发起请求的一个安全漏洞，SSRF的主要攻击目标为外网无法访问的内部系统。 以下为SSRF脑图： SSRF漏洞原理SSRF形成的原因是服务端提供了从其...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"SSRF","slug":"SSRF","count":2,"path":"api/categories/SSRF.json"}],"tags":[{"name":"SSRF","slug":"SSRF","count":2,"path":"api/tags/SSRF.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}