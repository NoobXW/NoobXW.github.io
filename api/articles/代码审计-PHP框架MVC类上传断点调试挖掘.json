{"title":"代码审计-PHP框架MVC类上传断点调试挖掘","uid":"702d6f073e84f9179e4d91ac7d1a1d09","slug":"代码审计-PHP框架MVC类上传断点调试挖掘","date":"2022-06-13T02:24:54.000Z","updated":"2022-06-14T12:06:41.086Z","comments":true,"path":"api/articles/代码审计-PHP框架MVC类上传断点调试挖掘.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"0x00-关键字搜索\"><a href=\"#0x00-关键字搜索\" class=\"headerlink\" title=\"0x00 关键字搜索\"></a>0x00 关键字搜索</h2><p>函数，键字，全局变量等</p>\n<p>文件上传的相关函数：move_uploaded_file 等；</p>\n<p>文件上传的关键字：在写上传的时候会有注释，如&#x2F;&#x2F;上传；</p>\n<p>全局变量$_FILES‘</p>\n<p>应用功能抓包：（任何可能存在上传的应用功能点），前台会员中心，后台新闻添加等可能存在上传的地方。</p>\n<p>PHP$_FILES函数：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220613103847741.png\" alt=\"image-20220613103847741\"></p>\n<p>参考文章：<br><a href=\"https://blog.csdn.net/haoyunyun888/article/details/81079274\">https://blog.csdn.net/haoyunyun888/article/details/81079274</a></p>\n<h2 id=\"0x01-MVC-开发框架类\"><a href=\"#0x01-MVC-开发框架类\" class=\"headerlink\" title=\"0x01 MVC 开发框架类\"></a>0x01 MVC 开发框架类</h2><p>MVC架构图解：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/web_mvc.gif\" alt=\"MVC流程图\"></p>\n<p>参考文章：</p>\n<p><a href=\"https://www.cnblogs.com/wsybky/p/8638876.html\">https://www.cnblogs.com/wsybky/p/8638876.html</a></p>\n<h2 id=\"0x02-Thinkphp框架\"><a href=\"#0x02-Thinkphp框架\" class=\"headerlink\" title=\"0x02 Thinkphp框架\"></a>0x02 Thinkphp框架</h2><p>参考文章：<br><a href=\"https://sites.thinkphp.cn/1556331\">https://sites.thinkphp.cn/1556331</a></p>\n<h2 id=\"0x03-BeesCMS无框架后台任意文件上传\"><a href=\"#0x03-BeesCMS无框架后台任意文件上传\" class=\"headerlink\" title=\"0x03 BeesCMS无框架后台任意文件上传\"></a>0x03 BeesCMS无框架后台任意文件上传</h2><h3 id=\"0x00\"><a href=\"#0x00\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p>思路：搜索$_FILES-&gt;后台中心-&gt;上传图像-&gt;跟踪代码-&gt;逻辑判断</p>\n<h3 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p>打开靶场首页：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614100822444.png\" alt=\"image-20220614100822444\"></p>\n<h3 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p>将源码载入到审计工具中：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614100856565.png\" alt=\"image-20220614100856565\"></p>\n<h3 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p>这里先使用搜索关键字进行查找相关功能点，搜索上传：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614101034190.png\" alt=\"image-20220614101034190\"></p>\n<p>有很多文件，截图只截了一部分，不便于查找，改搜索$_FILES：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614101201626.png\" alt=\"image-20220614101201626\"></p>\n<p>这里只有几个文件；并且根据文件的名字可以猜测是后台的文件上传。</p>\n<h3 id=\"0x04\"><a href=\"#0x04\" class=\"headerlink\" title=\"0x04\"></a>0x04</h3><p>随便打开一个文件查看，都是处理上传文件的过程：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614101519476.png\" alt=\"image-20220614101519476\"></p>\n<p>浏览器访问其文件，可以看到有上传的功能点：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614101706010.png\" alt=\"image-20220614101706010\"></p>\n<h3 id=\"0x05\"><a href=\"#0x05\" class=\"headerlink\" title=\"0x05\"></a>0x05</h3><p>先上传一个文件抓个包：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614102201599.png\" alt=\"image-20220614102201599\"></p>\n<p>数据包中有参数file_info,uppic：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614102437408.png\" alt=\"image-20220614102437408\"></p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614102418177.png\" alt=\"image-20220614102418177\"></p>\n<p>在源码中找到这两个参数进行审计：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614103100992.png\" alt=\"image-20220614103100992\"></p>\n<p>首先uppic使用post方式接收数据赋值给submit，如果submit存在数据，参数up使用post方式接收数据赋值给变量up，file_info利用post接收数据在利用fl_html()函数转化为html格式赋值给变量$file_info，变量$value_arr使用array()函数存储数组；explode()函数将文件类型以<code>|</code>分割为数组，—is_uploaded_file()函数检查指定的文件是否是通过 HTTP POST 上传的。如果文件是通过 HTTP POST 上传的返回 TRUE,可以用来确保恶意的用户无法欺骗脚本去访问本不能访问的文件。$_FILES<code>[&#39;up&#39;][&#39;tmp_name&#39;]</code>是is_uploaded_file()要检查的文件，up是要上传的表单名，tmp_name变量中的值就是文件在Web服务器中临时存储的位置（上传文件的临时保存文件），确定文件的大小限度（这里是系统设置的值），up_file处理上传的文件，并且验证是否符合上传标准根据up_file返回值（返回的字典形式）确定文件的路径、扩展名、大小、时间，最后在进行数据库的插入操作。</p>\n<p>涉及函数：</p>\n<p>is_uploaded_file() 函数：检查指定的文件是否是通过 HTTP POST 上传的。如果文件是通过 HTTP POST 上传的，该函数返回 TRUE。</p>\n<p>pathinfo() 函数以数组的形式返回关于文件路径的信息。</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614105551883.png\" alt=\"image-20220614105551883\"></p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614111248077.png\" alt=\"image-20220614111248077\"></p>\n<p>up_file()函数：（自定义函数）判断文件的大小，路径扩展名等。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">function up_file($file,$size,$type,$path&#x3D;&#39;&#39;,$name&#x3D;&#39;&#39;)&#123;\n\t\t$return_arr&#x3D;array();\n\t\tif(is_uploaded_file($file[&#39;tmp_name&#39;]))&#123;\n\t\tif($file[&#39;size&#39;]&gt;$size)&#123;msg(&#39;文件超过&#39;.$size.&#39;大小&#39;);&#125;\n\t\t$pic_name&#x3D;pathinfo($file[&#39;name&#39;]);\n\t\t$file_type&#x3D;$pic_name[&#39;extension&#39;];\n\t\t$return_arr[&#39;ext&#39;] &#x3D; $pic_name[&#39;extension&#39;];&#x2F;&#x2F;扩展名\n\t\t$return_arr[&#39;size&#39;] &#x3D; $file[&#39;size&#39;];&#x2F;&#x2F;大小\n\t\tif(!in_array($file_type,$type))&#123;msg(&#39;上传文件格式不正确&#39;.$file_type);&#125;\n\t\t$path&#x3D;empty($path)?CMS_PATH.&quot;upload&#x2F;file&#x2F;&quot;:CMS_PATH.$path.&#39;&#x2F;&#39;;\n\t\tif(!file_exists($path))&#123;\n\t\t\t@mkdir($path);\n\t\t&#125;\n\t\t$name&#x3D;$pic_name[&#39;filename&#39;].&#39;-&#39;.date(&#39;YmdHis&#39;);\n\t\t$name2&#x3D;iconv(&#39;UTF-8&#39;,&#39;GBK&#39;,$name);\n\n\t\t$file_name&#x3D;$path.$name2.&#39;.&#39;.$pic_name[&#39;extension&#39;];\n\t\t$file_name2&#x3D;$path.$name.&#39;.&#39;.$pic_name[&#39;extension&#39;];\n\t\t\n\t\tif(file_exists($file_name))&#123;\n\t\t\tmsg(&#39;已经存在该附件，请更改附件名称！&#39;);&#x2F;&#x2F;判断是否重名\n\t\t&#125;\n\t\t\n\t\tunset($pic_name);\n\t\tif(!move_uploaded_file($file[&#39;tmp_name&#39;],$file_name))&#123;\n\t\t\tmsg(&#39;文件上传失败&#39;);\n\t\t&#125;\n\t\t$return_name&#x3D;str_replace(CMS_PATH,&quot;&quot;,$file_name2);\n\t\t&#x2F;&#x2F;$return_name&#x3D;CMS_SELF.$return_name;\n\t\t$return_arr[&#39;file&#39;] &#x3D; $return_name;&#x2F;&#x2F;上传文件路径\n\t\t$return_arr[&#39;time&#39;] &#x3D; time();&#x2F;&#x2F;上传时间\n\t\t&#125;else&#123;\n\t\t\tmsg(&#39;文件不能为空&#39;);\n\t\t&#125;\n\t\t&#x2F;&#x2F;存储相关信息\n\t\t\n\treturn $return_arr;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p> explode() 函数：使用一个字符串分割另一个字符串，并返回由字符串组成的数组。</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614104132737.png\" alt=\"image-20220614104132737\"></p>\n<h3 id=\"0x06\"><a href=\"#0x06\" class=\"headerlink\" title=\"0x06\"></a>0x06</h3><p>将数据包放出去后查看返回信息，上传文件格式不正确。<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614105650535.png\" alt=\"image-20220614105650535\"></p>\n<p>up_file()函数定义返回数据包的结果，刚才的提示应该就是这段代码处理的：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614105745007.png\" alt=\"image-20220614105745007\"></p>\n<p>确定一下报错信息是否在这个代码段，加一个x在后面，再查看报错信息：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614105927939.png\" alt=\"image-20220614105927939\"></p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614110044649.png\" alt=\"image-20220614110044649\"></p>\n<p>可以看到报错信息有x，可以确定报错代码段就是up_file函数段，那这里绕过拓展名就可以达到上传的目的。</p>\n<p>pathinfo()函数接受文件名赋值给pic_name，pic_name又将文件的拓展名extension截取到赋值给file_type：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614110502104.png\" alt=\"image-20220614110502104\"></p>\n<p>之后file_type接受的文件名不在所定义的文件名中就会报错：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614110323811.png\" alt=\"image-20220614110323811\"></p>\n<h3 id=\"0x07\"><a href=\"#0x07\" class=\"headerlink\" title=\"0x07\"></a>0x07</h3><p>这里尝试绕过pathinfo()函数的后缀名检测：只要接收的后缀名能够是自定义的即可进行绕过，但根据测试来看，pathinfo()函数只接收最后一个<code>.</code>之后的后缀名，导致无法添加多个后缀名绕过：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614111633265.png\" alt=\"image-20220614111633265\"></p>\n<p>尝试00截断，先上传一个符合要求的后缀名文件，之后添加<code>.php%00</code>（由于是post方式提交，这里的%00需要编码），放包之后回显还是报错，并且结果是php后缀名的报错，证明截断成功了，但是接受的是php文件，导致又被过滤上传失败，这个地方绕过不了。</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614112913552.png\" alt=\"image-20220614112913552\"></p>\n<h3 id=\"0x08\"><a href=\"#0x08\" class=\"headerlink\" title=\"0x08\"></a>0x08</h3><p>换一个$_FILES函数存在的文件（admin_pic_upload.php：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614114023164.png\" alt=\"image-20220614114023164\"></p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614114035955.png\" alt=\"image-20220614114035955\"></p>\n<p>找到过滤代码函数up_img()，定位：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614114148066.png\" alt=\"image-20220614114148066\"></p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614114241047.png\" alt=\"image-20220614114241047\"></p>\n<p>这里只判断了图片大小和格式，并且只判断了上传图片的格式，如果图片格式正确可以实现绕过。（MIME类型）</p>\n<h3 id=\"0x09\"><a href=\"#0x09\" class=\"headerlink\" title=\"0x09\"></a>0x09</h3><p>浏览器打开访问地址：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614114953808.png\" alt=\"image-20220614114953808\"></p>\n<p>上传文件测试，可以看到有返回路径：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614115352164.png\" alt=\"image-20220614115352164\"></p>\n<h3 id=\"0x10\"><a href=\"#0x10\" class=\"headerlink\" title=\"0x10\"></a>0x10</h3><p>修改后缀上传php文件，放包：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614115751428.png\" alt=\"image-20220614115751428\"></p>\n<p>打开文件路径可以看到php文件上传成功，之后使用连接工具可以进行获取权限。</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614115741878.png\" alt=\"image-20220614115741878\"></p>\n<p>这里就挖到了文件上传漏洞。</p>\n<h2 id=\"0x04-PHPStorm-Xdebug断点调试\"><a href=\"#0x04-PHPStorm-Xdebug断点调试\" class=\"headerlink\" title=\"0x04 PHPStorm+Xdebug断点调试\"></a>0x04 PHPStorm+Xdebug断点调试</h2><h3 id=\"0x00-1\"><a href=\"#0x00-1\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p>使用PHPStorm+Xdebug断点调试配置教程和下载地址：</p>\n<p>Xdebug下载地址： </p>\n<p><a href=\"https://xdebug.org/download/historical\">https://xdebug.org/download/historical</a></p>\n<p>PhpStorm+Xdebug+phpstudy配置教程（很细的一篇教程）：</p>\n<p><a href=\"https://blog.csdn.net/weixin_41707419/article/details/123662603\">https://blog.csdn.net/weixin_41707419/article/details/123662603</a></p>\n<h3 id=\"0x01-1\"><a href=\"#0x01-1\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p>配置完成环境后，使用phpstorm加载项目：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614170123734.png\" alt=\"image-20220614170123734\"></p>\n<p>打开监听端口，点击调试：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614183007629.png\" alt=\"image-20220614183007629\"></p>\n<h3 id=\"0x01-2\"><a href=\"#0x01-2\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p>可以看到test正在调试，url的路径出现xdebug的参数，并且自动在浏览器打开相应页面，之后可以使用步入键等一步一步查看代码运行过程：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614185413592.png\" alt=\"image-20220614185413592\"></p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614185440394.png\" alt=\"image-20220614185440394\"></p>\n<p>箭头向下是步入下一步，第二个是强制步入，箭头向上是跳出，点击向下的箭头，会依次执行函数和文件（包括文件包含的文件的每一步）。</p>\n<h3 id=\"0x02-1\"><a href=\"#0x02-1\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p>断点调试优点：</p>\n<p>1、不需要看懂代码，就知道经历了那些函数，和涉及的参数</p>\n<p>2、这里的抓包是从代码层面</p>\n<p>3、主要运用在Java，因为Java框架比较多，很可能看不懂，在这里就需要运用到断点调试</p>\n<h2 id=\"0x05-Finecms基于前台MVC任意文件上传\"><a href=\"#0x05-Finecms基于前台MVC任意文件上传\" class=\"headerlink\" title=\"0x05 Finecms基于前台MVC任意文件上传\"></a>0x05 Finecms基于前台MVC任意文件上传</h2><h3 id=\"0x00-2\"><a href=\"#0x00-2\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p>打开靶场，点击会员中心：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614191032509.png\" alt=\"image-20220614191032509\"></p>\n<p>有上传头像的功能，可以测试是否存在文件上传漏洞。</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614191043549.png\" alt=\"image-20220614191043549\"></p>\n<h3 id=\"0x01-3\"><a href=\"#0x01-3\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p>上传文件抓包，（基于MVC的框架网站）</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614191416832.png\" alt=\"image-20220614191416832\"></p>\n<h3 id=\"0x02-2\"><a href=\"#0x02-2\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p><strong>MVC简介：</strong></p>\n<p>1、模型Model：管理大部分的业务逻辑和所有的数据库逻辑。模型提供了连接和操作数据库的抽象层。</p>\n<p>2、控制器Controller - 负责响应用户请求、准备数据，以及决定如何展示数据。</p>\n<p>3、视图View – 负责渲染数据，通过HTML方式呈现给用户</p>\n<p><strong>一个典型的Web MVC流程：</strong></p>\n<p>1、Controller截获用户发出的请求；</p>\n<p>2、Controller调用Model完成状态的读写操作；</p>\n<p>3、Controller把数据传递给View；</p>\n<p>4、View渲染最终结果并呈献给用户.</p>\n<h3 id=\"0x03-1\"><a href=\"#0x03-1\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p>数据包中s&#x3D;member，c&#x3D;account，m&#x3D;upload这些参数在index.php代码中去找：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614192035084.png\" alt=\"image-20220614192035084\"></p>\n<p>index.php没有找到s,c,m接收参数的代码，这就是典型的MVC的框架，即核心代码没有在指向文件里面，需要查看入口文件；这里的入口文件，FCPPATH(后面有一个fineCMS的目录)和WEBPATH，包含了init.php文件(FCPPATH为定义的路径)；</p>\n<h3 id=\"0x04-1\"><a href=\"#0x04-1\" class=\"headerlink\" title=\"0x04\"></a>0x04</h3><p>查看finecms目录，有init.php文件和三个文件夹：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614192507065.png\" alt=\"image-20220614192507065\"></p>\n<p>打开init.php文件：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614192529884.png\" alt=\"image-20220614192529884\"></p>\n<p>这里system目录下就是框架的代码，dayrui是二次开发的代码；</p>\n<p>根据路由规则匹配参数（也就是传递参数的规则）</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614192903976.png\" alt=\"image-20220614192903976\"></p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614193317690.png\" alt=\"image-20220614193317690\"></p>\n<p>这段代码看到s，c，m这三个参数，看到相应目录；数据包中的<strong>s对应目录</strong>，<strong>c对应文件名</strong>,<strong>m对应方法</strong>。</p>\n<h3 id=\"0x05-1\"><a href=\"#0x05-1\" class=\"headerlink\" title=\"0x05\"></a>0x05</h3><p>在MVC框架内的controller中，查找member目录，文件名为account，函数为upload（一般核心代码都在控制器里面）</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614193202538.png\" alt=\"image-20220614193202538\"></p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614193428734.png\" alt=\"image-20220614193428734\"></p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614194116520.png\" alt=\"image-20220614194116520\"></p>\n<p>在controllers文件夹下查找account.php文件下的upload方法，post传参，tx接收参数，然后用将空替换为+，赋值为file，file再使用正则表达式匹配规则匹配出合适的值将结果赋值给result；之后使用new_file接收文件地址，在这里没有任何过滤；下面的代码才是过滤。</p>\n<p>代码中输出result[2]的值查看结果：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614195023626.png\" alt=\"image-20220614195023626\"></p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614195233953.png\" alt=\"image-20220614195233953\"></p>\n<p>返回jpeg，证明result[2]存储的就是后缀名；</p>\n<p>输出new_file值，图片路径：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614200319863.png\" alt=\"image-20220614200319863\"></p>\n<h3 id=\"0x06-1\"><a href=\"#0x06-1\" class=\"headerlink\" title=\"0x06\"></a>0x06</h3><p>这里可以确定[0]是全部的数据，[1]是data，[2]是png（文件后缀名），[3]是base64</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614200415729.png\" alt=\"image-20220614200415729\"></p>\n<h3 id=\"0x07-1\"><a href=\"#0x07-1\" class=\"headerlink\" title=\"0x07\"></a>0x07</h3><p>抓包直接上传文件返回1</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614194030003.png\" alt=\"image-20220614194030003\"></p>\n<p>由于没有验证，修改后缀名上传：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614194425996.png\" alt=\"image-20220614194425996\"></p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%A1%86%E6%9E%B6MVC%E7%B1%BB%E4%B8%8A%E4%BC%A0%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95%E6%8C%96%E6%8E%98.htm/image-20220614200520750.png\" alt=\"image-20220614200520750\"></p>\n<p>可以看到上传成功。</p>\n<h3 id=\"0x08-总结\"><a href=\"#0x08-总结\" class=\"headerlink\" title=\"0x08 总结\"></a>0x08 总结</h3><p>1、业务功能分析-&gt;会员中心-&gt;上传图像-&gt;跟踪代码-&gt;逻辑判断；</p>\n<p>2、存在逻辑漏洞，即先上传，后验证。</p>\n","text":"0x00 关键字搜索函数，键字，全局变量等 文件上传的相关函数：move_uploaded_file 等； 文件上传的关键字：在写上传的时候会有注释，如&#x2F;&#x2F;上传； 全局变量$_FILES‘ 应用功能抓包：（任何可能存在上传的应用功能点），前台会员中心，后台新闻...","link":"","photos":[],"count_time":{"symbolsCount":"5.4k","symbolsTime":"5 mins."},"categories":[{"name":"代码审计","slug":"代码审计","count":4,"path":"api/categories/代码审计.json"}],"tags":[{"name":"代码审计","slug":"代码审计","count":6,"path":"api/tags/代码审计.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x00-%E5%85%B3%E9%94%AE%E5%AD%97%E6%90%9C%E7%B4%A2\"><span class=\"toc-text\">0x00 关键字搜索</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01-MVC-%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E7%B1%BB\"><span class=\"toc-text\">0x01 MVC 开发框架类</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02-Thinkphp%E6%A1%86%E6%9E%B6\"><span class=\"toc-text\">0x02 Thinkphp框架</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03-BeesCMS%E6%97%A0%E6%A1%86%E6%9E%B6%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0\"><span class=\"toc-text\">0x03 BeesCMS无框架后台任意文件上传</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x03\"><span class=\"toc-text\">0x03</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x04\"><span class=\"toc-text\">0x04</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x05\"><span class=\"toc-text\">0x05</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x06\"><span class=\"toc-text\">0x06</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x07\"><span class=\"toc-text\">0x07</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x08\"><span class=\"toc-text\">0x08</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x09\"><span class=\"toc-text\">0x09</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x10\"><span class=\"toc-text\">0x10</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x04-PHPStorm-Xdebug%E6%96%AD%E7%82%B9%E8%B0%83%E8%AF%95\"><span class=\"toc-text\">0x04 PHPStorm+Xdebug断点调试</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-1\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-1\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-2\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02-1\"><span class=\"toc-text\">0x02</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x05-Finecms%E5%9F%BA%E4%BA%8E%E5%89%8D%E5%8F%B0MVC%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0\"><span class=\"toc-text\">0x05 Finecms基于前台MVC任意文件上传</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-2\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-3\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02-2\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x03-1\"><span class=\"toc-text\">0x03</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x04-1\"><span class=\"toc-text\">0x04</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x05-1\"><span class=\"toc-text\">0x05</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x06-1\"><span class=\"toc-text\">0x06</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x07-1\"><span class=\"toc-text\">0x07</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x08-%E6%80%BB%E7%BB%93\"><span class=\"toc-text\">0x08 总结</span></a></li></ol></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"代码审计-TP5框架1","uid":"189405de58d744911bbd6ef55ac89edc","slug":"代码审计-TP5框架1","date":"2022-06-18T01:49:09.000Z","updated":"2022-06-18T15:42:07.123Z","comments":true,"path":"api/articles/代码审计-TP5框架1.json","keywords":null,"cover":[],"text":"0x00脑图： 0x01 Metinfo-无框架-变量覆盖-自动审计或搜索0x00打开靶场： 0x01使用seay先进行自动审计： 检测到可能存在变量覆盖漏洞： 0x02打开其配置文件审计相关函数： 可以看到双$$符号。 foreach()函数，每次循环中，当前单元的值被赋给 $...","link":"","photos":[],"count_time":{"symbolsCount":"2.2k","symbolsTime":"2 mins."},"categories":[{"name":"代码审计","slug":"代码审计","count":4,"path":"api/categories/代码审计.json"}],"tags":[{"name":"代码审计","slug":"代码审计","count":6,"path":"api/tags/代码审计.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"代码审计-CMS靶场","uid":"54d8350a6e513341975c7d9c3662fe93","slug":"代码审计-CMS靶场","date":"2022-06-12T08:33:39.000Z","updated":"2022-06-12T11:18:54.947Z","comments":true,"path":"api/articles/代码审计-CMS靶场.json","keywords":null,"cover":[],"text":"0x00 骑士人才招聘系统-SQL注入挖掘0x00靶场：骑士人才招聘系统PHPCMS，3.4版本； 描述：源码自带过滤机制。 0x01使用seay源代码审计系统分析源码： 0x02分析时需要找全局配置文件，一般全局配置文件就会又过滤机制； 一般全局配置文件则是需要其他问价加载时包...","link":"","photos":[],"count_time":{"symbolsCount":"2.2k","symbolsTime":"2 mins."},"categories":[{"name":"代码审计","slug":"代码审计","count":4,"path":"api/categories/代码审计.json"}],"tags":[{"name":"代码审计","slug":"代码审计","count":6,"path":"api/tags/代码审计.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}