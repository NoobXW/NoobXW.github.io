{"title":"墨者学院-投票系统程序设计缺陷分析","uid":"383f41268e6540fac61ee779bce8168d","slug":"墨者学院-投票系统程序设计缺陷分析","date":"2022-01-24T05:39:13.000Z","updated":"2022-03-20T11:50:56.550Z","comments":true,"path":"api/articles/墨者学院-投票系统程序设计缺陷分析.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><p>[TOC]</p>\n<h2 id=\"0x00\"><a href=\"#0x00\" class=\"headerlink\" title=\"0x00\"></a>0x00</h2><p>启动靶场进入靶场的投票页面：</p>\n<p><img src=\"/post/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-%E6%8A%95%E7%A5%A8%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%88%86%E6%9E%90.htm/image-20220124134028395.png\" alt=\"image-20220124134028395\"></p>\n<p><img src=\"/post/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-%E6%8A%95%E7%A5%A8%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%88%86%E6%9E%90.htm/image-20220124134148994.png\" alt=\"image-20220124134148994\"></p>\n<p>页面提示每个IP每天只限投一次票</p>\n<h2 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h2><p>先抓个包看看：<br><img src=\"/post/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-%E6%8A%95%E7%A5%A8%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%88%86%E6%9E%90.htm/image-20220124134339926.png\" alt=\"image-20220124134339926\"></p>\n<p>为ggg投完票后显示id&#x3D;7，且返回结果0；</p>\n<p>再给ggg投票抓包看结果：</p>\n<p><img src=\"/post/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-%E6%8A%95%E7%A5%A8%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%88%86%E6%9E%90.htm/image-20220124134523763.png\" alt=\"image-20220124134523763\"></p>\n<p>结果返回-1，并提示投票机会用完<br><img src=\"/post/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-%E6%8A%95%E7%A5%A8%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%88%86%E6%9E%90.htm/image-20220124134554092.png\" alt=\"image-20220124134554092\"></p>\n<h2 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h2><p>根据提示信息：</p>\n<p><img src=\"/post/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-%E6%8A%95%E7%A5%A8%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%88%86%E6%9E%90.htm/image-20220124134757069.png\" alt=\"image-20220124134757069\"></p>\n<p>应该是<strong>利用X-Forwarded-For伪造IP</strong>进行投票</p>\n<h2 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h2><p>重新抓包随便构造IP</p>\n<p><img src=\"/post/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-%E6%8A%95%E7%A5%A8%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%88%86%E6%9E%90.htm/image-20220124142954500.png\" alt=\"image-20220124142954500\"></p>\n<p><strong>标注一下</strong>：</p>\n<p>这步我自己其实耗费了很长时间，知道怎么去爆破，但遗漏了一个知识点，导致花费了很长时间才完成，如下：</p>\n<p>Request请求数据包格式：</p>\n<p>1.请求行：请求类型&#x2F;请求资源路径、协议的版本和类型</p>\n<p>2.请求头：一些键值对，浏览器与 web 服务器之间都可以发送，特定的某种含义</p>\n<p>3**.空行**：请求头与请求体之间用一个空行隔开</p>\n<p>4.请求体：要发送的数据(一般 post 提交会使用)；例：user&#x3D;123&amp;pass&#x3D;123</p>\n<p>由下图可知请求数据包的最后一个字段是请求体并且是POST方式，请求体上一行有一行空格，导致我爆破的时候，将XFF放在了<strong>空行</strong>的位置上，导致爆破的时候一直返回无效的HTTP请求。最后才发现数据包的格式错误。<strong>请求体上一行的一定是空行，什么都不能填</strong></p>\n<p>之后在BP中的Intruder中选择爆破类型，选择爆破参数，这里的爆破参数为网段位和主机位</p>\n<p>（只要票数得了第一就好，爆破参数随便几位）</p>\n<p><img src=\"/post/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-%E6%8A%95%E7%A5%A8%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%88%86%E6%9E%90.htm/image-20220124143029228.png\" alt=\"image-20220124143029228\"></p>\n<h2 id=\"0x04\"><a href=\"#0x04\" class=\"headerlink\" title=\"0x04\"></a>0x04</h2><p>之后BP中 的Payloads中修改Payload set和Payload type，类型一定是Numbers，然后这里我设置的是从1到200，每次增加1票</p>\n<p><img src=\"/post/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-%E6%8A%95%E7%A5%A8%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%88%86%E6%9E%90.htm/image-20220124144505974.png\" alt=\"image-20220124144505974\"></p>\n<p><img src=\"/post/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-%E6%8A%95%E7%A5%A8%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%88%86%E6%9E%90.htm/image-20220124144438838.png\" alt=\"image-20220124144438838\"></p>\n<h2 id=\"0x05\"><a href=\"#0x05\" class=\"headerlink\" title=\"0x05\"></a>0x05</h2><p>如图爆破的每个数据回应包都返回是0，而上面抓包可知重复IP投票返回的结果是-1，则证明投票成功。</p>\n<p><img src=\"/post/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-%E6%8A%95%E7%A5%A8%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%88%86%E6%9E%90.htm/image-20220124144743018.png\" alt=\"image-20220124144743018\"></p>\n<h2 id=\"0x06\"><a href=\"#0x06\" class=\"headerlink\" title=\"0x06\"></a>0x06</h2><p>最后返回投票页面刷新页面得到KEY</p>\n<p><img src=\"/post/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-%E6%8A%95%E7%A5%A8%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%88%86%E6%9E%90.htm/image-20220124143255045.png\" alt=\"image-20220124143255045\"></p>\n<p><img src=\"/post/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2-%E6%8A%95%E7%A5%A8%E7%B3%BB%E7%BB%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7%E5%88%86%E6%9E%90.htm/image-20220124145042114.png\" alt=\"image-20220124145042114\"></p>\n<p>完成靶场。</p>\n","text":"[TOC] 0x00启动靶场进入靶场的投票页面： 页面提示每个IP每天只限投一次票 0x01先抓个包看看： 为ggg投完票后显示id&#x3D;7，且返回结果0； 再给ggg投票抓包看结果： 结果返回-1，并提示投票机会用完 0x02根据提示信息： 应该是利用X-Forwarde...","link":"","photos":[],"count_time":{"symbolsCount":765,"symbolsTime":"1 mins."},"categories":[{"name":"靶场","slug":"靶场","count":4,"path":"api/categories/靶场.json"}],"tags":[{"name":"CTF","slug":"CTF","count":19,"path":"api/tags/CTF.json"},{"name":"靶场","slug":"靶场","count":12,"path":"api/tags/靶场.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x00\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03\"><span class=\"toc-text\">0x03</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x04\"><span class=\"toc-text\">0x04</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x05\"><span class=\"toc-text\">0x05</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x06\"><span class=\"toc-text\">0x06</span></a></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"搭建安全拓展","uid":"4a072225e90c93d078c9522dadc7362a","slug":"搭建安全拓展","date":"2022-01-24T13:36:09.000Z","updated":"2022-02-13T15:47:55.861Z","comments":true,"path":"api/articles/搭建安全拓展.json","keywords":null,"cover":null,"text":"[TOC] 知识点常见搭建平台脚本启用 域名 IP 目录解析安全问题 常见文件后缀解析对应安全 常见安全测试中的安全防护 WEB 后门与用户及文件权限 1.ASP,PHP,ASPX,JSP,PY,JAVAWEB 等环境 2.WEB 源码中敏感文件 后台路径，数据库配置文件，备份文...","link":"","photos":[],"count_time":{"symbolsCount":378,"symbolsTime":"1 mins."},"categories":[{"name":"基础知识","slug":"基础知识","count":8,"path":"api/categories/基础知识.json"}],"tags":[{"name":"基础知识","slug":"基础知识","count":12,"path":"api/tags/基础知识.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"墨者学院-HTTP动作练习","uid":"abc9d3adbc1e88211294230cb4be2455","slug":"墨者学院-HTTP动作练习","date":"2022-01-24T04:51:02.000Z","updated":"2022-03-20T11:49:55.458Z","comments":true,"path":"api/articles/墨者学院-HTTP动作练习.json","keywords":null,"cover":[],"text":"[TOC] 0x00首先启动靶场 返回结果是由于请求的URL太长，给的提示也是url这么长，GET合适么？说明请求的方式是GET 0x01先抓个包验证一下是不是GET方式 由包来看确实是GET方式，并且内容很多 0x02由于HTTP中GET请求方式和POST请求方式两者有区别，并...","link":"","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"靶场","slug":"靶场","count":4,"path":"api/categories/靶场.json"}],"tags":[{"name":"CTF","slug":"CTF","count":19,"path":"api/tags/CTF.json"},{"name":"靶场","slug":"靶场","count":12,"path":"api/tags/靶场.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}