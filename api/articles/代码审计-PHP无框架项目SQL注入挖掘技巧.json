{"title":"代码审计--PHP无框架项目SQL注入挖掘技巧","uid":"731c1533414732448019e85116b30fa4","slug":"代码审计-PHP无框架项目SQL注入挖掘技巧","date":"2022-06-11T09:55:23.000Z","updated":"2022-07-23T15:41:11.307Z","comments":true,"path":"api/articles/代码审计-PHP无框架项目SQL注入挖掘技巧.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"0x00\"><a href=\"#0x00\" class=\"headerlink\" title=\"0x00\"></a>0x00</h2><p>脑图：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%97%A0%E6%A1%86%E6%9E%B6%E9%A1%B9%E7%9B%AESQL%E6%B3%A8%E5%85%A5%E6%8C%96%E6%8E%98%E6%8A%80%E5%B7%A7.htm/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1.png\" alt=\"代码审计\"></p>\n<h2 id=\"0x01-使用Fortify进行代码审计\"><a href=\"#0x01-使用Fortify进行代码审计\" class=\"headerlink\" title=\"0x01 使用Fortify进行代码审计\"></a>0x01 使用Fortify进行代码审计</h2><p>使用sql靶场源代码为例，颜色代表漏洞危害等级，也可调试代码，可以为繁琐的手工审计节省出大量时间。</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%97%A0%E6%A1%86%E6%9E%B6%E9%A1%B9%E7%9B%AESQL%E6%B3%A8%E5%85%A5%E6%8C%96%E6%8E%98%E6%8A%80%E5%B7%A7.htm/image-20220611221843613.png\" alt=\"image-20220611221843613\"></p>\n<h2 id=\"0x02-定点挖掘\"><a href=\"#0x02-定点挖掘\" class=\"headerlink\" title=\"0x02 定点挖掘\"></a>0x02 定点挖掘</h2><h3 id=\"0x00-关键字\"><a href=\"#0x00-关键字\" class=\"headerlink\" title=\"0x00 关键字\"></a>0x00 关键字</h3><p>通过搜索特定关键字尝试寻找特定漏洞，如“select”“insert”“update”等与SQL漏洞自身相关的关键字，或者与变量，特定函数相关的关键字。</p>\n<h3 id=\"0x01-功能点\"><a href=\"#0x01-功能点\" class=\"headerlink\" title=\"0x01 功能点\"></a>0x01 功能点</h3><p>漏洞依靠特定函数实现，而特定函数一般用于实现相关功能。寻找相关功能点，抓包分析找到源码中特定的文件代码段，进行代码分析。</p>\n<p>例如文件上传漏洞，若存在上传的地址，之后通过上传的功能代码进行漏洞挖掘；sql注入也是同理，代码审计时候需要找到和数据库交互的代码段进行测试。</p>\n<h3 id=\"0x02-拓展\"><a href=\"#0x02-拓展\" class=\"headerlink\" title=\"0x02 拓展\"></a>0x02 拓展</h3><p>例如：sql注入</p>\n<p>1、数据库监控：监控当前页面和数据库交互的过程，即SQL语句的执行，适用于SQL注入；</p>\n<p>2、断点调试：访问页面对应代码进行断点调试，了解代码执行的前后顺序，调用的文件列表等。</p>\n<h2 id=\"0x03-sqqyw源码审计\"><a href=\"#0x03-sqqyw源码审计\" class=\"headerlink\" title=\"0x03 sqqyw源码审计\"></a>0x03 sqqyw源码审计</h2><h3 id=\"0x00-1\"><a href=\"#0x00-1\" class=\"headerlink\" title=\"0x00\"></a>0x00</h3><p>将源文件加载到工具当中：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%97%A0%E6%A1%86%E6%9E%B6%E9%A1%B9%E7%9B%AESQL%E6%B3%A8%E5%85%A5%E6%8C%96%E6%8E%98%E6%8A%80%E5%B7%A7.htm/image-20220611225221494.png\" alt=\"image-20220611225221494\"></p>\n<h3 id=\"0x01\"><a href=\"#0x01\" class=\"headerlink\" title=\"0x01\"></a>0x01</h3><p>搜索特定关键字，如：select，where等；</p>\n<p>全局搜索select：<br><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%97%A0%E6%A1%86%E6%9E%B6%E9%A1%B9%E7%9B%AESQL%E6%B3%A8%E5%85%A5%E6%8C%96%E6%8E%98%E6%8A%80%E5%B7%A7.htm/image-20220611225417110.png\" alt=\"image-20220611225417110\"></p>\n<h3 id=\"0x02\"><a href=\"#0x02\" class=\"headerlink\" title=\"0x02\"></a>0x02</h3><p>打开其中一个发现编码有问题更改编码：</p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%97%A0%E6%A1%86%E6%9E%B6%E9%A1%B9%E7%9B%AESQL%E6%B3%A8%E5%85%A5%E6%8C%96%E6%8E%98%E6%8A%80%E5%B7%A7.htm/image-20220611225457398.png\" alt=\"image-20220611225457398\"></p>\n<p><img src=\"/post/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-PHP%E6%97%A0%E6%A1%86%E6%9E%B6%E9%A1%B9%E7%9B%AESQL%E6%B3%A8%E5%85%A5%E6%8C%96%E6%8E%98%E6%8A%80%E5%B7%A7.htm/image-20220611225608673.png\" alt=\"image-20220611225608673\"></p>\n<h3 id=\"0x03\"><a href=\"#0x03\" class=\"headerlink\" title=\"0x03\"></a>0x03</h3><p> 之后对参数点，功能点进行追踪分析是否存在SQL注入漏洞；若存在注入点利用SQL注入的思路进行SQL注入。</p>\n","text":"0x00脑图： 0x01 使用Fortify进行代码审计使用sql靶场源代码为例，颜色代表漏洞危害等级，也可调试代码，可以为繁琐的手工审计节省出大量时间。 0x02 定点挖掘0x00 关键字通过搜索特定关键字尝试寻找特定漏洞，如“select”“insert”“update”等与...","link":"","photos":[],"count_time":{"symbolsCount":574,"symbolsTime":"1 mins."},"categories":[{"name":"代码审计","slug":"代码审计","count":4,"path":"api/categories/代码审计.json"}],"tags":[{"name":"SQL注入","slug":"SQL注入","count":21,"path":"api/tags/SQL注入.json"},{"name":"代码审计","slug":"代码审计","count":6,"path":"api/tags/代码审计.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x00\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01-%E4%BD%BF%E7%94%A8Fortify%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1\"><span class=\"toc-text\">0x01 使用Fortify进行代码审计</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02-%E5%AE%9A%E7%82%B9%E6%8C%96%E6%8E%98\"><span class=\"toc-text\">0x02 定点挖掘</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-%E5%85%B3%E9%94%AE%E5%AD%97\"><span class=\"toc-text\">0x00 关键字</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01-%E5%8A%9F%E8%83%BD%E7%82%B9\"><span class=\"toc-text\">0x01 功能点</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02-%E6%8B%93%E5%B1%95\"><span class=\"toc-text\">0x02 拓展</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03-sqqyw%E6%BA%90%E7%A0%81%E5%AE%A1%E8%AE%A1\"><span class=\"toc-text\">0x03 sqqyw源码审计</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x00-1\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x01\"><span class=\"toc-text\">0x01</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x02\"><span class=\"toc-text\">0x02</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#0x03\"><span class=\"toc-text\">0x03</span></a></li></ol></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"代码审计-CMS靶场","uid":"54d8350a6e513341975c7d9c3662fe93","slug":"代码审计-CMS靶场","date":"2022-06-12T08:33:39.000Z","updated":"2022-06-12T11:18:54.947Z","comments":true,"path":"api/articles/代码审计-CMS靶场.json","keywords":null,"cover":[],"text":"0x00 骑士人才招聘系统-SQL注入挖掘0x00靶场：骑士人才招聘系统PHPCMS，3.4版本； 描述：源码自带过滤机制。 0x01使用seay源代码审计系统分析源码： 0x02分析时需要找全局配置文件，一般全局配置文件就会又过滤机制； 一般全局配置文件则是需要其他问价加载时包...","link":"","photos":[],"count_time":{"symbolsCount":"2.2k","symbolsTime":"2 mins."},"categories":[{"name":"代码审计","slug":"代码审计","count":4,"path":"api/categories/代码审计.json"}],"tags":[{"name":"代码审计","slug":"代码审计","count":6,"path":"api/tags/代码审计.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"WAF绕过-权限控制","uid":"21e0a43668edaae60c8a409447987781","slug":"WAF绕过-权限控制","date":"2022-06-11T02:42:28.000Z","updated":"2022-06-11T04:05:32.404Z","comments":true,"path":"api/articles/WAF绕过-权限控制.json","keywords":null,"cover":[],"text":"0x00脑图： 0x01 变量覆盖一句话木马，用eval()函数将字符串转换为PHP代码： &lt;?php @ev删掉这串汉字al($_POST[‘chop删掉这串汉字per’]);?> 用ass删掉这串汉字ert代替eval()： （eval()会被检测） &lt;?php ...","link":"","photos":[],"count_time":{"symbolsCount":959,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"Bypass WAF","slug":"Bypass-WAF","count":7,"path":"api/tags/Bypass-WAF.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}