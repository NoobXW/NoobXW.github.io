{"title":"WAF绕过-漏洞利用之注入上传跨站等绕过","uid":"33e492c349a108568658a2914e822de5","slug":"WAF绕过-漏洞利用之注入上传跨站等绕过","date":"2022-06-10T14:12:41.000Z","updated":"2022-06-10T15:42:56.054Z","comments":true,"path":"api/articles/WAF绕过-漏洞利用之注入上传跨站等绕过.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><h2 id=\"0x00\"><a href=\"#0x00\" class=\"headerlink\" title=\"0x00\"></a>0x00</h2><p>脑图：<br><img src=\"/post/WAF%E7%BB%95%E8%BF%87-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E4%B9%8B%E6%B3%A8%E5%85%A5%E4%B8%8A%E4%BC%A0%E8%B7%A8%E7%AB%99%E7%AD%89%E7%BB%95%E8%BF%87.htm/WAF%E7%BB%95%E8%BF%87-%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8.png\" alt=\"WAF绕过-漏洞利用\"></p>\n<h2 id=\"0x01-SQL注入\"><a href=\"#0x01-SQL注入\" class=\"headerlink\" title=\"0x01 SQL注入\"></a>0x01 SQL注入</h2><p>使用如sqlmap等工具注入时，为防止CC拦截，修改数据包us头模仿爬虫，或使用代理池</p>\n<p>安全狗：参考之前payload</p>\n<p>Aliyun：基本修改指纹即可</p>\n<p>宝塔：匹配关键字，包括“&#x2F;*”，注入语句的每个“&#x2F;*”都改为“%00&#x2F;*”（利用了00截断）</p>\n<p>sqlmap使用语句：sqlmap –proxy&#x3D;”<a href=\"http://127.0.0.1:8080/\">http://127.0.0.1:8080</a>“ –tamper&#x3D;”waf.py” –random-agent</p>\n<p>sqlmap也可以用“–user-agent”指定ua</p>\n<p><strong>（WAF有检测各种注入工具的请求头，因此要修改UA）</strong></p>\n<h2 id=\"0x02-文件上传\"><a href=\"#0x02-文件上传\" class=\"headerlink\" title=\"0x02 文件上传\"></a>0x02 文件上传</h2><p>截断，参考之前文件上传waf绕过payload。</p>\n<h2 id=\"0x03-XSS跨站\"><a href=\"#0x03-XSS跨站\" class=\"headerlink\" title=\"0x03 XSS跨站\"></a>0x03 XSS跨站</h2><p>利用XSStrike绕过，加上“–timeout”或“–proxy”绕过CC。</p>\n<h2 id=\"0x04-RCE\"><a href=\"#0x04-RCE\" class=\"headerlink\" title=\"0x04 RCE\"></a>0x04 RCE</h2><p>1、加解密：尝试用base64、ASCII码等可逆的加密绕过；</p>\n<p>2、替换：在数据中插入某字符，同时加入将该字符替换为空的函数；</p>\n<p>3、利用变量覆盖或者把函数拆开然后用参数拼接（CTF常考）；</p>\n<p>4、base64不行就用ASCII码，加解密不行就用替换，GET不行就用REQUEST；</p>\n<h2 id=\"0x05-文件包含\"><a href=\"#0x05-文件包含\" class=\"headerlink\" title=\"0x05 文件包含\"></a>0x05 文件包含</h2><p>符号变异，“\\”“&#x2F;”</p>\n<h2 id=\"0x06-逻辑漏洞\"><a href=\"#0x06-逻辑漏洞\" class=\"headerlink\" title=\"0x06 逻辑漏洞\"></a>0x06 逻辑漏洞</h2><p>逻辑越权类的漏洞WAF不容易检测，也不容易拦截，一般不需要绕过WAF，基本不受WAF影响。</p>\n","text":"0x00脑图： 0x01 SQL注入使用如sqlmap等工具注入时，为防止CC拦截，修改数据包us头模仿爬虫，或使用代理池 安全狗：参考之前payload Aliyun：基本修改指纹即可 宝塔：匹配关键字，包括“&#x2F;*”，注入语句的每个“&#x2F;*”都改为“%00&#...","link":"","photos":[],"count_time":{"symbolsCount":614,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"Bypass WAF","slug":"Bypass-WAF","count":7,"path":"api/tags/Bypass-WAF.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x00\"><span class=\"toc-text\">0x00</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x01-SQL%E6%B3%A8%E5%85%A5\"><span class=\"toc-text\">0x01 SQL注入</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x02-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0\"><span class=\"toc-text\">0x02 文件上传</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x03-XSS%E8%B7%A8%E7%AB%99\"><span class=\"toc-text\">0x03 XSS跨站</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x04-RCE\"><span class=\"toc-text\">0x04 RCE</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x05-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB\"><span class=\"toc-text\">0x05 文件包含</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#0x06-%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E\"><span class=\"toc-text\">0x06 逻辑漏洞</span></a></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"WAF绕过-权限控制","uid":"21e0a43668edaae60c8a409447987781","slug":"WAF绕过-权限控制","date":"2022-06-11T02:42:28.000Z","updated":"2022-06-11T04:05:32.404Z","comments":true,"path":"api/articles/WAF绕过-权限控制.json","keywords":null,"cover":[],"text":"0x00脑图： 0x01 变量覆盖一句话木马，用eval()函数将字符串转换为PHP代码： &lt;?php @ev删掉这串汉字al($_POST[‘chop删掉这串汉字per’]);?> 用ass删掉这串汉字ert代替eval()： （eval()会被检测） &lt;?php ...","link":"","photos":[],"count_time":{"symbolsCount":959,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"Bypass WAF","slug":"Bypass-WAF","count":7,"path":"api/tags/Bypass-WAF.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"WAF绕过-漏洞发现之代理池指纹被动探针","uid":"60c32b8c4d5a420db76927924181a57e","slug":"WAF绕过-漏洞发现之代理池指纹被动探针","date":"2022-06-10T10:48:38.000Z","updated":"2022-06-10T12:00:36.685Z","comments":true,"path":"api/articles/WAF绕过-漏洞发现之代理池指纹被动探针.json","keywords":null,"cover":[],"text":"0x00脑图： 0x01 漏洞发现触发WAF点-针对xray,awvs等1、扫描速度-(代理池，延迟，白名单等)：速度过快肯定会被拦截 2、工具指纹-(特征修改，伪造模拟真实用户等) 3、漏洞Payload-(数据变异，数据加密，白名单等) （热门的扫描工具（awvs，xray等...","link":"","photos":[],"count_time":{"symbolsCount":"1k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"Bypass WAF","slug":"Bypass-WAF","count":7,"path":"api/tags/Bypass-WAF.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}